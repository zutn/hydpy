
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>hydpy.models.lland.lland_model &#8212; HydPy 2.1-dev documentation</title>
    <link rel="stylesheet" href="../../../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../../index.html">HydPy 2.1-dev documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../../index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for hydpy.models.lland.lland_model</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>

<span class="c1"># imports...</span>
<span class="c1"># ...standard library</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span>
<span class="c1"># ...HydPy specific</span>
<span class="kn">from</span> <span class="nn">hydpy.core</span> <span class="k">import</span> <span class="n">modeltools</span>
<span class="kn">from</span> <span class="nn">hydpy.cythons</span> <span class="k">import</span> <span class="n">modelutils</span>
<span class="c1"># ...model specifc</span>
<span class="kn">from</span> <span class="nn">hydpy.models.lland.lland_constants</span> <span class="k">import</span> <span class="n">WASSER</span><span class="p">,</span> <span class="n">FLUSS</span><span class="p">,</span> <span class="n">SEE</span><span class="p">,</span> <span class="n">VERS</span>


<div class="viewcode-block" id="calc_nkor_v1"><a class="viewcode-back" href="../../../../lland.html#hydpy.models.lland.lland_model.calc_nkor_v1">[docs]</a><span class="k">def</span> <span class="nf">calc_nkor_v1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adjust the given precipitation values.</span>

<span class="sd">    Required control parameters:</span>
<span class="sd">      |NHRU|</span>
<span class="sd">      |KG|</span>

<span class="sd">    Required input sequence:</span>
<span class="sd">      |Nied|</span>

<span class="sd">    Calculated flux sequence:</span>
<span class="sd">      |NKor|</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      :math:`NKor = KG \\cdot Nied`</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.lland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep(&#39;1d&#39;)</span>
<span class="sd">        &gt;&gt;&gt; nhru(3)</span>
<span class="sd">        &gt;&gt;&gt; kg(0.8, 1.0, 1.2)</span>
<span class="sd">        &gt;&gt;&gt; inputs.nied = 10.</span>
<span class="sd">        &gt;&gt;&gt; model.calc_nkor_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.nkor</span>
<span class="sd">        nkor(8.0, 10.0, 12.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">con</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">inp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">flu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nhru</span><span class="p">):</span>
        <span class="n">flu</span><span class="o">.</span><span class="n">nkor</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">kg</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">inp</span><span class="o">.</span><span class="n">nied</span></div>


<div class="viewcode-block" id="calc_tkor_v1"><a class="viewcode-back" href="../../../../lland.html#hydpy.models.lland.lland_model.calc_tkor_v1">[docs]</a><span class="k">def</span> <span class="nf">calc_tkor_v1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adjust the given air temperature values.</span>

<span class="sd">    Required control parameters:</span>
<span class="sd">      |NHRU|</span>
<span class="sd">      |KT|</span>

<span class="sd">    Required input sequence:</span>
<span class="sd">      |TemL|</span>

<span class="sd">    Calculated flux sequence:</span>
<span class="sd">      |TKor|</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      :math:`TKor = KT + TemL`</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.lland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep(&#39;1d&#39;)</span>
<span class="sd">        &gt;&gt;&gt; nhru(3)</span>
<span class="sd">        &gt;&gt;&gt; kt(-2.0, 0.0, 2.0)</span>
<span class="sd">        &gt;&gt;&gt; inputs.teml(1.)</span>
<span class="sd">        &gt;&gt;&gt; model.calc_tkor_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.tkor</span>
<span class="sd">        tkor(-1.0, 1.0, 3.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">con</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">inp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">flu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nhru</span><span class="p">):</span>
        <span class="n">flu</span><span class="o">.</span><span class="n">tkor</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">kt</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">inp</span><span class="o">.</span><span class="n">teml</span></div>


<div class="viewcode-block" id="calc_et0_v1"><a class="viewcode-back" href="../../../../lland.html#hydpy.models.lland.lland_model.calc_et0_v1">[docs]</a><span class="k">def</span> <span class="nf">calc_et0_v1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculate reference evapotranspiration after Turc-Wendling.</span>

<span class="sd">    Required control parameters:</span>
<span class="sd">      |NHRU|</span>
<span class="sd">      |KE|</span>
<span class="sd">      |KF|</span>
<span class="sd">      |HNN|</span>

<span class="sd">    Required input sequence:</span>
<span class="sd">      |Glob|</span>

<span class="sd">    Required flux sequence:</span>
<span class="sd">      |TKor|</span>

<span class="sd">    Calculated flux sequence:</span>
<span class="sd">      |ET0|</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      :math:`ET0 = KE \\cdot</span>
<span class="sd">      \\frac{(8.64 \\cdot Glob+93 \\cdot KF) \\cdot (TKor+22)}</span>
<span class="sd">      {165 \\cdot (TKor+123) \\cdot (1 + 0.00019 \\cdot min(HNN, 600))}`</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.lland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep(&#39;1d&#39;)</span>
<span class="sd">        &gt;&gt;&gt; simulationstep(&#39;12h&#39;)</span>
<span class="sd">        &gt;&gt;&gt; nhru(3)</span>
<span class="sd">        &gt;&gt;&gt; ke(1.1)</span>
<span class="sd">        &gt;&gt;&gt; kf(0.6)</span>
<span class="sd">        &gt;&gt;&gt; hnn(200.0, 600.0, 1000.0)</span>
<span class="sd">        &gt;&gt;&gt; inputs.glob = 200.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.tkor = 15.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_et0_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.et0</span>
<span class="sd">        et0(3.07171, 2.86215, 2.86215)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">con</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">inp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">flu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nhru</span><span class="p">):</span>
        <span class="n">flu</span><span class="o">.</span><span class="n">et0</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">ke</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(((</span><span class="mf">8.64</span><span class="o">*</span><span class="n">inp</span><span class="o">.</span><span class="n">glob</span><span class="o">+</span><span class="mf">93.</span><span class="o">*</span><span class="n">con</span><span class="o">.</span><span class="n">kf</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">*</span>
                                  <span class="p">(</span><span class="n">flu</span><span class="o">.</span><span class="n">tkor</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">+</span><span class="mf">22.</span><span class="p">))</span> <span class="o">/</span>
                                 <span class="p">(</span><span class="mf">165.</span><span class="o">*</span><span class="p">(</span><span class="n">flu</span><span class="o">.</span><span class="n">tkor</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">+</span><span class="mf">123.</span><span class="p">)</span> <span class="o">*</span>
                                  <span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="mf">0.00019</span><span class="o">*</span><span class="nb">min</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">hnn</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="mf">600.</span><span class="p">)))))</span></div>


<div class="viewcode-block" id="calc_et0_wet0_v1"><a class="viewcode-back" href="../../../../lland.html#hydpy.models.lland.lland_model.calc_et0_wet0_v1">[docs]</a><span class="k">def</span> <span class="nf">calc_et0_wet0_v1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Correct the given reference evapotranspiration and update the</span>
<span class="sd">    corresponding log sequence.</span>

<span class="sd">    Required control parameters:</span>
<span class="sd">      |NHRU|</span>
<span class="sd">      |KE|</span>
<span class="sd">      |WfET0|</span>

<span class="sd">    Required input sequence:</span>
<span class="sd">      |PET|</span>

<span class="sd">    Calculated flux sequence:</span>
<span class="sd">      |ET0|</span>

<span class="sd">    Updated log sequence:</span>
<span class="sd">      |WET0|</span>

<span class="sd">    Basic equations:</span>
<span class="sd">      :math:`ET0_{new} = WfET0 \\cdot KE \\cdot PET +</span>
<span class="sd">      (1-WfET0) \\cdot ET0_{alt}`</span>

<span class="sd">    Example:</span>

<span class="sd">        Prepare four hydrological response units with different value</span>
<span class="sd">        combinations of parameters |KE| and |WfET0|:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.lland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep(&#39;1d&#39;)</span>
<span class="sd">        &gt;&gt;&gt; simulationstep(&#39;12h&#39;)</span>
<span class="sd">        &gt;&gt;&gt; nhru(4)</span>
<span class="sd">        &gt;&gt;&gt; ke(0.8, 1.2, 0.8, 1.2)</span>
<span class="sd">        &gt;&gt;&gt; wfet0(2.0, 2.0, 0.2, 0.2)</span>

<span class="sd">        Note that the actual value of time dependend parameter |WfET0|</span>
<span class="sd">        is reduced due the difference between the given parameter and</span>
<span class="sd">        simulation time steps:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import round_</span>
<span class="sd">        &gt;&gt;&gt; round_(wfet0.values)</span>
<span class="sd">        1.0, 1.0, 0.1, 0.1</span>

<span class="sd">        For the first two hydrological response units, the given |PET|</span>
<span class="sd">        value is modified by -0.4 mm and +0.4 mm, respectively.  For the</span>
<span class="sd">        other two response units, which weight the &quot;new&quot; evaporation</span>
<span class="sd">        value with 10 %, |ET0| does deviate from the old value of |WET0|</span>
<span class="sd">        by -0.04 mm and +0.04 mm only:</span>

<span class="sd">        &gt;&gt;&gt; inputs.pet = 2.0</span>
<span class="sd">        &gt;&gt;&gt; logs.wet0 = 2.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_et0_wet0_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.et0</span>
<span class="sd">        et0(1.6, 2.4, 1.96, 2.04)</span>
<span class="sd">        &gt;&gt;&gt; logs.wet0</span>
<span class="sd">        wet0([[1.6, 2.4, 1.96, 2.04]])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">con</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">inp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">flu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">log</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">logs</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nhru</span><span class="p">):</span>
        <span class="n">flu</span><span class="o">.</span><span class="n">et0</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">wfet0</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="n">con</span><span class="o">.</span><span class="n">ke</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="n">inp</span><span class="o">.</span><span class="n">pet</span> <span class="o">+</span>
                      <span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">con</span><span class="o">.</span><span class="n">wfet0</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">log</span><span class="o">.</span><span class="n">wet0</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">k</span><span class="p">])</span>
        <span class="n">log</span><span class="o">.</span><span class="n">wet0</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">flu</span><span class="o">.</span><span class="n">et0</span><span class="p">[</span><span class="n">k</span><span class="p">]</span></div>


<div class="viewcode-block" id="calc_evpo_v1"><a class="viewcode-back" href="../../../../lland.html#hydpy.models.lland.lland_model.calc_evpo_v1">[docs]</a><span class="k">def</span> <span class="nf">calc_evpo_v1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculate land use and month specific values of potential</span>
<span class="sd">    evapotranspiration.</span>

<span class="sd">    Required control parameters:</span>
<span class="sd">      |NHRU|</span>
<span class="sd">      |Lnk|</span>
<span class="sd">      |FLn|</span>

<span class="sd">    Required derived parameter:</span>
<span class="sd">      |MOY|</span>

<span class="sd">    Required flux sequence:</span>
<span class="sd">      |ET0|</span>

<span class="sd">    Calculated flux sequence:</span>
<span class="sd">      |EvPo|</span>

<span class="sd">    Additional requirements:</span>
<span class="sd">      |Model.idx_sim|</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      :math:`EvPo = FLn \\cdot ET0`</span>

<span class="sd">    Example:</span>

<span class="sd">        For clarity, this is more of a kind of an integration example.</span>
<span class="sd">        Parameter |FLn| both depends on time (the actual month) and space</span>
<span class="sd">        (the actual land use).  Firstly, let us define a initialization</span>
<span class="sd">        time period spanning the transition from June to July:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import pub, Timegrid, Timegrids</span>
<span class="sd">        &gt;&gt;&gt; pub.timegrids = Timegrids(Timegrid(&#39;30.06.2000&#39;,</span>
<span class="sd">        ...                                    &#39;02.07.2000&#39;,</span>
<span class="sd">        ...                                    &#39;1d&#39;))</span>

<span class="sd">        Secondly, assume that the considered subbasin is differenciated in</span>
<span class="sd">        two HRUs, one of primarily consisting of arable land and the other</span>
<span class="sd">        one of deciduous forests:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.lland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep(&#39;1d&#39;)</span>
<span class="sd">        &gt;&gt;&gt; nhru(2)</span>
<span class="sd">        &gt;&gt;&gt; lnk(ACKER, LAUBW)</span>

<span class="sd">        Thirdly, set the |FLn|</span>
<span class="sd">        values, one for the relevant months and land use classes:</span>

<span class="sd">        &gt;&gt;&gt; fln.acker_jun = 1.299</span>
<span class="sd">        &gt;&gt;&gt; fln.acker_jul = 1.304</span>
<span class="sd">        &gt;&gt;&gt; fln.laubw_jun = 1.350</span>
<span class="sd">        &gt;&gt;&gt; fln.laubw_jul = 1.365</span>

<span class="sd">        Fourthly, the index array connecting the simulation time steps</span>
<span class="sd">        defined above and the month indexes (0...11) can be retrieved</span>
<span class="sd">        from the |pub| module.  This can be done manually more</span>
<span class="sd">        conveniently via its update method:</span>

<span class="sd">        &gt;&gt;&gt; derived.moy.update()</span>
<span class="sd">        &gt;&gt;&gt; derived.moy</span>
<span class="sd">        moy(5, 6)</span>

<span class="sd">        Finally, the actual method (with its simple equation) is applied</span>
<span class="sd">        as usual:</span>

<span class="sd">        &gt;&gt;&gt; fluxes.et0 = 2.0</span>
<span class="sd">        &gt;&gt;&gt; model.idx_sim = 0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_evpo_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.evpo</span>
<span class="sd">        evpo(2.598, 2.7)</span>
<span class="sd">        &gt;&gt;&gt; model.idx_sim = 1</span>
<span class="sd">        &gt;&gt;&gt; model.calc_evpo_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.evpo</span>
<span class="sd">        evpo(2.608, 2.73)</span>

<span class="sd">        Reset module |pub| to not interfere the following examples:</span>

<span class="sd">        &gt;&gt;&gt; pub.timegrids = None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">con</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">der</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">flu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nhru</span><span class="p">):</span>
        <span class="n">flu</span><span class="o">.</span><span class="n">evpo</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">fln</span><span class="p">[</span><span class="n">con</span><span class="o">.</span><span class="n">lnk</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">der</span><span class="o">.</span><span class="n">moy</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">idx_sim</span><span class="p">]]</span> <span class="o">*</span> <span class="n">flu</span><span class="o">.</span><span class="n">et0</span><span class="p">[</span><span class="n">k</span><span class="p">]</span></div>


<div class="viewcode-block" id="calc_nbes_inzp_v1"><a class="viewcode-back" href="../../../../lland.html#hydpy.models.lland.lland_model.calc_nbes_inzp_v1">[docs]</a><span class="k">def</span> <span class="nf">calc_nbes_inzp_v1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculate stand precipitation and update the interception storage</span>
<span class="sd">    accordingly.</span>

<span class="sd">    Required control parameters:</span>
<span class="sd">      |NHRU|</span>
<span class="sd">      |Lnk|</span>

<span class="sd">    Required derived parameter:</span>
<span class="sd">      |KInz|</span>

<span class="sd">    Required flux sequence:</span>
<span class="sd">      |NKor|</span>

<span class="sd">    Calculated flux sequence:</span>
<span class="sd">      |NBes|</span>

<span class="sd">    Updated state sequence:</span>
<span class="sd">      |Inzp|</span>

<span class="sd">    Additional requirements:</span>
<span class="sd">      |Model.idx_sim|</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      :math:`NBes = \\Bigl \\lbrace</span>
<span class="sd">      {</span>
<span class="sd">      {PKor \\ | \\ Inzp = KInz}</span>
<span class="sd">      \\atop</span>
<span class="sd">      {0 \\ | \\ Inzp &lt; KInz}</span>
<span class="sd">      }`</span>

<span class="sd">    Examples:</span>

<span class="sd">        Initialize five HRUs with different land usages:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.lland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep(&#39;1d&#39;)</span>
<span class="sd">        &gt;&gt;&gt; nhru(5)</span>
<span class="sd">        &gt;&gt;&gt; lnk(SIED_D, FEUCHT, GLETS, FLUSS, SEE)</span>

<span class="sd">        Define |KInz| values for July the selected land usages directly:</span>

<span class="sd">        &gt;&gt;&gt; derived.kinz.sied_d_jul = 2.0</span>
<span class="sd">        &gt;&gt;&gt; derived.kinz.feucht_jul = 1.0</span>
<span class="sd">        &gt;&gt;&gt; derived.kinz.glets_jul = 0.0</span>
<span class="sd">        &gt;&gt;&gt; derived.kinz.fluss_jul = 1.0</span>
<span class="sd">        &gt;&gt;&gt; derived.kinz.see_jul = 1.0</span>

<span class="sd">        Now we prepare a |MOY| object, that assumes that the first, second,</span>
<span class="sd">        and third simulation time steps are in June, July, and August</span>
<span class="sd">        respectively (we make use of the value defined above for July, but</span>
<span class="sd">        setting the values of parameter |MOY| this way allows for a more</span>
<span class="sd">        rigorous testing of proper indexing):</span>

<span class="sd">        &gt;&gt;&gt; derived.moy.shape = 3</span>
<span class="sd">        &gt;&gt;&gt; derived.moy = 5, 6, 7</span>
<span class="sd">        &gt;&gt;&gt; model.idx_sim = 1</span>

<span class="sd">        The dense settlement (|SIED_D|), the wetland area (|FEUCHT|), and</span>
<span class="sd">        both water areas (|FLUSS| and |SEE|) start with a initial interception</span>
<span class="sd">        storage of 1/2 mm, the glacier (|GLETS|) and water areas (|FLUSS| and</span>
<span class="sd">        |SEE|) start with 0 mm.  In the first example, actual precipition</span>
<span class="sd">        is 1 mm:</span>

<span class="sd">        &gt;&gt;&gt; states.inzp = 0.5, 0.5, 0.0, 1.0, 1.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.nkor = 1.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_nbes_inzp_v1()</span>
<span class="sd">        &gt;&gt;&gt; states.inzp</span>
<span class="sd">        inzp(1.5, 1.0, 0.0, 0.0, 0.0)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.nbes</span>
<span class="sd">        nbes(0.0, 0.5, 1.0, 0.0, 0.0)</span>

<span class="sd">        Only for the settled area, interception capacity is not exceeded,</span>
<span class="sd">        meaning no stand precipitation occurs.  Note that it is common in</span>
<span class="sd">        define zero interception capacities for glacier areas, but not</span>
<span class="sd">        mandatory.  Also note that the |KInz|, |Inzp| and |NKor| values</span>
<span class="sd">        given for both water areas are ignored completely, and |Inzp|</span>
<span class="sd">        and |NBes| are simply set to zero.</span>

<span class="sd">        If there is no precipitation, there is of course also no stand</span>
<span class="sd">        precipitation and interception storage remains unchanged:</span>

<span class="sd">        &gt;&gt;&gt; states.inzp = 0.5, 0.5, 0.0, 0.0, 0.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.nkor = 0.</span>
<span class="sd">        &gt;&gt;&gt; model.calc_nbes_inzp_v1()</span>
<span class="sd">        &gt;&gt;&gt; states.inzp</span>
<span class="sd">        inzp(0.5, 0.5, 0.0, 0.0, 0.0)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.nbes</span>
<span class="sd">        nbes(0.0, 0.0, 0.0, 0.0, 0.0)</span>

<span class="sd">        Interception capacities change discontinuously between consecutive</span>
<span class="sd">        months.  This can result in little stand precipitation events in</span>
<span class="sd">        periods without precipitation:</span>

<span class="sd">        &gt;&gt;&gt; states.inzp = 1.0, 0.0, 0.0, 0.0, 0.0</span>
<span class="sd">        &gt;&gt;&gt; derived.kinz.sied_d_jul = 0.6</span>
<span class="sd">        &gt;&gt;&gt; fluxes.nkor = 0.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_nbes_inzp_v1()</span>
<span class="sd">        &gt;&gt;&gt; states.inzp</span>
<span class="sd">        inzp(0.6, 0.0, 0.0, 0.0, 0.0)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.nbes</span>
<span class="sd">        nbes(0.4, 0.0, 0.0, 0.0, 0.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">con</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">der</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">flu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">sta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nhru</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">con</span><span class="o">.</span><span class="n">lnk</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="n">WASSER</span><span class="p">,</span> <span class="n">FLUSS</span><span class="p">,</span> <span class="n">SEE</span><span class="p">):</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">nbes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>
            <span class="n">sta</span><span class="o">.</span><span class="n">inzp</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">nbes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> \
                <span class="nb">max</span><span class="p">(</span><span class="n">flu</span><span class="o">.</span><span class="n">nkor</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">+</span><span class="n">sta</span><span class="o">.</span><span class="n">inzp</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span>
                    <span class="n">der</span><span class="o">.</span><span class="n">kinz</span><span class="p">[</span><span class="n">con</span><span class="o">.</span><span class="n">lnk</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">der</span><span class="o">.</span><span class="n">moy</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">idx_sim</span><span class="p">]],</span> <span class="mf">0.</span><span class="p">)</span>
            <span class="n">sta</span><span class="o">.</span><span class="n">inzp</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+=</span> <span class="n">flu</span><span class="o">.</span><span class="n">nkor</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">-</span><span class="n">flu</span><span class="o">.</span><span class="n">nbes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span></div>


<div class="viewcode-block" id="calc_evi_inzp_v1"><a class="viewcode-back" href="../../../../lland.html#hydpy.models.lland.lland_model.calc_evi_inzp_v1">[docs]</a><span class="k">def</span> <span class="nf">calc_evi_inzp_v1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculate interception evaporation and update the interception</span>
<span class="sd">    storage accordingly.</span>

<span class="sd">    Required control parameters:</span>
<span class="sd">      |NHRU|</span>
<span class="sd">      |Lnk|</span>
<span class="sd">      |TRefT|</span>
<span class="sd">      |TRefN|</span>

<span class="sd">    Required flux sequence:</span>
<span class="sd">      |EvPo|</span>

<span class="sd">    Calculated flux sequence:</span>
<span class="sd">      |EvI|</span>

<span class="sd">    Updated state sequence:</span>
<span class="sd">      |Inzp|</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      :math:`EvI = \\Bigl \\lbrace</span>
<span class="sd">      {</span>
<span class="sd">      {EvPo \\ | \\ Inzp &gt; 0}</span>
<span class="sd">      \\atop</span>
<span class="sd">      {0 \\ | \\ Inzp = 0}</span>
<span class="sd">      }`</span>

<span class="sd">    Examples:</span>

<span class="sd">        Initialize five HRUs with different combinations of land usage</span>
<span class="sd">        and initial interception storage and apply a value of potential</span>
<span class="sd">        evaporation of 3 mm on each one:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.lland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep(&#39;1d&#39;)</span>
<span class="sd">        &gt;&gt;&gt; nhru(5)</span>
<span class="sd">        &gt;&gt;&gt; lnk(FLUSS, SEE, ACKER, ACKER, ACKER)</span>
<span class="sd">        &gt;&gt;&gt; states.inzp = 2.0, 2.0, 0.0, 2.0, 4.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.evpo = 3.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_evi_inzp_v1()</span>
<span class="sd">        &gt;&gt;&gt; states.inzp</span>
<span class="sd">        inzp(0.0, 0.0, 0.0, 0.0, 1.0)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.evi</span>
<span class="sd">        evi(3.0, 3.0, 0.0, 2.0, 3.0)</span>

<span class="sd">        For arable land (|ACKER|) and most other land types, interception</span>
<span class="sd">        evaporation (|EvI|) is identical with potential evapotranspiration</span>
<span class="sd">        (|EvPo|), as long as it is met by available intercepted water</span>
<span class="sd">        ([Inzp|).  Only water areas (|FLUSS| and |SEE|),  |EvI| is</span>
<span class="sd">        generally equal to |EvPo| (but this might be corrected by a method</span>
<span class="sd">        called after |calc_evi_inzp_v1| has been applied) and [Inzp| is</span>
<span class="sd">        set to zero.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">con</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">flu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">sta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nhru</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">con</span><span class="o">.</span><span class="n">lnk</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="n">WASSER</span><span class="p">,</span> <span class="n">FLUSS</span><span class="p">,</span> <span class="n">SEE</span><span class="p">):</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">evi</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">flu</span><span class="o">.</span><span class="n">evpo</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="n">sta</span><span class="o">.</span><span class="n">inzp</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">evi</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">flu</span><span class="o">.</span><span class="n">evpo</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">sta</span><span class="o">.</span><span class="n">inzp</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
            <span class="n">sta</span><span class="o">.</span><span class="n">inzp</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-=</span> <span class="n">flu</span><span class="o">.</span><span class="n">evi</span><span class="p">[</span><span class="n">k</span><span class="p">]</span></div>


<div class="viewcode-block" id="calc_sbes_v1"><a class="viewcode-back" href="../../../../lland.html#hydpy.models.lland.lland_model.calc_sbes_v1">[docs]</a><span class="k">def</span> <span class="nf">calc_sbes_v1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculate the frozen part of stand precipitation.</span>

<span class="sd">    Required control parameters:</span>
<span class="sd">      |NHRU|</span>
<span class="sd">      |TGr|</span>
<span class="sd">      |TSp|</span>

<span class="sd">    Required flux sequences:</span>
<span class="sd">      |TKor|</span>
<span class="sd">      |NBes|</span>

<span class="sd">    Calculated flux sequence:</span>
<span class="sd">      |SBes|</span>

<span class="sd">    Examples:</span>

<span class="sd">        In the first example, the threshold temperature of seven hydrological</span>
<span class="sd">        response units is 0 °C and the corresponding temperature interval of</span>
<span class="sd">        mixed precipitation 2 °C:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.lland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep(&#39;1d&#39;)</span>
<span class="sd">        &gt;&gt;&gt; nhru(7)</span>
<span class="sd">        &gt;&gt;&gt; tgr(0.0)</span>
<span class="sd">        &gt;&gt;&gt; tsp(2.0)</span>

<span class="sd">        The value of |NBes| is zero above 1 °C and equal to the value of</span>
<span class="sd">        |NBes| below -1 °C.  Between these temperature values, |NBes|</span>
<span class="sd">        decreases linearly:</span>

<span class="sd">        &gt;&gt;&gt; fluxes.nbes = 4.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.tkor = -10.0, -1.0, -0.5, 0.0, 0.5, 1.0, 10.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_sbes_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.sbes</span>
<span class="sd">        sbes(4.0, 4.0, 3.0, 2.0, 1.0, 0.0, 0.0)</span>

<span class="sd">        Note the special case of a zero temperature interval.  With the</span>
<span class="sd">        actual temperature being equal to the threshold temperature, the</span>
<span class="sd">        the value of `sbes` is zero:</span>

<span class="sd">        &gt;&gt;&gt; tsp(0.)</span>
<span class="sd">        &gt;&gt;&gt; model.calc_sbes_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.sbes</span>
<span class="sd">        sbes(4.0, 4.0, 4.0, 0.0, 0.0, 0.0, 0.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">con</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">flu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nhru</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">flu</span><span class="o">.</span><span class="n">nbes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mf">0.</span><span class="p">:</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">sbes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>
        <span class="k">elif</span> <span class="n">flu</span><span class="o">.</span><span class="n">tkor</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">tgr</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">+</span><span class="n">con</span><span class="o">.</span><span class="n">tsp</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="mf">2.</span><span class="p">):</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">sbes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>
        <span class="k">elif</span> <span class="n">flu</span><span class="o">.</span><span class="n">tkor</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">tgr</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">-</span><span class="n">con</span><span class="o">.</span><span class="n">tsp</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="mf">2.</span><span class="p">):</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">sbes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">flu</span><span class="o">.</span><span class="n">nbes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">sbes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">((((</span><span class="n">con</span><span class="o">.</span><span class="n">tgr</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">+</span><span class="n">con</span><span class="o">.</span><span class="n">tsp</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span><span class="o">-</span><span class="n">flu</span><span class="o">.</span><span class="n">tkor</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">/</span>
                            <span class="n">con</span><span class="o">.</span><span class="n">tsp</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">flu</span><span class="o">.</span><span class="n">nbes</span><span class="p">[</span><span class="n">k</span><span class="p">])</span></div>


<div class="viewcode-block" id="calc_wgtf_v1"><a class="viewcode-back" href="../../../../lland.html#hydpy.models.lland.lland_model.calc_wgtf_v1">[docs]</a><span class="k">def</span> <span class="nf">calc_wgtf_v1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculate the potential snowmelt.</span>

<span class="sd">    Required control parameters:</span>
<span class="sd">      |NHRU|</span>
<span class="sd">      |Lnk|</span>
<span class="sd">      |GTF|</span>
<span class="sd">      |TRefT|</span>
<span class="sd">      |TRefN|</span>
<span class="sd">      |RSchmelz|</span>
<span class="sd">      |CPWasser|</span>

<span class="sd">    Required flux sequence:</span>
<span class="sd">      |TKor|</span>

<span class="sd">    Calculated fluxes sequence:</span>
<span class="sd">      |WGTF|</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      :math:`WGTF = max(GTF \\cdot (TKor - TRefT), 0) +</span>
<span class="sd">      max(\\frac{CPWasser}{RSchmelz} \\cdot (TKor - TRefN), 0)`</span>

<span class="sd">    Examples:</span>

<span class="sd">        Initialize seven HRUs with identical degree-day factors and</span>
<span class="sd">        temperature thresholds, but different combinations of land use</span>
<span class="sd">        and air temperature:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.lland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep(&#39;1d&#39;)</span>
<span class="sd">        &gt;&gt;&gt; simulationstep(&#39;12h&#39;)</span>
<span class="sd">        &gt;&gt;&gt; nhru(7)</span>
<span class="sd">        &gt;&gt;&gt; lnk(ACKER, LAUBW, FLUSS, SEE, ACKER, ACKER, ACKER)</span>
<span class="sd">        &gt;&gt;&gt; gtf(5.0)</span>
<span class="sd">        &gt;&gt;&gt; treft(0.0)</span>
<span class="sd">        &gt;&gt;&gt; trefn(1.0)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.tkor = 2.0, 2.0, 2.0, 2.0, -1.0, 0.0, 1.0</span>

<span class="sd">        Compared to most other LARSIM parameters, the specific heat capacity</span>
<span class="sd">        and melt heat capacity of water can be seen as fixed properties:</span>

<span class="sd">        &gt;&gt;&gt; cpwasser(4.1868)</span>
<span class="sd">        &gt;&gt;&gt; rschmelz(334.0)</span>

<span class="sd">        Note that the values of the degree-day factor are only half</span>
<span class="sd">        as much as the given value, due to the simulation step size</span>
<span class="sd">        being only half as long as the parameter step size:</span>

<span class="sd">        &gt;&gt;&gt; gtf</span>
<span class="sd">        gtf(5.0)</span>
<span class="sd">        &gt;&gt;&gt; gtf.values</span>
<span class="sd">        array([ 2.5,  2.5,  2.5,  2.5,  2.5,  2.5,  2.5])</span>

<span class="sd">        After performing the calculation, one can see that the potential</span>
<span class="sd">        melting rate is identical for the first two HRUs (|ACKER| and</span>
<span class="sd">        |LAUBW|).  The land use class results in no difference, except for</span>
<span class="sd">        water areas (third and forth HRU, |FLUSS| and |SEE|), where no</span>
<span class="sd">        potential melt needs to be calculated.  The last three HRUs (again</span>
<span class="sd">        |ACKER|) show the usual behaviour of the degree day method, when the</span>
<span class="sd">        actual temperature is below (fourth HRU), equal to (fifth HRU) or</span>
<span class="sd">        above (sixths zone) the threshold temperature.  Additionally, the</span>
<span class="sd">        first two zones show the influence of the additional energy intake</span>
<span class="sd">        due to &quot;warm&quot; precipitation.  Obviously, this additional term is</span>
<span class="sd">        quite negligible for common parameterizations, even if lower</span>
<span class="sd">        values for the separate threshold temperature |TRefT| would be</span>
<span class="sd">        taken into account:</span>

<span class="sd">        &gt;&gt;&gt; model.calc_wgtf_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.wgtf</span>
<span class="sd">        wgtf(5.012535, 5.012535, 0.0, 0.0, 0.0, 0.0, 2.5)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">con</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">flu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nhru</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">con</span><span class="o">.</span><span class="n">lnk</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="n">WASSER</span><span class="p">,</span> <span class="n">FLUSS</span><span class="p">,</span> <span class="n">SEE</span><span class="p">):</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">wgtf</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">wgtf</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
              <span class="nb">max</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">gtf</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">flu</span><span class="o">.</span><span class="n">tkor</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">-</span><span class="n">con</span><span class="o">.</span><span class="n">treft</span><span class="p">[</span><span class="n">k</span><span class="p">]),</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span>
              <span class="nb">max</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">cpwasser</span><span class="o">/</span><span class="n">con</span><span class="o">.</span><span class="n">rschmelz</span><span class="o">*</span><span class="p">(</span><span class="n">flu</span><span class="o">.</span><span class="n">tkor</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">-</span><span class="n">con</span><span class="o">.</span><span class="n">trefn</span><span class="p">[</span><span class="n">k</span><span class="p">]),</span> <span class="mf">0.</span><span class="p">))</span></div>


<div class="viewcode-block" id="calc_schm_wats_v1"><a class="viewcode-back" href="../../../../lland.html#hydpy.models.lland.lland_model.calc_schm_wats_v1">[docs]</a><span class="k">def</span> <span class="nf">calc_schm_wats_v1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculate the actual amount of water melting within the snow cover.</span>

<span class="sd">    Required control parameters:</span>
<span class="sd">      |NHRU|</span>
<span class="sd">      |Lnk|</span>

<span class="sd">    Required flux sequences:</span>
<span class="sd">      |SBes|</span>
<span class="sd">      |WGTF|</span>

<span class="sd">    Calculated flux sequence:</span>
<span class="sd">      |Schm|</span>

<span class="sd">    Updated state sequence:</span>
<span class="sd">      |WATS|</span>

<span class="sd">    Basic equations:</span>
<span class="sd">      :math:`\\frac{dWATS}{dt}  = SBes - Schm`</span>
<span class="sd">      :math:`Schm = \\Bigl \\lbrace</span>
<span class="sd">      {</span>
<span class="sd">      {WGTF \\ | \\ WATS &gt; 0}</span>
<span class="sd">      \\atop</span>
<span class="sd">      {0 \\ | \\ WATS = 0}</span>
<span class="sd">      }`</span>

<span class="sd">    Examples:</span>

<span class="sd">        Initialize two water (|FLUSS| and |SEE|) and four arable land</span>
<span class="sd">        (|ACKER|) HRUs.  Assume the same values for the initial amount</span>
<span class="sd">        of frozen water (|WATS|) and the frozen part of stand precipitation</span>
<span class="sd">        (|SBes|), but different values for potential snowmelt (|WGTF|):</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.lland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep(&#39;1d&#39;)</span>
<span class="sd">        &gt;&gt;&gt; nhru(6)</span>
<span class="sd">        &gt;&gt;&gt; lnk(FLUSS, SEE, ACKER, ACKER, ACKER, ACKER)</span>
<span class="sd">        &gt;&gt;&gt; states.wats = 2.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.sbes = 1.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.wgtf = 1.0, 1.0, 0.0, 1.0, 3.0, 5.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_schm_wats_v1()</span>
<span class="sd">        &gt;&gt;&gt; states.wats</span>
<span class="sd">        wats(0.0, 0.0, 3.0, 2.0, 0.0, 0.0)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.schm</span>
<span class="sd">        schm(0.0, 0.0, 0.0, 1.0, 3.0, 3.0)</span>

<span class="sd">        For the water areas, both the frozen amount of water and actual melt</span>
<span class="sd">        are set to zero.  For all other land use classes, actual melt</span>
<span class="sd">        is either limited by potential melt or the available frozen water,</span>
<span class="sd">        which is the sum of initial frozen water and the frozen part</span>
<span class="sd">        of stand precipitation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">con</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">flu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">sta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nhru</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">con</span><span class="o">.</span><span class="n">lnk</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="n">WASSER</span><span class="p">,</span> <span class="n">FLUSS</span><span class="p">,</span> <span class="n">SEE</span><span class="p">):</span>
            <span class="n">sta</span><span class="o">.</span><span class="n">wats</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">schm</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sta</span><span class="o">.</span><span class="n">wats</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+=</span> <span class="n">flu</span><span class="o">.</span><span class="n">sbes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">schm</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">flu</span><span class="o">.</span><span class="n">wgtf</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">sta</span><span class="o">.</span><span class="n">wats</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
            <span class="n">sta</span><span class="o">.</span><span class="n">wats</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-=</span> <span class="n">flu</span><span class="o">.</span><span class="n">schm</span><span class="p">[</span><span class="n">k</span><span class="p">]</span></div>


<div class="viewcode-block" id="calc_wada_waes_v1"><a class="viewcode-back" href="../../../../lland.html#hydpy.models.lland.lland_model.calc_wada_waes_v1">[docs]</a><span class="k">def</span> <span class="nf">calc_wada_waes_v1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculate the actual water release from the snow cover.</span>

<span class="sd">    Required control parameters:</span>
<span class="sd">      |NHRU|</span>
<span class="sd">      |Lnk|</span>
<span class="sd">      |PWMax|</span>

<span class="sd">    Required flux sequences:</span>
<span class="sd">      |NBes|</span>

<span class="sd">    Calculated flux sequence:</span>
<span class="sd">      |WaDa|</span>

<span class="sd">    Updated state sequence:</span>
<span class="sd">      |WAeS|</span>

<span class="sd">    Basic equations:</span>
<span class="sd">      :math:`\\frac{dWAeS}{dt} = NBes - WaDa`</span>
<span class="sd">      :math:`WAeS \\leq PWMax \\cdot WATS`</span>

<span class="sd">    Examples:</span>

<span class="sd">        For simplicity, the threshold parameter |PWMax| is set to a value</span>
<span class="sd">        of two for each of the six initialized HRUs.  Thus, snow cover can</span>
<span class="sd">        hold as much liquid water as it contains frozen water.  Stand</span>
<span class="sd">        precipitation is also always set to the same value, but the initial</span>
<span class="sd">        conditions of the snow cover are varied:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.lland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep(&#39;1d&#39;)</span>
<span class="sd">        &gt;&gt;&gt; nhru(6)</span>
<span class="sd">        &gt;&gt;&gt; lnk(FLUSS, SEE, ACKER, ACKER, ACKER, ACKER)</span>
<span class="sd">        &gt;&gt;&gt; pwmax(2.0)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.nbes = 1.0</span>
<span class="sd">        &gt;&gt;&gt; states.wats = 0.0, 0.0, 0.0, 1.0, 1.0, 1.0</span>
<span class="sd">        &gt;&gt;&gt; states.waes = 1.0, 1.0, 0.0, 1.0, 1.5, 2.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_wada_waes_v1()</span>
<span class="sd">        &gt;&gt;&gt; states.waes</span>
<span class="sd">        waes(0.0, 0.0, 0.0, 2.0, 2.0, 2.0)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.wada</span>
<span class="sd">        wada(1.0, 1.0, 1.0, 0.0, 0.5, 1.0)</span>

<span class="sd">        Note the special cases of the first two HRUs of type |FLUSS| and</span>
<span class="sd">        |SEE|.  For water areas, stand precipitaton |NBes| is generally</span>
<span class="sd">        passed to |WaDa| and |WAeS| is set to zero.  For all other land</span>
<span class="sd">        use classes (of which only |ACKER| is selected), only the amount</span>
<span class="sd">        of |NBes| exceeding the actual snow holding capacity is passed</span>
<span class="sd">        to |WaDa|.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">con</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">flu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">sta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nhru</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">con</span><span class="o">.</span><span class="n">lnk</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="n">WASSER</span><span class="p">,</span> <span class="n">FLUSS</span><span class="p">,</span> <span class="n">SEE</span><span class="p">):</span>
            <span class="n">sta</span><span class="o">.</span><span class="n">waes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">wada</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">flu</span><span class="o">.</span><span class="n">nbes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sta</span><span class="o">.</span><span class="n">waes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+=</span> <span class="n">flu</span><span class="o">.</span><span class="n">nbes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">wada</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">sta</span><span class="o">.</span><span class="n">waes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">-</span><span class="n">con</span><span class="o">.</span><span class="n">pwmax</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="n">sta</span><span class="o">.</span><span class="n">wats</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="mf">0.</span><span class="p">)</span>
            <span class="n">sta</span><span class="o">.</span><span class="n">waes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-=</span> <span class="n">flu</span><span class="o">.</span><span class="n">wada</span><span class="p">[</span><span class="n">k</span><span class="p">]</span></div>


<div class="viewcode-block" id="calc_evb_v1"><a class="viewcode-back" href="../../../../lland.html#hydpy.models.lland.lland_model.calc_evb_v1">[docs]</a><span class="k">def</span> <span class="nf">calc_evb_v1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculate the actual water release from the snow cover.</span>

<span class="sd">    Required control parameters:</span>
<span class="sd">      |NHRU|</span>
<span class="sd">      |Lnk|</span>
<span class="sd">      |NFk|</span>
<span class="sd">      |GrasRef_R|</span>

<span class="sd">    Required state sequence:</span>
<span class="sd">      |BoWa|</span>

<span class="sd">    Required flux sequences:</span>
<span class="sd">      |EvPo|</span>
<span class="sd">      |EvI|</span>

<span class="sd">    Calculated flux sequence:</span>
<span class="sd">      |EvB|</span>

<span class="sd">    Basic equations:</span>
<span class="sd">      :math:`temp = exp(-GrasRef_R \\cdot \\frac{BoWa}{NFk})`</span>
<span class="sd">      :math:`EvB = (EvPo - EvI) \\cdot</span>
<span class="sd">      \\frac{1 - temp}{1 + temp -2 \\cdot exp(-GrasRef_R)}`</span>

<span class="sd">    Examples:</span>

<span class="sd">        Soil evaporation is calculated neither for water nor for sealed</span>
<span class="sd">        areas (see the first three HRUs of type |FLUSS|, |SEE|, and |VERS|).</span>
<span class="sd">        All other land use classes are handled in accordance with a</span>
<span class="sd">        recommendation of the set of codes described in ATV-DVWK-M 504</span>
<span class="sd">        (arable land |ACKER| has been selected for the last four HRUs</span>
<span class="sd">        arbitrarily):</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.lland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep(&#39;1d&#39;)</span>
<span class="sd">        &gt;&gt;&gt; nhru(7)</span>
<span class="sd">        &gt;&gt;&gt; lnk(FLUSS, SEE, VERS, ACKER, ACKER, ACKER, ACKER)</span>
<span class="sd">        &gt;&gt;&gt; grasref_r(5.0)</span>
<span class="sd">        &gt;&gt;&gt; nfk(100.0, 100.0, 100.0, 0.0, 100.0, 100.0, 100.0)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.evpo = 5.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.evi = 3.0</span>
<span class="sd">        &gt;&gt;&gt; states.bowa = 50.0, 50.0, 50.0, 0.0, 0.0, 50.0, 100.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_evb_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.evb</span>
<span class="sd">        evb(0.0, 0.0, 0.0, 0.0, 0.0, 1.717962, 2.0)</span>

<span class="sd">        In case usable field capacity (|NFk|) is zero, soil evaporation</span>
<span class="sd">        (|EvB|) is generally set to zero (see the forth HRU).  The last</span>
<span class="sd">        three HRUs demonstrate the rise in soil evaporation with increasing</span>
<span class="sd">        soil moisture, which is lessening in the high soil moisture range.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">con</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">flu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">sta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nhru</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">lnk</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="n">VERS</span><span class="p">,</span> <span class="n">WASSER</span><span class="p">,</span> <span class="n">FLUSS</span><span class="p">,</span> <span class="n">SEE</span><span class="p">))</span> <span class="ow">or</span> <span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nfk</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mf">0.</span><span class="p">):</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">evb</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">d_temp</span> <span class="o">=</span> <span class="n">modelutils</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">con</span><span class="o">.</span><span class="n">grasref_r</span> <span class="o">*</span>
                                    <span class="n">sta</span><span class="o">.</span><span class="n">bowa</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="n">con</span><span class="o">.</span><span class="n">nfk</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">evb</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">flu</span><span class="o">.</span><span class="n">evpo</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">-</span><span class="n">flu</span><span class="o">.</span><span class="n">evi</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">d_temp</span><span class="p">)</span> <span class="o">/</span>
                          <span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">d_temp</span><span class="o">-</span><span class="mf">2.</span><span class="o">*</span><span class="n">modelutils</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">con</span><span class="o">.</span><span class="n">grasref_r</span><span class="p">)))</span></div>


<div class="viewcode-block" id="calc_qbb_v1"><a class="viewcode-back" href="../../../../lland.html#hydpy.models.lland.lland_model.calc_qbb_v1">[docs]</a><span class="k">def</span> <span class="nf">calc_qbb_v1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculate the amount of base flow released from the soil.</span>

<span class="sd">    Required control parameters:</span>
<span class="sd">      |NHRU|</span>
<span class="sd">      |Lnk|</span>
<span class="sd">      |Beta|</span>
<span class="sd">      |FBeta|</span>

<span class="sd">    Required derived parameter:</span>
<span class="sd">      |WB|</span>
<span class="sd">      |WZ|</span>

<span class="sd">    Required state sequence:</span>
<span class="sd">      |BoWa|</span>

<span class="sd">    Calculated flux sequence:</span>
<span class="sd">      |QBB|</span>

<span class="sd">    Basic equations:</span>
<span class="sd">      :math:`Beta_{eff} = \\Bigl \\lbrace</span>
<span class="sd">      {</span>
<span class="sd">      {Beta \\ | \\ BoWa \\leq WZ}</span>
<span class="sd">      \\atop</span>
<span class="sd">      {Beta \\cdot (1+(FBeta-1)\\cdot\\frac{BoWa-WZ}{NFk-WZ}) \\|\\ BoWa &gt; WZ}</span>
<span class="sd">      }`</span>

<span class="sd">      :math:`QBB = \\Bigl \\lbrace</span>
<span class="sd">      {</span>
<span class="sd">      {0 \\ | \\ BoWa \\leq WB}</span>
<span class="sd">      \\atop</span>
<span class="sd">      {Beta_{eff}  \\cdot (BoWa - WB) \\|\\ BoWa &gt; WB}</span>
<span class="sd">      }`</span>

<span class="sd">    Examples:</span>

<span class="sd">        For water and sealed areas, no base flow is calculated (see the</span>
<span class="sd">        first three HRUs of type |VERS|, |FLUSS|, and |SEE|).  No principal</span>
<span class="sd">        distinction is made between the remaining land use classes (arable</span>
<span class="sd">        land |ACKER| has been selected for the last five HRUs arbitrarily):</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.lland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep(&#39;1d&#39;)</span>
<span class="sd">        &gt;&gt;&gt; simulationstep(&#39;12h&#39;)</span>
<span class="sd">        &gt;&gt;&gt; nhru(8)</span>
<span class="sd">        &gt;&gt;&gt; lnk(FLUSS, SEE, VERS, ACKER, ACKER, ACKER, ACKER, ACKER)</span>
<span class="sd">        &gt;&gt;&gt; beta(0.04)</span>
<span class="sd">        &gt;&gt;&gt; fbeta(2.0)</span>
<span class="sd">        &gt;&gt;&gt; nfk(100.0, 100.0, 100.0, 0.0, 100.0, 100.0, 100.0, 200.0)</span>
<span class="sd">        &gt;&gt;&gt; derived.wb(10.0)</span>
<span class="sd">        &gt;&gt;&gt; derived.wz(70.0)</span>

<span class="sd">        Note the time dependence of parameter |Beta|:</span>

<span class="sd">        &gt;&gt;&gt; beta</span>
<span class="sd">        beta(0.04)</span>
<span class="sd">        &gt;&gt;&gt; beta.values</span>
<span class="sd">        array([ 0.02,  0.02,  0.02,  0.02,  0.02,  0.02,  0.02,  0.02])</span>

<span class="sd">        In the first example, the actual soil water content |BoWa| is set</span>
<span class="sd">        to low values.  For values below the threshold |WB|, not percolation</span>
<span class="sd">        occurs.  Above |WB| (but below |WZ|), |QBB| increases linearly by</span>
<span class="sd">        an amount defined by parameter |Beta|:</span>

<span class="sd">        &gt;&gt;&gt; states.bowa = 20.0, 20.0, 20.0, 0.0, 0.0, 10.0, 20.0, 20.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_qbb_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.qbb</span>
<span class="sd">        qbb(0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.2, 0.2)</span>

<span class="sd">        Note that for the last two HRUs the same amount of</span>
<span class="sd">        base flow generation is determined, in spite of the fact</span>
<span class="sd">        that both exhibit different relative soil moistures.  It is</span>
<span class="sd">        common to modify this &quot;pure absolute dependency&quot; to a &quot;mixed</span>
<span class="sd">        absolute/relative dependency&quot; through defining the values of</span>
<span class="sd">        parameter |WB| indirectly via parameter |RelWB|.</span>

<span class="sd">        In the second example, the actual soil water content |BoWa| is set</span>
<span class="sd">        to high values.  For values below threshold |WZ|, the discussion above</span>
<span class="sd">        remains valid.  For values above |WZ|, percolation shows a nonlinear</span>
<span class="sd">        behaviour when factor |FBeta| is set to values larger than one:</span>

<span class="sd">        &gt;&gt;&gt; nfk(0.0, 0.0, 0.0, 100.0, 100.0, 100.0, 100.0, 200.0)</span>
<span class="sd">        &gt;&gt;&gt; states.bowa = 0.0, 0.0, 0.0, 60.0, 70.0, 80.0, 100.0, 200.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_qbb_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.qbb</span>
<span class="sd">        qbb(0.0, 0.0, 0.0, 1.0, 1.2, 1.866667, 3.6, 7.6)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">con</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">der</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">flu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">sta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nhru</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">((</span><span class="n">con</span><span class="o">.</span><span class="n">lnk</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="n">VERS</span><span class="p">,</span> <span class="n">WASSER</span><span class="p">,</span> <span class="n">FLUSS</span><span class="p">,</span> <span class="n">SEE</span><span class="p">))</span> <span class="ow">or</span>
                <span class="p">(</span><span class="n">sta</span><span class="o">.</span><span class="n">bowa</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">der</span><span class="o">.</span><span class="n">wb</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="ow">or</span> <span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nfk</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mf">0.</span><span class="p">)):</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">qbb</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>
        <span class="k">elif</span> <span class="n">sta</span><span class="o">.</span><span class="n">bowa</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">der</span><span class="o">.</span><span class="n">wz</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">qbb</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">beta</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">sta</span><span class="o">.</span><span class="n">bowa</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">-</span><span class="n">der</span><span class="o">.</span><span class="n">wb</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">qbb</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">beta</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">sta</span><span class="o">.</span><span class="n">bowa</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">-</span><span class="n">der</span><span class="o">.</span><span class="n">wb</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">*</span>
                          <span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">fbeta</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">-</span><span class="mf">1.</span><span class="p">)</span><span class="o">*</span><span class="p">((</span><span class="n">sta</span><span class="o">.</span><span class="n">bowa</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">-</span><span class="n">der</span><span class="o">.</span><span class="n">wz</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">/</span>
                                                 <span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nfk</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">-</span><span class="n">der</span><span class="o">.</span><span class="n">wz</span><span class="p">[</span><span class="n">k</span><span class="p">]))))</span></div>


<div class="viewcode-block" id="calc_qib1_v1"><a class="viewcode-back" href="../../../../lland.html#hydpy.models.lland.lland_model.calc_qib1_v1">[docs]</a><span class="k">def</span> <span class="nf">calc_qib1_v1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculate the first inflow component released from the soil.</span>

<span class="sd">    Required control parameters:</span>
<span class="sd">      |NHRU|</span>
<span class="sd">      |Lnk|</span>
<span class="sd">      |NFk|</span>
<span class="sd">      |DMin|</span>

<span class="sd">    Required derived parameter:</span>
<span class="sd">      |WB|</span>

<span class="sd">    Required state sequence:</span>
<span class="sd">      |BoWa|</span>

<span class="sd">    Calculated flux sequence:</span>
<span class="sd">      |QIB1|</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      :math:`QIB1 = DMin \\cdot \\frac{BoWa}{NFk}`</span>

<span class="sd">    Examples:</span>

<span class="sd">        For water and sealed areas, no interflow is calculated (the first</span>
<span class="sd">        three HRUs are of type |FLUSS|, |SEE|, and |VERS|, respectively).</span>
<span class="sd">        No principal distinction is made between the remaining land use</span>
<span class="sd">        classes (arable land |ACKER| has been selected for the last five</span>
<span class="sd">        HRUs arbitrarily):</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.lland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep(&#39;1d&#39;)</span>
<span class="sd">        &gt;&gt;&gt; simulationstep(&#39;12h&#39;)</span>
<span class="sd">        &gt;&gt;&gt; nhru(8)</span>
<span class="sd">        &gt;&gt;&gt; lnk(FLUSS, SEE, VERS, ACKER, ACKER, ACKER, ACKER, ACKER)</span>
<span class="sd">        &gt;&gt;&gt; dmax(10.0)</span>
<span class="sd">        &gt;&gt;&gt; dmin(4.0)</span>
<span class="sd">        &gt;&gt;&gt; nfk(101.0, 101.0, 101.0, 0.0, 101.0, 101.0, 101.0, 202.0)</span>
<span class="sd">        &gt;&gt;&gt; derived.wb(10.0)</span>
<span class="sd">        &gt;&gt;&gt; states.bowa = 10.1, 10.1, 10.1, 0.0, 0.0, 10.0, 10.1, 10.1</span>

<span class="sd">        Note the time dependence of parameter |DMin|:</span>

<span class="sd">        &gt;&gt;&gt; dmin</span>
<span class="sd">        dmin(4.0)</span>
<span class="sd">        &gt;&gt;&gt; dmin.values</span>
<span class="sd">        array([ 2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.])</span>

<span class="sd">        Compared to the calculation of |QBB|, the following results show</span>
<span class="sd">        some relevant differences:</span>

<span class="sd">        &gt;&gt;&gt; model.calc_qib1_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.qib1</span>
<span class="sd">        qib1(0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.2, 0.1)</span>

<span class="sd">        Firstly, as demonstrated with the help of the seventh and the</span>
<span class="sd">        eight HRU, the generation of the first interflow component |QIB1|</span>
<span class="sd">        depends on relative soil moisture.  Secondly, as demonstrated with</span>
<span class="sd">        the help the sixth and seventh HRU, it starts abruptly whenever</span>
<span class="sd">        the slightest exceedance of the threshold  parameter |WB| occurs.</span>
<span class="sd">        Such sharp discontinuouties are a potential source of trouble.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">con</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">der</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">flu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">sta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nhru</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">((</span><span class="n">con</span><span class="o">.</span><span class="n">lnk</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="n">VERS</span><span class="p">,</span> <span class="n">WASSER</span><span class="p">,</span> <span class="n">FLUSS</span><span class="p">,</span> <span class="n">SEE</span><span class="p">))</span> <span class="ow">or</span>
                <span class="p">(</span><span class="n">sta</span><span class="o">.</span><span class="n">bowa</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">der</span><span class="o">.</span><span class="n">wb</span><span class="p">[</span><span class="n">k</span><span class="p">])):</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">qib1</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">qib1</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">dmin</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">sta</span><span class="o">.</span><span class="n">bowa</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="n">con</span><span class="o">.</span><span class="n">nfk</span><span class="p">[</span><span class="n">k</span><span class="p">])</span></div>


<div class="viewcode-block" id="calc_qib2_v1"><a class="viewcode-back" href="../../../../lland.html#hydpy.models.lland.lland_model.calc_qib2_v1">[docs]</a><span class="k">def</span> <span class="nf">calc_qib2_v1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculate the first inflow component released from the soil.</span>

<span class="sd">    Required control parameters:</span>
<span class="sd">      |NHRU|</span>
<span class="sd">      |Lnk|</span>
<span class="sd">      |NFk|</span>
<span class="sd">      |DMin|</span>
<span class="sd">      |DMax|</span>

<span class="sd">    Required derived parameter:</span>
<span class="sd">      |WZ|</span>

<span class="sd">    Required state sequence:</span>
<span class="sd">      |BoWa|</span>

<span class="sd">    Calculated flux sequence:</span>
<span class="sd">      |QIB2|</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      :math:`QIB2 = (DMax-DMin) \\cdot</span>
<span class="sd">      (\\frac{BoWa-WZ}{NFk-WZ})^\\frac{3}{2}`</span>

<span class="sd">    Examples:</span>

<span class="sd">        For water and sealed areas, no interflow is calculated (the first</span>
<span class="sd">        three HRUs are of type |FLUSS|, |SEE|, and |VERS|, respectively).</span>
<span class="sd">        No principal distinction is made between the remaining land use</span>
<span class="sd">        classes (arable land |ACKER| has been selected for the last</span>
<span class="sd">        five HRUs arbitrarily):</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.lland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep(&#39;1d&#39;)</span>
<span class="sd">        &gt;&gt;&gt; simulationstep(&#39;12h&#39;)</span>
<span class="sd">        &gt;&gt;&gt; nhru(8)</span>
<span class="sd">        &gt;&gt;&gt; lnk(FLUSS, SEE, VERS, ACKER, ACKER, ACKER, ACKER, ACKER)</span>
<span class="sd">        &gt;&gt;&gt; dmax(10.0)</span>
<span class="sd">        &gt;&gt;&gt; dmin(4.0)</span>
<span class="sd">        &gt;&gt;&gt; nfk(100.0, 100.0, 100.0, 50.0, 100.0, 100.0, 100.0, 200.0)</span>
<span class="sd">        &gt;&gt;&gt; derived.wz(50.0)</span>
<span class="sd">        &gt;&gt;&gt; states.bowa = 100.0, 100.0, 100.0, 50.1, 50.0, 75.0, 100.0, 100.0</span>

<span class="sd">        Note the time dependence of parameters |DMin| (see the example above)</span>
<span class="sd">        and |DMax|:</span>

<span class="sd">        &gt;&gt;&gt; dmax</span>
<span class="sd">        dmax(10.0)</span>
<span class="sd">        &gt;&gt;&gt; dmax.values</span>
<span class="sd">        array([ 5.,  5.,  5.,  5.,  5.,  5.,  5.,  5.])</span>

<span class="sd">        The following results show that he calculation of |QIB2| both</span>
<span class="sd">        resembles those of |QBB| and |QIB1| in some regards:</span>

<span class="sd">        &gt;&gt;&gt; model.calc_qib2_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.qib2</span>
<span class="sd">        qib2(0.0, 0.0, 0.0, 0.0, 0.0, 1.06066, 3.0, 0.57735)</span>

<span class="sd">        In the given example, the maximum rate of total interflow</span>
<span class="sd">        generation is 5 mm/12h (parameter |DMax|).  For the seventh zone,</span>
<span class="sd">        which contains a saturated soil, the value calculated for the</span>
<span class="sd">        second interflow component (|QIB2|) is 3 mm/h.  The &quot;missing&quot;</span>
<span class="sd">        value of 2 mm/12h is be calculated by method |calc_qib1_v1|.</span>

<span class="sd">        (The fourth zone, which is slightly oversaturated, is only intended</span>
<span class="sd">        to demonstrate that zero division due to |NFk| = |WZ| is circumvented.)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">con</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">der</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">flu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">sta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nhru</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">((</span><span class="n">con</span><span class="o">.</span><span class="n">lnk</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="n">VERS</span><span class="p">,</span> <span class="n">WASSER</span><span class="p">,</span> <span class="n">FLUSS</span><span class="p">,</span> <span class="n">SEE</span><span class="p">))</span> <span class="ow">or</span>
                <span class="p">(</span><span class="n">sta</span><span class="o">.</span><span class="n">bowa</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">der</span><span class="o">.</span><span class="n">wz</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="ow">or</span> <span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nfk</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">der</span><span class="o">.</span><span class="n">wz</span><span class="p">[</span><span class="n">k</span><span class="p">])):</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">qib2</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">qib2</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">con</span><span class="o">.</span><span class="n">dmax</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">-</span><span class="n">con</span><span class="o">.</span><span class="n">dmin</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">*</span>
                           <span class="p">((</span><span class="n">sta</span><span class="o">.</span><span class="n">bowa</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">-</span><span class="n">der</span><span class="o">.</span><span class="n">wz</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">/</span>
                            <span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nfk</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">-</span><span class="n">der</span><span class="o">.</span><span class="n">wz</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span><span class="o">**</span><span class="mf">1.5</span><span class="p">)</span></div>


<div class="viewcode-block" id="calc_qdb_v1"><a class="viewcode-back" href="../../../../lland.html#hydpy.models.lland.lland_model.calc_qdb_v1">[docs]</a><span class="k">def</span> <span class="nf">calc_qdb_v1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculate direct runoff released from the soil.</span>

<span class="sd">    Required control parameters:</span>
<span class="sd">      |NHRU|</span>
<span class="sd">      |Lnk|</span>
<span class="sd">      |NFk|</span>
<span class="sd">      |BSf|</span>

<span class="sd">    Required state sequence:</span>
<span class="sd">      |BoWa|</span>

<span class="sd">    Required flux sequence:</span>
<span class="sd">      |WaDa|</span>

<span class="sd">    Calculated flux sequence:</span>
<span class="sd">      |QDB|</span>

<span class="sd">    Basic equations:</span>
<span class="sd">      :math:`QDB = \\Bigl \\lbrace</span>
<span class="sd">      {</span>
<span class="sd">      {max(Exz, 0) \\ | \\ SfA \\leq 0}</span>
<span class="sd">      \\atop</span>
<span class="sd">      {max(Exz + NFk \\cdot SfA^{BSf+1}, 0) \\ | \\ SfA &gt; 0}</span>
<span class="sd">      }`</span>
<span class="sd">      :math:`SFA = (1 - \\frac{BoWa}{NFk})^\\frac{1}{BSf+1} -</span>
<span class="sd">      \\frac{WaDa}{(BSf+1) \\cdot NFk}`</span>
<span class="sd">      :math:`Exz = (BoWa + WaDa) - NFk`</span>

<span class="sd">    Examples:</span>

<span class="sd">        For water areas (|FLUSS| and |SEE|), sealed areas (|VERS|), and</span>
<span class="sd">        areas without any soil storage capacity, all water is completely</span>
<span class="sd">        routed as direct runoff |QDB| (see the first four HRUs).  No</span>
<span class="sd">        principal distinction is made between the remaining land use</span>
<span class="sd">        classes (arable land |ACKER| has been selected for the last five</span>
<span class="sd">        HRUs arbitrarily):</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.lland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep(&#39;1d&#39;)</span>
<span class="sd">        &gt;&gt;&gt; simulationstep(&#39;12h&#39;)</span>
<span class="sd">        &gt;&gt;&gt; nhru(9)</span>
<span class="sd">        &gt;&gt;&gt; lnk(FLUSS, SEE, VERS, ACKER, ACKER, ACKER, ACKER, ACKER, ACKER)</span>
<span class="sd">        &gt;&gt;&gt; bsf(0.4)</span>
<span class="sd">        &gt;&gt;&gt; nfk(100.0, 100.0, 100.0, 0.0, 100.0, 100.0, 100.0, 100.0, 100.0)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.wada = 10.0</span>
<span class="sd">        &gt;&gt;&gt; states.bowa = (</span>
<span class="sd">        ...     100.0, 100.0, 100.0, 0.0, -0.1, 0.0, 50.0, 100.0, 100.1)</span>
<span class="sd">        &gt;&gt;&gt; model.calc_qdb_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.qdb</span>
<span class="sd">        qdb(10.0, 10.0, 10.0, 10.0, 0.142039, 0.144959, 1.993649, 10.0, 10.1)</span>

<span class="sd">        With the common |BSf| value of 0.4, the discharge coefficient</span>
<span class="sd">        increases more or less exponentially with soil moisture.</span>
<span class="sd">        For soil moisture values slightly below zero or above usable</span>
<span class="sd">        field capacity, plausible amounts of generated direct runoff</span>
<span class="sd">        are ensured.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">con</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">flu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">sta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">aid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">aides</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nhru</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">con</span><span class="o">.</span><span class="n">lnk</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="n">WASSER</span><span class="p">:</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">qdb</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>
        <span class="k">elif</span> <span class="p">((</span><span class="n">con</span><span class="o">.</span><span class="n">lnk</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="n">VERS</span><span class="p">,</span> <span class="n">FLUSS</span><span class="p">,</span> <span class="n">SEE</span><span class="p">))</span> <span class="ow">or</span>
                <span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nfk</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mf">0.</span><span class="p">)):</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">qdb</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">flu</span><span class="o">.</span><span class="n">wada</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">sta</span><span class="o">.</span><span class="n">bowa</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">con</span><span class="o">.</span><span class="n">nfk</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
                <span class="n">aid</span><span class="o">.</span><span class="n">sfa</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">sta</span><span class="o">.</span><span class="n">bowa</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="n">con</span><span class="o">.</span><span class="n">nfk</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">bsf</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">+</span><span class="mf">1.</span><span class="p">))</span> <span class="o">-</span>
                    <span class="p">(</span><span class="n">flu</span><span class="o">.</span><span class="n">wada</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">((</span><span class="n">con</span><span class="o">.</span><span class="n">bsf</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">+</span><span class="mf">1.</span><span class="p">)</span><span class="o">*</span><span class="n">con</span><span class="o">.</span><span class="n">nfk</span><span class="p">[</span><span class="n">k</span><span class="p">])))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">aid</span><span class="o">.</span><span class="n">sfa</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>
            <span class="n">aid</span><span class="o">.</span><span class="n">exz</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">sta</span><span class="o">.</span><span class="n">bowa</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">+</span><span class="n">flu</span><span class="o">.</span><span class="n">wada</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">-</span><span class="n">con</span><span class="o">.</span><span class="n">nfk</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">qdb</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">aid</span><span class="o">.</span><span class="n">exz</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">aid</span><span class="o">.</span><span class="n">sfa</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.</span><span class="p">:</span>
                <span class="n">flu</span><span class="o">.</span><span class="n">qdb</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+=</span> <span class="n">aid</span><span class="o">.</span><span class="n">sfa</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">bsf</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">+</span><span class="mf">1.</span><span class="p">)</span><span class="o">*</span><span class="n">con</span><span class="o">.</span><span class="n">nfk</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">qdb</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">flu</span><span class="o">.</span><span class="n">qdb</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="mf">0.</span><span class="p">)</span></div>


<div class="viewcode-block" id="calc_bowa_v1"><a class="viewcode-back" href="../../../../lland.html#hydpy.models.lland.lland_model.calc_bowa_v1">[docs]</a><span class="k">def</span> <span class="nf">calc_bowa_v1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Update soil moisture and correct fluxes if necessary.</span>

<span class="sd">    Required control parameters:</span>
<span class="sd">      |NHRU|</span>
<span class="sd">      |Lnk|</span>

<span class="sd">    Required flux sequence:</span>
<span class="sd">      |WaDa|</span>

<span class="sd">    Updated state sequence:</span>
<span class="sd">      |BoWa|</span>

<span class="sd">    Required (and eventually corrected) flux sequences:</span>
<span class="sd">      |EvB|</span>
<span class="sd">      |QBB|</span>
<span class="sd">      |QIB1|</span>
<span class="sd">      |QIB2|</span>
<span class="sd">      |QDB|</span>

<span class="sd">    Basic equations:</span>
<span class="sd">       :math:`\\frac{dBoWa}{dt} = WaDa - EvB - QBB - QIB1 - QIB2 - QDB`</span>
<span class="sd">       :math:`BoWa \\geq 0`</span>

<span class="sd">    Examples:</span>

<span class="sd">        For water areas (|FLUSS| and |SEE|) and sealed areas (|VERS|),</span>
<span class="sd">        soil moisture |BoWa| is simply set to zero and no flux correction</span>
<span class="sd">        are performed (see the first three HRUs).  No principal distinction</span>
<span class="sd">        is made between the remaining land use classes (arable land |ACKER|</span>
<span class="sd">        has been selected for the last four HRUs arbitrarily):</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.lland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep(&#39;1d&#39;)</span>
<span class="sd">        &gt;&gt;&gt; nhru(7)</span>
<span class="sd">        &gt;&gt;&gt; lnk(FLUSS, SEE, VERS, ACKER, ACKER, ACKER, ACKER)</span>
<span class="sd">        &gt;&gt;&gt; states.bowa = 2.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.wada = 1.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.evb = 1.0, 1.0, 1.0, 0.0, 0.1, 0.2, 0.3</span>
<span class="sd">        &gt;&gt;&gt; fluxes.qbb = 1.0, 1.0, 1.0, 0.0, 0.2, 0.4, 0.6</span>
<span class="sd">        &gt;&gt;&gt; fluxes.qib1 = 1.0, 1.0, 1.0, 0.0, 0.3, 0.6, 0.9</span>
<span class="sd">        &gt;&gt;&gt; fluxes.qib2 = 1.0, 1.0, 1.0, 0.0, 0.4, 0.8, 1.2</span>
<span class="sd">        &gt;&gt;&gt; fluxes.qdb = 1.0, 1.0, 1.0, 0.0, 0.5, 1.0, 1.5</span>
<span class="sd">        &gt;&gt;&gt; model.calc_bowa_v1()</span>
<span class="sd">        &gt;&gt;&gt; states.bowa</span>
<span class="sd">        bowa(0.0, 0.0, 0.0, 3.0, 1.5, 0.0, 0.0)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.evb</span>
<span class="sd">        evb(1.0, 1.0, 1.0, 0.0, 0.1, 0.2, 0.2)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.qbb</span>
<span class="sd">        qbb(1.0, 1.0, 1.0, 0.0, 0.2, 0.4, 0.4)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.qib1</span>
<span class="sd">        qib1(1.0, 1.0, 1.0, 0.0, 0.3, 0.6, 0.6)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.qib2</span>
<span class="sd">        qib2(1.0, 1.0, 1.0, 0.0, 0.4, 0.8, 0.8)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.qdb</span>
<span class="sd">        qdb(1.0, 1.0, 1.0, 0.0, 0.5, 1.0, 1.0)</span>

<span class="sd">        For the seventh HRU, the original total loss terms would result in a</span>
<span class="sd">        negative soil moisture value.  Hence it is reduced to the total loss</span>
<span class="sd">        term of the sixt HRU, which results exactly in a complete emptying</span>
<span class="sd">        of the soil storage.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">con</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">flu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">sta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">aid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">aides</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nhru</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">con</span><span class="o">.</span><span class="n">lnk</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="n">VERS</span><span class="p">,</span> <span class="n">WASSER</span><span class="p">,</span> <span class="n">FLUSS</span><span class="p">,</span> <span class="n">SEE</span><span class="p">):</span>
            <span class="n">sta</span><span class="o">.</span><span class="n">bowa</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">aid</span><span class="o">.</span><span class="n">bvl</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">flu</span><span class="o">.</span><span class="n">evb</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">+</span><span class="n">flu</span><span class="o">.</span><span class="n">qbb</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">+</span><span class="n">flu</span><span class="o">.</span><span class="n">qib1</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">+</span><span class="n">flu</span><span class="o">.</span><span class="n">qib2</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">+</span><span class="n">flu</span><span class="o">.</span><span class="n">qdb</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
            <span class="n">aid</span><span class="o">.</span><span class="n">mvl</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">sta</span><span class="o">.</span><span class="n">bowa</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">+</span><span class="n">flu</span><span class="o">.</span><span class="n">wada</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">aid</span><span class="o">.</span><span class="n">bvl</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">aid</span><span class="o">.</span><span class="n">mvl</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
                <span class="n">aid</span><span class="o">.</span><span class="n">rvl</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">aid</span><span class="o">.</span><span class="n">mvl</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="n">aid</span><span class="o">.</span><span class="n">bvl</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="n">flu</span><span class="o">.</span><span class="n">evb</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*=</span> <span class="n">aid</span><span class="o">.</span><span class="n">rvl</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="n">flu</span><span class="o">.</span><span class="n">qbb</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*=</span> <span class="n">aid</span><span class="o">.</span><span class="n">rvl</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="n">flu</span><span class="o">.</span><span class="n">qib1</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*=</span> <span class="n">aid</span><span class="o">.</span><span class="n">rvl</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="n">flu</span><span class="o">.</span><span class="n">qib2</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*=</span> <span class="n">aid</span><span class="o">.</span><span class="n">rvl</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="n">flu</span><span class="o">.</span><span class="n">qdb</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*=</span> <span class="n">aid</span><span class="o">.</span><span class="n">rvl</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="n">sta</span><span class="o">.</span><span class="n">bowa</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">sta</span><span class="o">.</span><span class="n">bowa</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">aid</span><span class="o">.</span><span class="n">mvl</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">-</span><span class="n">aid</span><span class="o">.</span><span class="n">bvl</span><span class="p">[</span><span class="n">k</span><span class="p">]</span></div>


<div class="viewcode-block" id="calc_qbgz_v1"><a class="viewcode-back" href="../../../../lland.html#hydpy.models.lland.lland_model.calc_qbgz_v1">[docs]</a><span class="k">def</span> <span class="nf">calc_qbgz_v1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Aggregate the amount of base flow released by all &quot;soil type&quot; HRUs</span>
<span class="sd">    and the &quot;net precipitation&quot; above water areas of type |SEE|.</span>

<span class="sd">    Water areas of type |SEE| are assumed to be directly connected with</span>
<span class="sd">    groundwater, but not with the stream network.  This is modelled by</span>
<span class="sd">    adding their (positive or negative) &quot;net input&quot; (|NKor|-|EvI|) to the</span>
<span class="sd">    &quot;percolation output&quot; of the soil containing HRUs.</span>

<span class="sd">    Required control parameters:</span>
<span class="sd">      |Lnk|</span>
<span class="sd">      |NHRU|</span>
<span class="sd">      |FHRU|</span>

<span class="sd">    Required flux sequences:</span>
<span class="sd">      |QBB|</span>
<span class="sd">      |NKor|</span>
<span class="sd">      |EvI|</span>

<span class="sd">    Calculated state sequence:</span>
<span class="sd">      |QBGZ|</span>

<span class="sd">    Basic equation:</span>
<span class="sd">       :math:`QBGZ = \\Sigma(FHRU \\cdot QBB) +</span>
<span class="sd">       \\Sigma(FHRU \\cdot (NKor_{SEE}-EvI_{SEE}))`</span>

<span class="sd">    Examples:</span>

<span class="sd">        The first example shows that |QBGZ| is the area weighted sum of</span>
<span class="sd">        |QBB| from &quot;soil type&quot; HRUs like arable land (|ACKER|) and of</span>
<span class="sd">        |NKor|-|EvI| from water areas of type |SEE|.  All other water</span>
<span class="sd">        areas (|WASSER| and |FLUSS|) and also sealed surfaces (|VERS|)</span>
<span class="sd">        have no impact on |QBGZ|:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.lland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nhru(6)</span>
<span class="sd">        &gt;&gt;&gt; lnk(ACKER, ACKER, VERS, WASSER, FLUSS, SEE)</span>
<span class="sd">        &gt;&gt;&gt; fhru(0.1, 0.2, 0.1, 0.1, 0.1, 0.4)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.qbb = 2., 4.0, 300.0, 300.0, 300.0, 300.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.nkor = 200.0, 200.0, 200.0, 200.0, 200.0, 20.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.evi = 100.0, 100.0, 100.0, 100.0, 100.0, 10.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_qbgz_v1()</span>
<span class="sd">        &gt;&gt;&gt; states.qbgz</span>
<span class="sd">        qbgz(5.0)</span>

<span class="sd">        The second example shows that large evaporation values above a</span>
<span class="sd">        HRU of type |SEE| can result in negative values of |QBGZ|:</span>

<span class="sd">        &gt;&gt;&gt; fluxes.evi[5] = 30</span>
<span class="sd">        &gt;&gt;&gt; model.calc_qbgz_v1()</span>
<span class="sd">        &gt;&gt;&gt; states.qbgz</span>
<span class="sd">        qbgz(-3.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">con</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">flu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">sta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">sta</span><span class="o">.</span><span class="n">qbgz</span> <span class="o">=</span> <span class="mf">0.</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nhru</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">con</span><span class="o">.</span><span class="n">lnk</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="n">SEE</span><span class="p">:</span>
            <span class="n">sta</span><span class="o">.</span><span class="n">qbgz</span> <span class="o">+=</span> <span class="n">con</span><span class="o">.</span><span class="n">fhru</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">flu</span><span class="o">.</span><span class="n">nkor</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">-</span><span class="n">flu</span><span class="o">.</span><span class="n">evi</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">con</span><span class="o">.</span><span class="n">lnk</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="n">WASSER</span><span class="p">,</span> <span class="n">FLUSS</span><span class="p">,</span> <span class="n">VERS</span><span class="p">):</span>
            <span class="n">sta</span><span class="o">.</span><span class="n">qbgz</span> <span class="o">+=</span> <span class="n">con</span><span class="o">.</span><span class="n">fhru</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="n">flu</span><span class="o">.</span><span class="n">qbb</span><span class="p">[</span><span class="n">k</span><span class="p">]</span></div>


<div class="viewcode-block" id="calc_qigz1_v1"><a class="viewcode-back" href="../../../../lland.html#hydpy.models.lland.lland_model.calc_qigz1_v1">[docs]</a><span class="k">def</span> <span class="nf">calc_qigz1_v1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Aggregate the amount of the first interflow component released</span>
<span class="sd">    by all HRUs.</span>

<span class="sd">    Required control parameters:</span>
<span class="sd">      |NHRU|</span>
<span class="sd">      |FHRU|</span>

<span class="sd">    Required flux sequence:</span>
<span class="sd">      |QIB1|</span>

<span class="sd">    Calculated state sequence:</span>
<span class="sd">      |QIGZ1|</span>

<span class="sd">    Basic equation:</span>
<span class="sd">       :math:`QIGZ1 = \\Sigma(FHRU \\cdot QIB1)`</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.lland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nhru(2)</span>
<span class="sd">        &gt;&gt;&gt; fhru(0.75, 0.25)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.qib1 = 1.0, 5.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_qigz1_v1()</span>
<span class="sd">        &gt;&gt;&gt; states.qigz1</span>
<span class="sd">        qigz1(2.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">con</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">flu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">sta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">sta</span><span class="o">.</span><span class="n">qigz1</span> <span class="o">=</span> <span class="mf">0.</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nhru</span><span class="p">):</span>
        <span class="n">sta</span><span class="o">.</span><span class="n">qigz1</span> <span class="o">+=</span> <span class="n">con</span><span class="o">.</span><span class="n">fhru</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="n">flu</span><span class="o">.</span><span class="n">qib1</span><span class="p">[</span><span class="n">k</span><span class="p">]</span></div>


<div class="viewcode-block" id="calc_qigz2_v1"><a class="viewcode-back" href="../../../../lland.html#hydpy.models.lland.lland_model.calc_qigz2_v1">[docs]</a><span class="k">def</span> <span class="nf">calc_qigz2_v1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Aggregate the amount of the second interflow component released</span>
<span class="sd">    by all HRUs.</span>

<span class="sd">    Required control parameters:</span>
<span class="sd">      |NHRU|</span>
<span class="sd">      |FHRU|</span>

<span class="sd">    Required flux sequence:</span>
<span class="sd">      |QIB2|</span>

<span class="sd">    Calculated state sequence:</span>
<span class="sd">      |QIGZ2|</span>

<span class="sd">    Basic equation:</span>
<span class="sd">       :math:`QIGZ2 = \\Sigma(FHRU \\cdot QIB2)`</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.lland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nhru(2)</span>
<span class="sd">        &gt;&gt;&gt; fhru(0.75, 0.25)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.qib2 = 1.0, 5.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_qigz2_v1()</span>
<span class="sd">        &gt;&gt;&gt; states.qigz2</span>
<span class="sd">        qigz2(2.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">con</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">flu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">sta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">sta</span><span class="o">.</span><span class="n">qigz2</span> <span class="o">=</span> <span class="mf">0.</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nhru</span><span class="p">):</span>
        <span class="n">sta</span><span class="o">.</span><span class="n">qigz2</span> <span class="o">+=</span> <span class="n">con</span><span class="o">.</span><span class="n">fhru</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="n">flu</span><span class="o">.</span><span class="n">qib2</span><span class="p">[</span><span class="n">k</span><span class="p">]</span></div>


<div class="viewcode-block" id="calc_qdgz_v1"><a class="viewcode-back" href="../../../../lland.html#hydpy.models.lland.lland_model.calc_qdgz_v1">[docs]</a><span class="k">def</span> <span class="nf">calc_qdgz_v1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Aggregate the amount of total direct flow released by all HRUs.</span>

<span class="sd">    Required control parameters:</span>
<span class="sd">      |Lnk|</span>
<span class="sd">      |NHRU|</span>
<span class="sd">      |FHRU|</span>

<span class="sd">    Required flux sequence:</span>
<span class="sd">      |QDB|</span>
<span class="sd">      |NKor|</span>
<span class="sd">      |EvI|</span>

<span class="sd">    Calculated flux sequence:</span>
<span class="sd">      |QDGZ|</span>

<span class="sd">    Basic equation:</span>
<span class="sd">       :math:`QDGZ = \\Sigma(FHRU \\cdot QDB) +</span>
<span class="sd">       \\Sigma(FHRU \\cdot (NKor_{FLUSS}-EvI_{FLUSS}))`</span>

<span class="sd">    Examples:</span>

<span class="sd">        The first example shows that |QDGZ| is the area weighted sum of</span>
<span class="sd">        |QDB| from &quot;land type&quot; HRUs like arable land (|ACKER|) and sealed</span>
<span class="sd">        surfaces (|VERS|) as well as of |NKor|-|EvI| from water areas of</span>
<span class="sd">        type |FLUSS|.  Water areas of type |WASSER| and |SEE| have no</span>
<span class="sd">        impact on |QDGZ|:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.lland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nhru(5)</span>
<span class="sd">        &gt;&gt;&gt; lnk(ACKER, VERS, WASSER, SEE, FLUSS)</span>
<span class="sd">        &gt;&gt;&gt; fhru(0.1, 0.2, 0.1, 0.2, 0.4)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.qdb = 2., 4.0, 300.0, 300.0, 300.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.nkor = 200.0, 200.0, 200.0, 200.0, 20.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.evi = 100.0, 100.0, 100.0, 100.0, 10.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_qdgz_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.qdgz</span>
<span class="sd">        qdgz(5.0)</span>

<span class="sd">        The second example shows that large evaporation values above a</span>
<span class="sd">        HRU of type |FLUSS| can result in negative values of |QDGZ|:</span>

<span class="sd">        &gt;&gt;&gt; fluxes.evi[4] = 30</span>
<span class="sd">        &gt;&gt;&gt; model.calc_qdgz_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.qdgz</span>
<span class="sd">        qdgz(-3.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">con</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">flu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">flu</span><span class="o">.</span><span class="n">qdgz</span> <span class="o">=</span> <span class="mf">0.</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nhru</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">con</span><span class="o">.</span><span class="n">lnk</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="n">FLUSS</span><span class="p">:</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">qdgz</span> <span class="o">+=</span> <span class="n">con</span><span class="o">.</span><span class="n">fhru</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">flu</span><span class="o">.</span><span class="n">nkor</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">-</span><span class="n">flu</span><span class="o">.</span><span class="n">evi</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">con</span><span class="o">.</span><span class="n">lnk</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="n">WASSER</span><span class="p">,</span> <span class="n">SEE</span><span class="p">):</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">qdgz</span> <span class="o">+=</span> <span class="n">con</span><span class="o">.</span><span class="n">fhru</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="n">flu</span><span class="o">.</span><span class="n">qdb</span><span class="p">[</span><span class="n">k</span><span class="p">]</span></div>


<div class="viewcode-block" id="calc_qdgz1_qdgz2_v1"><a class="viewcode-back" href="../../../../lland.html#hydpy.models.lland.lland_model.calc_qdgz1_qdgz2_v1">[docs]</a><span class="k">def</span> <span class="nf">calc_qdgz1_qdgz2_v1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Seperate total direct flow into a small and a fast component.</span>

<span class="sd">    Required control parameters:</span>
<span class="sd">      |A1|</span>
<span class="sd">      |A2|</span>

<span class="sd">    Required flux sequence:</span>
<span class="sd">      |QDGZ|</span>

<span class="sd">    Calculated state sequences:</span>
<span class="sd">      |QDGZ1|</span>
<span class="sd">      |QDGZ2|</span>

<span class="sd">    Basic equation:</span>
<span class="sd">       :math:`QDGZ2 = \\frac{(QDGZ-A2)^2}{QDGZ+A1-A2}`</span>
<span class="sd">       :math:`QDGZ1 = QDGZ - QDGZ1`</span>

<span class="sd">    Examples:</span>

<span class="sd">        The formula for calculating the amount of the fast component of</span>
<span class="sd">        direct flow is borrowed from the famous curve number approach.</span>
<span class="sd">        Parameter |A2| would be the initial loss and parameter |A1| the</span>
<span class="sd">        maximum storage, but one should not take this analogy too serious.</span>
<span class="sd">        Instead, with the value of parameter |A1| set to zero, parameter</span>
<span class="sd">        |A2| just defines the maximum amount of &quot;slow&quot; direct runoff per</span>
<span class="sd">        time step:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.lland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep(&#39;1d&#39;)</span>
<span class="sd">        &gt;&gt;&gt; simulationstep(&#39;12h&#39;)</span>
<span class="sd">        &gt;&gt;&gt; a1(0.0)</span>

<span class="sd">        Let us set the value of |A2| to 4 mm/d, which is 2 mm/12h with</span>
<span class="sd">        respect to the selected simulation step size:</span>

<span class="sd">        &gt;&gt;&gt; a2(4.0)</span>
<span class="sd">        &gt;&gt;&gt; a2</span>
<span class="sd">        a2(4.0)</span>
<span class="sd">        &gt;&gt;&gt; a2.value</span>
<span class="sd">        2.0</span>

<span class="sd">        Define a test function and let it calculate |QDGZ1| and |QDGZ1| for</span>
<span class="sd">        values of |QDGZ| ranging from -10 to 100 mm/12h:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import UnitTest</span>
<span class="sd">        &gt;&gt;&gt; test = UnitTest(model,</span>
<span class="sd">        ...                 model.calc_qdgz1_qdgz2_v1,</span>
<span class="sd">        ...                 last_example=6,</span>
<span class="sd">        ...                 parseqs=(fluxes.qdgz,</span>
<span class="sd">        ...                          states.qdgz1,</span>
<span class="sd">        ...                          states.qdgz2))</span>
<span class="sd">        &gt;&gt;&gt; test.nexts.qdgz = -10.0, 0.0, 1.0, 2.0, 3.0, 100.0</span>
<span class="sd">        &gt;&gt;&gt; test()</span>
<span class="sd">        | ex. |  qdgz | qdgz1 | qdgz2 |</span>
<span class="sd">        -------------------------------</span>
<span class="sd">        |   1 | -10.0 | -10.0 |   0.0 |</span>
<span class="sd">        |   2 |   0.0 |   0.0 |   0.0 |</span>
<span class="sd">        |   3 |   1.0 |   1.0 |   0.0 |</span>
<span class="sd">        |   4 |   2.0 |   2.0 |   0.0 |</span>
<span class="sd">        |   5 |   3.0 |   2.0 |   1.0 |</span>
<span class="sd">        |   6 | 100.0 |   2.0 |  98.0 |</span>

<span class="sd">        Setting |A2| to zero and |A1| to 4 mm/d (or 2 mm/12h) results in</span>
<span class="sd">        a smoother transition:</span>

<span class="sd">        &gt;&gt;&gt; a2(0.0)</span>
<span class="sd">        &gt;&gt;&gt; a1(4.0)</span>
<span class="sd">        &gt;&gt;&gt; test()</span>
<span class="sd">        | ex. |  qdgz |    qdgz1 |     qdgz2 |</span>
<span class="sd">        --------------------------------------</span>
<span class="sd">        |   1 | -10.0 |    -10.0 |       0.0 |</span>
<span class="sd">        |   2 |   0.0 |      0.0 |       0.0 |</span>
<span class="sd">        |   3 |   1.0 | 0.666667 |  0.333333 |</span>
<span class="sd">        |   4 |   2.0 |      1.0 |       1.0 |</span>
<span class="sd">        |   5 |   3.0 |      1.2 |       1.8 |</span>
<span class="sd">        |   6 | 100.0 | 1.960784 | 98.039216 |</span>

<span class="sd">        Alternatively, one can mix these two configurations by setting</span>
<span class="sd">        the values of both parameters to 2 mm/h:</span>

<span class="sd">        &gt;&gt;&gt; a2(2.0)</span>
<span class="sd">        &gt;&gt;&gt; a1(2.0)</span>
<span class="sd">        &gt;&gt;&gt; test()</span>
<span class="sd">        | ex. |  qdgz |    qdgz1 |    qdgz2 |</span>
<span class="sd">        -------------------------------------</span>
<span class="sd">        |   1 | -10.0 |    -10.0 |      0.0 |</span>
<span class="sd">        |   2 |   0.0 |      0.0 |      0.0 |</span>
<span class="sd">        |   3 |   1.0 |      1.0 |      0.0 |</span>
<span class="sd">        |   4 |   2.0 |      1.5 |      0.5 |</span>
<span class="sd">        |   5 |   3.0 | 1.666667 | 1.333333 |</span>
<span class="sd">        |   6 | 100.0 |     1.99 |    98.01 |</span>

<span class="sd">        Note the similarity of the results for very high values of total</span>
<span class="sd">        direct flow |QDGZ| in all three examples, which converge to the sum</span>
<span class="sd">        of the values of parameter |A1| and |A2|, representing the maximum</span>
<span class="sd">        value of `slow` direct flow generation per simulation step</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">con</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">flu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">sta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="k">if</span> <span class="n">flu</span><span class="o">.</span><span class="n">qdgz</span> <span class="o">&gt;</span> <span class="n">con</span><span class="o">.</span><span class="n">a2</span><span class="p">:</span>
        <span class="n">sta</span><span class="o">.</span><span class="n">qdgz2</span> <span class="o">=</span> <span class="p">(</span><span class="n">flu</span><span class="o">.</span><span class="n">qdgz</span><span class="o">-</span><span class="n">con</span><span class="o">.</span><span class="n">a2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">flu</span><span class="o">.</span><span class="n">qdgz</span><span class="o">+</span><span class="n">con</span><span class="o">.</span><span class="n">a1</span><span class="o">-</span><span class="n">con</span><span class="o">.</span><span class="n">a2</span><span class="p">)</span>
        <span class="n">sta</span><span class="o">.</span><span class="n">qdgz1</span> <span class="o">=</span> <span class="n">flu</span><span class="o">.</span><span class="n">qdgz</span><span class="o">-</span><span class="n">sta</span><span class="o">.</span><span class="n">qdgz2</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">sta</span><span class="o">.</span><span class="n">qdgz2</span> <span class="o">=</span> <span class="mf">0.</span>
        <span class="n">sta</span><span class="o">.</span><span class="n">qdgz1</span> <span class="o">=</span> <span class="n">flu</span><span class="o">.</span><span class="n">qdgz</span></div>


<div class="viewcode-block" id="calc_qbga_v1"><a class="viewcode-back" href="../../../../lland.html#hydpy.models.lland.lland_model.calc_qbga_v1">[docs]</a><span class="k">def</span> <span class="nf">calc_qbga_v1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform the runoff concentration calculation for base flow.</span>

<span class="sd">    The working equation is the analytical solution of the linear storage</span>
<span class="sd">    equation under the assumption of constant change in inflow during</span>
<span class="sd">    the simulation time step.</span>

<span class="sd">    Required derived parameter:</span>
<span class="sd">      |KB|</span>

<span class="sd">    Required flux sequence:</span>
<span class="sd">      |QBGZ|</span>

<span class="sd">    Calculated state sequence:</span>
<span class="sd">      |QBGA|</span>

<span class="sd">    Basic equation:</span>
<span class="sd">       :math:`QBGA_{neu} = QBGA_{alt} +</span>
<span class="sd">       (QBGZ_{alt}-QBGA_{alt}) \\cdot (1-exp(-KB^{-1})) +</span>
<span class="sd">       (QBGZ_{neu}-QBGZ_{alt}) \\cdot (1-KB\\cdot(1-exp(-KB^{-1})))`</span>

<span class="sd">    Examples:</span>

<span class="sd">        A normal test case:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.lland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; derived.kb(0.1)</span>
<span class="sd">        &gt;&gt;&gt; states.qbgz.old = 2.0</span>
<span class="sd">        &gt;&gt;&gt; states.qbgz.new = 4.0</span>
<span class="sd">        &gt;&gt;&gt; states.qbga.old = 3.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_qbga_v1()</span>
<span class="sd">        &gt;&gt;&gt; states.qbga</span>
<span class="sd">        qbga(3.800054)</span>

<span class="sd">        First extreme test case (zero division is circumvented):</span>

<span class="sd">        &gt;&gt;&gt; derived.kb(0.0)</span>
<span class="sd">        &gt;&gt;&gt; model.calc_qbga_v1()</span>
<span class="sd">        &gt;&gt;&gt; states.qbga</span>
<span class="sd">        qbga(4.0)</span>

<span class="sd">        Second extreme test case (numerical overflow is circumvented):</span>

<span class="sd">        &gt;&gt;&gt; derived.kb(1e500)</span>
<span class="sd">        &gt;&gt;&gt; model.calc_qbga_v1()</span>
<span class="sd">        &gt;&gt;&gt; states.qbga</span>
<span class="sd">        qbga(5.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">der</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">old</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess_old</span>
    <span class="n">new</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess_new</span>
    <span class="k">if</span> <span class="n">der</span><span class="o">.</span><span class="n">kb</span> <span class="o">&lt;=</span> <span class="mf">0.</span><span class="p">:</span>
        <span class="n">new</span><span class="o">.</span><span class="n">qbga</span> <span class="o">=</span> <span class="n">new</span><span class="o">.</span><span class="n">qbgz</span>
    <span class="k">elif</span> <span class="n">der</span><span class="o">.</span><span class="n">kb</span> <span class="o">&gt;</span> <span class="mf">1e200</span><span class="p">:</span>
        <span class="n">new</span><span class="o">.</span><span class="n">qbga</span> <span class="o">=</span> <span class="n">old</span><span class="o">.</span><span class="n">qbga</span><span class="o">+</span><span class="n">new</span><span class="o">.</span><span class="n">qbgz</span><span class="o">-</span><span class="n">old</span><span class="o">.</span><span class="n">qbgz</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">d_temp</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">modelutils</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">1.</span><span class="o">/</span><span class="n">der</span><span class="o">.</span><span class="n">kb</span><span class="p">))</span>
        <span class="n">new</span><span class="o">.</span><span class="n">qbga</span> <span class="o">=</span> <span class="p">(</span><span class="n">old</span><span class="o">.</span><span class="n">qbga</span> <span class="o">+</span>
                    <span class="p">(</span><span class="n">old</span><span class="o">.</span><span class="n">qbgz</span><span class="o">-</span><span class="n">old</span><span class="o">.</span><span class="n">qbga</span><span class="p">)</span><span class="o">*</span><span class="n">d_temp</span> <span class="o">+</span>
                    <span class="p">(</span><span class="n">new</span><span class="o">.</span><span class="n">qbgz</span><span class="o">-</span><span class="n">old</span><span class="o">.</span><span class="n">qbgz</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">der</span><span class="o">.</span><span class="n">kb</span><span class="o">*</span><span class="n">d_temp</span><span class="p">))</span></div>


<div class="viewcode-block" id="calc_qiga1_v1"><a class="viewcode-back" href="../../../../lland.html#hydpy.models.lland.lland_model.calc_qiga1_v1">[docs]</a><span class="k">def</span> <span class="nf">calc_qiga1_v1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform the runoff concentration calculation for the first</span>
<span class="sd">    interflow component.</span>

<span class="sd">    The working equation is the analytical solution of the linear storage</span>
<span class="sd">    equation under the assumption of constant change in inflow during</span>
<span class="sd">    the simulation time step.</span>

<span class="sd">    Required derived parameter:</span>
<span class="sd">      |KI1|</span>

<span class="sd">    Required state sequence:</span>
<span class="sd">      |QIGZ1|</span>

<span class="sd">    Calculated state sequence:</span>
<span class="sd">      |QIGA1|</span>

<span class="sd">    Basic equation:</span>
<span class="sd">       :math:`QIGA1_{neu} = QIGA1_{alt} +</span>
<span class="sd">       (QIGZ1_{alt}-QIGA1_{alt}) \\cdot (1-exp(-KI1^{-1})) +</span>
<span class="sd">       (QIGZ1_{neu}-QIGZ1_{alt}) \\cdot (1-KI1\\cdot(1-exp(-KI1^{-1})))`</span>

<span class="sd">    Examples:</span>

<span class="sd">        A normal test case:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.lland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; derived.ki1(0.1)</span>
<span class="sd">        &gt;&gt;&gt; states.qigz1.old = 2.0</span>
<span class="sd">        &gt;&gt;&gt; states.qigz1.new = 4.0</span>
<span class="sd">        &gt;&gt;&gt; states.qiga1.old = 3.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_qiga1_v1()</span>
<span class="sd">        &gt;&gt;&gt; states.qiga1</span>
<span class="sd">        qiga1(3.800054)</span>

<span class="sd">        First extreme test case (zero division is circumvented):</span>

<span class="sd">        &gt;&gt;&gt; derived.ki1(0.0)</span>
<span class="sd">        &gt;&gt;&gt; model.calc_qiga1_v1()</span>
<span class="sd">        &gt;&gt;&gt; states.qiga1</span>
<span class="sd">        qiga1(4.0)</span>

<span class="sd">        Second extreme test case (numerical overflow is circumvented):</span>

<span class="sd">        &gt;&gt;&gt; derived.ki1(1e500)</span>
<span class="sd">        &gt;&gt;&gt; model.calc_qiga1_v1()</span>
<span class="sd">        &gt;&gt;&gt; states.qiga1</span>
<span class="sd">        qiga1(5.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">der</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">old</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess_old</span>
    <span class="n">new</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess_new</span>
    <span class="k">if</span> <span class="n">der</span><span class="o">.</span><span class="n">ki1</span> <span class="o">&lt;=</span> <span class="mf">0.</span><span class="p">:</span>
        <span class="n">new</span><span class="o">.</span><span class="n">qiga1</span> <span class="o">=</span> <span class="n">new</span><span class="o">.</span><span class="n">qigz1</span>
    <span class="k">elif</span> <span class="n">der</span><span class="o">.</span><span class="n">ki1</span> <span class="o">&gt;</span> <span class="mf">1e200</span><span class="p">:</span>
        <span class="n">new</span><span class="o">.</span><span class="n">qiga1</span> <span class="o">=</span> <span class="n">old</span><span class="o">.</span><span class="n">qiga1</span><span class="o">+</span><span class="n">new</span><span class="o">.</span><span class="n">qigz1</span><span class="o">-</span><span class="n">old</span><span class="o">.</span><span class="n">qigz1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">d_temp</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">modelutils</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">1.</span><span class="o">/</span><span class="n">der</span><span class="o">.</span><span class="n">ki1</span><span class="p">))</span>
        <span class="n">new</span><span class="o">.</span><span class="n">qiga1</span> <span class="o">=</span> <span class="p">(</span><span class="n">old</span><span class="o">.</span><span class="n">qiga1</span> <span class="o">+</span>
                     <span class="p">(</span><span class="n">old</span><span class="o">.</span><span class="n">qigz1</span><span class="o">-</span><span class="n">old</span><span class="o">.</span><span class="n">qiga1</span><span class="p">)</span><span class="o">*</span><span class="n">d_temp</span> <span class="o">+</span>
                     <span class="p">(</span><span class="n">new</span><span class="o">.</span><span class="n">qigz1</span><span class="o">-</span><span class="n">old</span><span class="o">.</span><span class="n">qigz1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">der</span><span class="o">.</span><span class="n">ki1</span><span class="o">*</span><span class="n">d_temp</span><span class="p">))</span></div>


<div class="viewcode-block" id="calc_qiga2_v1"><a class="viewcode-back" href="../../../../lland.html#hydpy.models.lland.lland_model.calc_qiga2_v1">[docs]</a><span class="k">def</span> <span class="nf">calc_qiga2_v1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform the runoff concentration calculation for the second</span>
<span class="sd">    interflow component.</span>

<span class="sd">    The working equation is the analytical solution of the linear storage</span>
<span class="sd">    equation under the assumption of constant change in inflow during</span>
<span class="sd">    the simulation time step.</span>

<span class="sd">    Required derived parameter:</span>
<span class="sd">      |KI2|</span>

<span class="sd">    Required state sequence:</span>
<span class="sd">      |QIGZ2|</span>

<span class="sd">    Calculated state sequence:</span>
<span class="sd">      |QIGA2|</span>

<span class="sd">    Basic equation:</span>
<span class="sd">       :math:`QIGA2_{neu} = QIGA2_{alt} +</span>
<span class="sd">       (QIGZ2_{alt}-QIGA2_{alt}) \\cdot (1-exp(-KI2^{-1})) +</span>
<span class="sd">       (QIGZ2_{neu}-QIGZ2_{alt}) \\cdot (1-KI2\\cdot(1-exp(-KI2^{-1})))`</span>

<span class="sd">    Examples:</span>

<span class="sd">        A normal test case:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.lland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; derived.ki2(0.1)</span>
<span class="sd">        &gt;&gt;&gt; states.qigz2.old = 2.0</span>
<span class="sd">        &gt;&gt;&gt; states.qigz2.new = 4.0</span>
<span class="sd">        &gt;&gt;&gt; states.qiga2.old = 3.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_qiga2_v1()</span>
<span class="sd">        &gt;&gt;&gt; states.qiga2</span>
<span class="sd">        qiga2(3.800054)</span>

<span class="sd">        First extreme test case (zero division is circumvented):</span>

<span class="sd">        &gt;&gt;&gt; derived.ki2(0.0)</span>
<span class="sd">        &gt;&gt;&gt; model.calc_qiga2_v1()</span>
<span class="sd">        &gt;&gt;&gt; states.qiga2</span>
<span class="sd">        qiga2(4.0)</span>

<span class="sd">        Second extreme test case (numerical overflow is circumvented):</span>

<span class="sd">        &gt;&gt;&gt; derived.ki2(1e500)</span>
<span class="sd">        &gt;&gt;&gt; model.calc_qiga2_v1()</span>
<span class="sd">        &gt;&gt;&gt; states.qiga2</span>
<span class="sd">        qiga2(5.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">der</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">old</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess_old</span>
    <span class="n">new</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess_new</span>
    <span class="k">if</span> <span class="n">der</span><span class="o">.</span><span class="n">ki2</span> <span class="o">&lt;=</span> <span class="mf">0.</span><span class="p">:</span>
        <span class="n">new</span><span class="o">.</span><span class="n">qiga2</span> <span class="o">=</span> <span class="n">new</span><span class="o">.</span><span class="n">qigz2</span>
    <span class="k">elif</span> <span class="n">der</span><span class="o">.</span><span class="n">ki2</span> <span class="o">&gt;</span> <span class="mf">1e200</span><span class="p">:</span>
        <span class="n">new</span><span class="o">.</span><span class="n">qiga2</span> <span class="o">=</span> <span class="n">old</span><span class="o">.</span><span class="n">qiga2</span><span class="o">+</span><span class="n">new</span><span class="o">.</span><span class="n">qigz2</span><span class="o">-</span><span class="n">old</span><span class="o">.</span><span class="n">qigz2</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">d_temp</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">modelutils</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">1.</span><span class="o">/</span><span class="n">der</span><span class="o">.</span><span class="n">ki2</span><span class="p">))</span>
        <span class="n">new</span><span class="o">.</span><span class="n">qiga2</span> <span class="o">=</span> <span class="p">(</span><span class="n">old</span><span class="o">.</span><span class="n">qiga2</span> <span class="o">+</span>
                     <span class="p">(</span><span class="n">old</span><span class="o">.</span><span class="n">qigz2</span><span class="o">-</span><span class="n">old</span><span class="o">.</span><span class="n">qiga2</span><span class="p">)</span><span class="o">*</span><span class="n">d_temp</span> <span class="o">+</span>
                     <span class="p">(</span><span class="n">new</span><span class="o">.</span><span class="n">qigz2</span><span class="o">-</span><span class="n">old</span><span class="o">.</span><span class="n">qigz2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">der</span><span class="o">.</span><span class="n">ki2</span><span class="o">*</span><span class="n">d_temp</span><span class="p">))</span></div>


<div class="viewcode-block" id="calc_qdga1_v1"><a class="viewcode-back" href="../../../../lland.html#hydpy.models.lland.lland_model.calc_qdga1_v1">[docs]</a><span class="k">def</span> <span class="nf">calc_qdga1_v1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform the runoff concentration calculation for &quot;slow&quot; direct runoff.</span>

<span class="sd">    The working equation is the analytical solution of the linear storage</span>
<span class="sd">    equation under the assumption of constant change in inflow during</span>
<span class="sd">    the simulation time step.</span>

<span class="sd">    Required derived parameter:</span>
<span class="sd">      |KD1|</span>

<span class="sd">    Required state sequence:</span>
<span class="sd">      |QDGZ1|</span>

<span class="sd">    Calculated state sequence:</span>
<span class="sd">      |QDGA1|</span>

<span class="sd">    Basic equation:</span>
<span class="sd">       :math:`QDGA1_{neu} = QDGA1_{alt} +</span>
<span class="sd">       (QDGZ1_{alt}-QDGA1_{alt}) \\cdot (1-exp(-KD1^{-1})) +</span>
<span class="sd">       (QDGZ1_{neu}-QDGZ1_{alt}) \\cdot (1-KD1\\cdot(1-exp(-KD1^{-1})))`</span>

<span class="sd">    Examples:</span>

<span class="sd">        A normal test case:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.lland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; derived.kd1(0.1)</span>
<span class="sd">        &gt;&gt;&gt; states.qdgz1.old = 2.0</span>
<span class="sd">        &gt;&gt;&gt; states.qdgz1.new = 4.0</span>
<span class="sd">        &gt;&gt;&gt; states.qdga1.old = 3.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_qdga1_v1()</span>
<span class="sd">        &gt;&gt;&gt; states.qdga1</span>
<span class="sd">        qdga1(3.800054)</span>

<span class="sd">        First extreme test case (zero division is circumvented):</span>

<span class="sd">        &gt;&gt;&gt; derived.kd1(0.0)</span>
<span class="sd">        &gt;&gt;&gt; model.calc_qdga1_v1()</span>
<span class="sd">        &gt;&gt;&gt; states.qdga1</span>
<span class="sd">        qdga1(4.0)</span>

<span class="sd">        Second extreme test case (numerical overflow is circumvented):</span>

<span class="sd">        &gt;&gt;&gt; derived.kd1(1e500)</span>
<span class="sd">        &gt;&gt;&gt; model.calc_qdga1_v1()</span>
<span class="sd">        &gt;&gt;&gt; states.qdga1</span>
<span class="sd">        qdga1(5.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">der</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">old</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess_old</span>
    <span class="n">new</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess_new</span>
    <span class="k">if</span> <span class="n">der</span><span class="o">.</span><span class="n">kd1</span> <span class="o">&lt;=</span> <span class="mf">0.</span><span class="p">:</span>
        <span class="n">new</span><span class="o">.</span><span class="n">qdga1</span> <span class="o">=</span> <span class="n">new</span><span class="o">.</span><span class="n">qdgz1</span>
    <span class="k">elif</span> <span class="n">der</span><span class="o">.</span><span class="n">kd1</span> <span class="o">&gt;</span> <span class="mf">1e200</span><span class="p">:</span>
        <span class="n">new</span><span class="o">.</span><span class="n">qdga1</span> <span class="o">=</span> <span class="n">old</span><span class="o">.</span><span class="n">qdga1</span><span class="o">+</span><span class="n">new</span><span class="o">.</span><span class="n">qdgz1</span><span class="o">-</span><span class="n">old</span><span class="o">.</span><span class="n">qdgz1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">d_temp</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">modelutils</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">1.</span><span class="o">/</span><span class="n">der</span><span class="o">.</span><span class="n">kd1</span><span class="p">))</span>
        <span class="n">new</span><span class="o">.</span><span class="n">qdga1</span> <span class="o">=</span> <span class="p">(</span><span class="n">old</span><span class="o">.</span><span class="n">qdga1</span> <span class="o">+</span>
                     <span class="p">(</span><span class="n">old</span><span class="o">.</span><span class="n">qdgz1</span><span class="o">-</span><span class="n">old</span><span class="o">.</span><span class="n">qdga1</span><span class="p">)</span><span class="o">*</span><span class="n">d_temp</span> <span class="o">+</span>
                     <span class="p">(</span><span class="n">new</span><span class="o">.</span><span class="n">qdgz1</span><span class="o">-</span><span class="n">old</span><span class="o">.</span><span class="n">qdgz1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">der</span><span class="o">.</span><span class="n">kd1</span><span class="o">*</span><span class="n">d_temp</span><span class="p">))</span></div>


<div class="viewcode-block" id="calc_qdga2_v1"><a class="viewcode-back" href="../../../../lland.html#hydpy.models.lland.lland_model.calc_qdga2_v1">[docs]</a><span class="k">def</span> <span class="nf">calc_qdga2_v1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform the runoff concentration calculation for &quot;fast&quot; direct runoff.</span>

<span class="sd">    The working equation is the analytical solution of the linear storage</span>
<span class="sd">    equation under the assumption of constant change in inflow during</span>
<span class="sd">    the simulation time step.</span>

<span class="sd">    Required derived parameter:</span>
<span class="sd">      |KD2|</span>

<span class="sd">    Required state sequence:</span>
<span class="sd">      |QDGZ2|</span>

<span class="sd">    Calculated state sequence:</span>
<span class="sd">      |QDGA2|</span>

<span class="sd">    Basic equation:</span>
<span class="sd">       :math:`QDGA2_{neu} = QDGA2_{alt} +</span>
<span class="sd">       (QDGZ2_{alt}-QDGA2_{alt}) \\cdot (1-exp(-KD2^{-1})) +</span>
<span class="sd">       (QDGZ2_{neu}-QDGZ2_{alt}) \\cdot (1-KD2\\cdot(1-exp(-KD2^{-1})))`</span>

<span class="sd">    Examples:</span>

<span class="sd">        A normal test case:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.lland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; derived.kd2(0.1)</span>
<span class="sd">        &gt;&gt;&gt; states.qdgz2.old = 2.0</span>
<span class="sd">        &gt;&gt;&gt; states.qdgz2.new = 4.0</span>
<span class="sd">        &gt;&gt;&gt; states.qdga2.old = 3.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_qdga2_v1()</span>
<span class="sd">        &gt;&gt;&gt; states.qdga2</span>
<span class="sd">        qdga2(3.800054)</span>

<span class="sd">        First extreme test case (zero division is circumvented):</span>

<span class="sd">        &gt;&gt;&gt; derived.kd2(0.0)</span>
<span class="sd">        &gt;&gt;&gt; model.calc_qdga2_v1()</span>
<span class="sd">        &gt;&gt;&gt; states.qdga2</span>
<span class="sd">        qdga2(4.0)</span>

<span class="sd">        Second extreme test case (numerical overflow is circumvented):</span>

<span class="sd">        &gt;&gt;&gt; derived.kd2(1e500)</span>
<span class="sd">        &gt;&gt;&gt; model.calc_qdga2_v1()</span>
<span class="sd">        &gt;&gt;&gt; states.qdga2</span>
<span class="sd">        qdga2(5.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">der</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">old</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess_old</span>
    <span class="n">new</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess_new</span>
    <span class="k">if</span> <span class="n">der</span><span class="o">.</span><span class="n">kd2</span> <span class="o">&lt;=</span> <span class="mf">0.</span><span class="p">:</span>
        <span class="n">new</span><span class="o">.</span><span class="n">qdga2</span> <span class="o">=</span> <span class="n">new</span><span class="o">.</span><span class="n">qdgz2</span>
    <span class="k">elif</span> <span class="n">der</span><span class="o">.</span><span class="n">kd2</span> <span class="o">&gt;</span> <span class="mf">1e200</span><span class="p">:</span>
        <span class="n">new</span><span class="o">.</span><span class="n">qdga2</span> <span class="o">=</span> <span class="n">old</span><span class="o">.</span><span class="n">qdga2</span><span class="o">+</span><span class="n">new</span><span class="o">.</span><span class="n">qdgz2</span><span class="o">-</span><span class="n">old</span><span class="o">.</span><span class="n">qdgz2</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">d_temp</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">modelutils</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">1.</span><span class="o">/</span><span class="n">der</span><span class="o">.</span><span class="n">kd2</span><span class="p">))</span>
        <span class="n">new</span><span class="o">.</span><span class="n">qdga2</span> <span class="o">=</span> <span class="p">(</span><span class="n">old</span><span class="o">.</span><span class="n">qdga2</span> <span class="o">+</span>
                     <span class="p">(</span><span class="n">old</span><span class="o">.</span><span class="n">qdgz2</span><span class="o">-</span><span class="n">old</span><span class="o">.</span><span class="n">qdga2</span><span class="p">)</span><span class="o">*</span><span class="n">d_temp</span> <span class="o">+</span>
                     <span class="p">(</span><span class="n">new</span><span class="o">.</span><span class="n">qdgz2</span><span class="o">-</span><span class="n">old</span><span class="o">.</span><span class="n">qdgz2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">der</span><span class="o">.</span><span class="n">kd2</span><span class="o">*</span><span class="n">d_temp</span><span class="p">))</span></div>


<div class="viewcode-block" id="calc_q_v1"><a class="viewcode-back" href="../../../../lland.html#hydpy.models.lland.lland_model.calc_q_v1">[docs]</a><span class="k">def</span> <span class="nf">calc_q_v1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculate the final runoff.</span>

<span class="sd">    Note that, in case there are water areas, their |NKor| values are</span>
<span class="sd">    added and their |EvPo| values are subtracted from the &quot;potential&quot;</span>
<span class="sd">    runoff value, if possible.  This hold true for |WASSER| only and is</span>
<span class="sd">    due to compatibility with the original LARSIM implementation. Using land</span>
<span class="sd">    type |WASSER| can result  in problematic modifications of simulated</span>
<span class="sd">    runoff series. It seems advisable to use land type |FLUSS| and/or</span>
<span class="sd">    land type |SEE| instead.</span>

<span class="sd">    Required control parameters:</span>
<span class="sd">      |NHRU|</span>
<span class="sd">      |FHRU|</span>
<span class="sd">      |Lnk|</span>
<span class="sd">      |NegQ|</span>

<span class="sd">    Required flux sequence:</span>
<span class="sd">      |NKor|</span>

<span class="sd">    Updated flux sequence:</span>
<span class="sd">      |EvI|</span>

<span class="sd">    Required state sequences:</span>
<span class="sd">      |QBGA|</span>
<span class="sd">      |QIGA1|</span>
<span class="sd">      |QIGA2|</span>
<span class="sd">      |QDGA1|</span>
<span class="sd">      |QDGA2|</span>

<span class="sd">    Calculated flux sequence:</span>
<span class="sd">      |lland_fluxes.Q|</span>

<span class="sd">    Basic equations:</span>
<span class="sd">       :math:`Q = QBGA + QIGA1 + QIGA2 + QDGA1 + QDGA2 +</span>
<span class="sd">       NKor_{WASSER} - EvI_{WASSER}`</span>
<span class="sd">       :math:`Q \\geq 0`</span>

<span class="sd">    Examples:</span>

<span class="sd">        When there are no water areas in the respective subbasin (we</span>
<span class="sd">        choose arable land |ACKER| arbitrarily), the different runoff</span>
<span class="sd">        components are simply summed up:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.lland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nhru(3)</span>
<span class="sd">        &gt;&gt;&gt; lnk(ACKER, ACKER, ACKER)</span>
<span class="sd">        &gt;&gt;&gt; fhru(0.5, 0.2, 0.3)</span>
<span class="sd">        &gt;&gt;&gt; negq(False)</span>
<span class="sd">        &gt;&gt;&gt; states.qbga = 0.1</span>
<span class="sd">        &gt;&gt;&gt; states.qiga1 = 0.3</span>
<span class="sd">        &gt;&gt;&gt; states.qiga2 = 0.5</span>
<span class="sd">        &gt;&gt;&gt; states.qdga1 = 0.7</span>
<span class="sd">        &gt;&gt;&gt; states.qdga2 = 0.9</span>
<span class="sd">        &gt;&gt;&gt; fluxes.nkor = 10.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.evi = 4.0, 5.0, 3.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_q_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.q</span>
<span class="sd">        q(2.5)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.evi</span>
<span class="sd">        evi(4.0, 5.0, 3.0)</span>

<span class="sd">        The defined values of interception evaporation do not show any</span>
<span class="sd">        impact on the result of the given example, the predefined values</span>
<span class="sd">        for sequence |EvI| remain unchanged.  But when the first HRU is</span>
<span class="sd">        assumed to be a water area (|WASSER|), its adjusted precipitaton</span>
<span class="sd">        |NKor| value and its interception  evaporation |EvI| value are added</span>
<span class="sd">        to and subtracted from |lland_fluxes.Q| respectively:</span>

<span class="sd">        &gt;&gt;&gt; control.lnk(WASSER, VERS, NADELW)</span>
<span class="sd">        &gt;&gt;&gt; model.calc_q_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.q</span>
<span class="sd">        q(5.5)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.evi</span>
<span class="sd">        evi(4.0, 5.0, 3.0)</span>

<span class="sd">        Note that only 5 mm are added (instead of the |NKor| value 10 mm)</span>
<span class="sd">        and that only 2 mm are substracted (instead of the |EvI| value 4 mm,</span>
<span class="sd">        as the first HRU`s area only accounts for 50 % of the subbasin area.</span>

<span class="sd">        Setting also the land use class of the second HRU to land type</span>
<span class="sd">        |WASSER| and resetting |NKor| to zero would result in overdrying.</span>
<span class="sd">        To avoid this, both actual water evaporation values stored in</span>
<span class="sd">        sequence |EvI| are reduced by the same factor:</span>

<span class="sd">        &gt;&gt;&gt; control.lnk(WASSER, WASSER, NADELW)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.nkor = 0.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_q_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.q</span>
<span class="sd">        q(0.0)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.evi</span>
<span class="sd">        evi(3.333333, 4.166667, 3.0)</span>

<span class="sd">        The handling from water areas of type |FLUSS| and |SEE| differs</span>
<span class="sd">        from those of type |WASSER|, as these do receive their net input</span>
<span class="sd">        before the runoff concentration routines are applied.  This</span>
<span class="sd">        should be more realistic in most cases (especially for type |SEE|</span>
<span class="sd">        representing lakes not direct connected to the stream network).</span>
<span class="sd">        But it could sometimes result in negative outflow values. This</span>
<span class="sd">        is avoided by simply setting |lland_fluxes.Q| to zero and adding</span>
<span class="sd">        the truncated negative outflow value to the |EvI| value of all</span>
<span class="sd">        HRUs of type |FLUSS| and |SEE|:</span>

<span class="sd">        &gt;&gt;&gt; control.lnk(FLUSS, SEE, NADELW)</span>
<span class="sd">        &gt;&gt;&gt; states.qbga = -1.0</span>
<span class="sd">        &gt;&gt;&gt; states.qdga2 = -1.5</span>
<span class="sd">        &gt;&gt;&gt; fluxes.evi = 4.0, 5.0, 3.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_q_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.q</span>
<span class="sd">        q(0.0)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.evi</span>
<span class="sd">        evi(2.571429, 3.571429, 3.0)</span>

<span class="sd">        This adjustment of |EvI| is only correct regarding the total</span>
<span class="sd">        water balance.  Neither spatial nor temporal consistency of the</span>
<span class="sd">        resulting |EvI| values are assured.  In the most extreme case,</span>
<span class="sd">        even negative |EvI| values might occur.  This seems acceptable,</span>
<span class="sd">        as long as the adjustment of |EvI| is rarely triggered.  When in</span>
<span class="sd">        doubt about this, check sequences |EvPo| and |EvI| of HRUs of</span>
<span class="sd">        types |FLUSS| and |SEE| for possible discrepancies.  Also note</span>
<span class="sd">        that there might occur unnecessary corrections of |lland_fluxes.Q|</span>
<span class="sd">        in case landtype |WASSER| is combined with either landtype</span>
<span class="sd">        |SEE| or |FLUSS|.</span>

<span class="sd">        Eventually you might want to avoid correcting |lland_fluxes.Q|.</span>
<span class="sd">        This can be achieved by setting parameter |NegQ| to `True`:</span>

<span class="sd">        &gt;&gt;&gt; negq(True)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.evi = 4.0, 5.0, 3.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_q_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.q</span>
<span class="sd">        q(-1.0)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.evi</span>
<span class="sd">        evi(4.0, 5.0, 3.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">con</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">flu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">sta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">aid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">aides</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">flu</span><span class="o">.</span><span class="n">q</span> <span class="o">=</span> <span class="n">sta</span><span class="o">.</span><span class="n">qbga</span><span class="o">+</span><span class="n">sta</span><span class="o">.</span><span class="n">qiga1</span><span class="o">+</span><span class="n">sta</span><span class="o">.</span><span class="n">qiga2</span><span class="o">+</span><span class="n">sta</span><span class="o">.</span><span class="n">qdga1</span><span class="o">+</span><span class="n">sta</span><span class="o">.</span><span class="n">qdga2</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">con</span><span class="o">.</span><span class="n">negq</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">flu</span><span class="o">.</span><span class="n">q</span> <span class="o">&lt;</span> <span class="mf">0.</span><span class="p">:</span>
            <span class="n">d_area</span> <span class="o">=</span> <span class="mf">0.</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nhru</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">con</span><span class="o">.</span><span class="n">lnk</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="n">FLUSS</span><span class="p">,</span> <span class="n">SEE</span><span class="p">):</span>
                    <span class="n">d_area</span> <span class="o">+=</span> <span class="n">con</span><span class="o">.</span><span class="n">fhru</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">d_area</span> <span class="o">&gt;</span> <span class="mf">0.</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nhru</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">con</span><span class="o">.</span><span class="n">lnk</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="n">FLUSS</span><span class="p">,</span> <span class="n">SEE</span><span class="p">):</span>
                        <span class="n">flu</span><span class="o">.</span><span class="n">evi</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+=</span> <span class="n">flu</span><span class="o">.</span><span class="n">q</span><span class="o">/</span><span class="n">d_area</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">q</span> <span class="o">=</span> <span class="mf">0.</span>
    <span class="n">aid</span><span class="o">.</span><span class="n">epw</span> <span class="o">=</span> <span class="mf">0.</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nhru</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">con</span><span class="o">.</span><span class="n">lnk</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="n">WASSER</span><span class="p">:</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">q</span> <span class="o">+=</span> <span class="n">con</span><span class="o">.</span><span class="n">fhru</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="n">flu</span><span class="o">.</span><span class="n">nkor</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="n">aid</span><span class="o">.</span><span class="n">epw</span> <span class="o">+=</span> <span class="n">con</span><span class="o">.</span><span class="n">fhru</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="n">flu</span><span class="o">.</span><span class="n">evi</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">flu</span><span class="o">.</span><span class="n">q</span> <span class="o">&gt;</span> <span class="n">aid</span><span class="o">.</span><span class="n">epw</span><span class="p">)</span> <span class="ow">or</span> <span class="n">con</span><span class="o">.</span><span class="n">negq</span><span class="p">:</span>
        <span class="n">flu</span><span class="o">.</span><span class="n">q</span> <span class="o">-=</span> <span class="n">aid</span><span class="o">.</span><span class="n">epw</span>
    <span class="k">elif</span> <span class="n">aid</span><span class="o">.</span><span class="n">epw</span> <span class="o">&gt;</span> <span class="mf">0.</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nhru</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">con</span><span class="o">.</span><span class="n">lnk</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="n">WASSER</span><span class="p">:</span>
                <span class="n">flu</span><span class="o">.</span><span class="n">evi</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*=</span> <span class="n">flu</span><span class="o">.</span><span class="n">q</span><span class="o">/</span><span class="n">aid</span><span class="o">.</span><span class="n">epw</span>
        <span class="n">flu</span><span class="o">.</span><span class="n">q</span> <span class="o">=</span> <span class="mf">0.</span></div>


<div class="viewcode-block" id="pass_q_v1"><a class="viewcode-back" href="../../../../lland.html#hydpy.models.lland.lland_model.pass_q_v1">[docs]</a><span class="k">def</span> <span class="nf">pass_q_v1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Update the outlet link sequence.</span>

<span class="sd">    Required derived parameter:</span>
<span class="sd">      |QFactor|</span>

<span class="sd">    Required flux sequences:</span>
<span class="sd">      |lland_fluxes.Q|</span>

<span class="sd">    Calculated flux sequence:</span>
<span class="sd">      |lland_outlets.Q|</span>

<span class="sd">    Basic equation:</span>
<span class="sd">       :math:`Q_{outlets} = QFactor \\cdot Q_{fluxes}`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">der</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">flu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">outlets</span><span class="o">.</span><span class="n">fastaccess</span>
    <span class="n">out</span><span class="o">.</span><span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">der</span><span class="o">.</span><span class="n">qfactor</span><span class="o">*</span><span class="n">flu</span><span class="o">.</span><span class="n">q</span></div>


<div class="viewcode-block" id="Model"><a class="viewcode-back" href="../../../../lland.html#hydpy.models.lland.lland_model.Model">[docs]</a><span class="k">class</span> <span class="nc">Model</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base model for HydPy-L-Land.&quot;&quot;&quot;</span>

    <span class="n">_RUN_METHODS</span> <span class="o">=</span> <span class="p">(</span><span class="n">calc_nkor_v1</span><span class="p">,</span>
                    <span class="n">calc_tkor_v1</span><span class="p">,</span>
                    <span class="n">calc_et0_v1</span><span class="p">,</span>
                    <span class="n">calc_et0_wet0_v1</span><span class="p">,</span>
                    <span class="n">calc_evpo_v1</span><span class="p">,</span>
                    <span class="n">calc_nbes_inzp_v1</span><span class="p">,</span>
                    <span class="n">calc_evi_inzp_v1</span><span class="p">,</span>
                    <span class="n">calc_sbes_v1</span><span class="p">,</span>
                    <span class="n">calc_wgtf_v1</span><span class="p">,</span>
                    <span class="n">calc_schm_wats_v1</span><span class="p">,</span>
                    <span class="n">calc_wada_waes_v1</span><span class="p">,</span>
                    <span class="n">calc_evb_v1</span><span class="p">,</span>
                    <span class="n">calc_qbb_v1</span><span class="p">,</span>
                    <span class="n">calc_qib1_v1</span><span class="p">,</span>
                    <span class="n">calc_qib2_v1</span><span class="p">,</span>
                    <span class="n">calc_qdb_v1</span><span class="p">,</span>
                    <span class="n">calc_bowa_v1</span><span class="p">,</span>
                    <span class="n">calc_qbgz_v1</span><span class="p">,</span>
                    <span class="n">calc_qigz1_v1</span><span class="p">,</span>
                    <span class="n">calc_qigz2_v1</span><span class="p">,</span>
                    <span class="n">calc_qdgz_v1</span><span class="p">,</span>
                    <span class="n">calc_qdgz1_qdgz2_v1</span><span class="p">,</span>
                    <span class="n">calc_qbga_v1</span><span class="p">,</span>
                    <span class="n">calc_qiga1_v1</span><span class="p">,</span>
                    <span class="n">calc_qiga2_v1</span><span class="p">,</span>
                    <span class="n">calc_qdga1_v1</span><span class="p">,</span>
                    <span class="n">calc_qdga2_v1</span><span class="p">,</span>
                    <span class="n">calc_q_v1</span><span class="p">)</span>
    <span class="n">_OUTLET_METHODS</span> <span class="o">=</span> <span class="p">(</span><span class="n">pass_q_v1</span><span class="p">,)</span></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../../../index.html">Table Of Contents</a></h3>
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../framework.html">Framework Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../modelcollection.html">Model Collection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../development.html">Development</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../../index.html">HydPy 2.1-dev documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../../index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Christoph Tyralla.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.5.
    </div>
  </body>
</html>