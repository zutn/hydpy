
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>hydpy.core.sequencetools &#8212; HydPy 2.1-dev documentation</title>
    <link rel="stylesheet" href="../../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">HydPy 2.1-dev documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for hydpy.core.sequencetools</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;This module implements tools for handling the sequences (time series)</span>
<span class="sd">of hydrological models.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="c1"># import...</span>
<span class="c1"># ...from standard library</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">struct</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="c1"># ...from site-packages</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="c1"># ...from HydPy</span>
<span class="kn">from</span> <span class="nn">hydpy</span> <span class="k">import</span> <span class="n">pub</span>
<span class="kn">from</span> <span class="nn">hydpy.core</span> <span class="k">import</span> <span class="n">abctools</span>
<span class="kn">from</span> <span class="nn">hydpy.core</span> <span class="k">import</span> <span class="n">autodoctools</span>
<span class="kn">from</span> <span class="nn">hydpy.core</span> <span class="k">import</span> <span class="n">objecttools</span>
<span class="kn">from</span> <span class="nn">hydpy.core</span> <span class="k">import</span> <span class="n">timetools</span>
<span class="kn">from</span> <span class="nn">hydpy.core</span> <span class="k">import</span> <span class="n">variabletools</span>
<span class="kn">from</span> <span class="nn">hydpy.cythons.autogen</span> <span class="k">import</span> <span class="n">pointerutils</span>


<div class="viewcode-block" id="Sequences"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.Sequences">[docs]</a><span class="k">class</span> <span class="nc">Sequences</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Handles all sequences of a specific model.&quot;&quot;&quot;</span>

    <span class="n">_names_subseqs</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;inlets&#39;</span><span class="p">,</span> <span class="s1">&#39;receivers&#39;</span><span class="p">,</span> <span class="s1">&#39;inputs&#39;</span><span class="p">,</span> <span class="s1">&#39;fluxes&#39;</span><span class="p">,</span> <span class="s1">&#39;states&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;logs&#39;</span><span class="p">,</span> <span class="s1">&#39;aides&#39;</span><span class="p">,</span> <span class="s1">&#39;outlets&#39;</span><span class="p">,</span> <span class="s1">&#39;senders&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">cythonmodule</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;cythonmodule&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">cymodel</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;cymodel&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">cls</span><span class="p">)</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;Sequences&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">issubclass</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">SubSequences</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">cythonmodule</span><span class="p">:</span>
                    <span class="n">cls_fastaccess</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">cythonmodule</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
                    <span class="n">subseqs</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cls_fastaccess</span><span class="p">,</span> <span class="n">cymodel</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">subseqs</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subseqs</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">subseqs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_yield_iosubsequences</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">subseqs</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">subseqs</span><span class="p">,</span> <span class="n">abctools</span><span class="o">.</span><span class="n">IOSequencesABC</span><span class="p">):</span>
                <span class="k">yield</span> <span class="n">subseqs</span>

<div class="viewcode-block" id="Sequences.activate_disk"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.Sequences.activate_disk">[docs]</a>    <span class="k">def</span> <span class="nf">activate_disk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Call method |IOSequences.activate_disk| of all handled</span>
<span class="sd">        |IOSequences| objects.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">subseqs</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_yield_iosubsequences</span><span class="p">():</span>
            <span class="n">subseqs</span><span class="o">.</span><span class="n">activate_disk</span><span class="p">(</span><span class="n">names</span><span class="p">)</span></div>

<div class="viewcode-block" id="Sequences.deactivate_disk"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.Sequences.deactivate_disk">[docs]</a>    <span class="k">def</span> <span class="nf">deactivate_disk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Call method |IOSequences.deactivate_disk| of all handled</span>
<span class="sd">        |IOSequences| objects.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">subseqs</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_yield_iosubsequences</span><span class="p">():</span>
            <span class="n">subseqs</span><span class="o">.</span><span class="n">deactivate_disk</span><span class="p">(</span><span class="n">names</span><span class="p">)</span></div>

<div class="viewcode-block" id="Sequences.activate_ram"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.Sequences.activate_ram">[docs]</a>    <span class="k">def</span> <span class="nf">activate_ram</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Call method |IOSequences.activate_ram| of all handled</span>
<span class="sd">        |IOSequences| objects.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">subseqs</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_yield_iosubsequences</span><span class="p">():</span>
            <span class="n">subseqs</span><span class="o">.</span><span class="n">activate_ram</span><span class="p">(</span><span class="n">names</span><span class="p">)</span></div>

<div class="viewcode-block" id="Sequences.deactivate_ram"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.Sequences.deactivate_ram">[docs]</a>    <span class="k">def</span> <span class="nf">deactivate_ram</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Call method |IOSequences.deactivate_ram| of all handled</span>
<span class="sd">        |IOSequences| objects.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">subseqs</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_yield_iosubsequences</span><span class="p">():</span>
            <span class="n">subseqs</span><span class="o">.</span><span class="n">deactivate_ram</span><span class="p">(</span><span class="n">names</span><span class="p">)</span></div>

<div class="viewcode-block" id="Sequences.open_files"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.Sequences.open_files">[docs]</a>    <span class="k">def</span> <span class="nf">open_files</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Call method |IOSequences.open_files| of all handled</span>
<span class="sd">        |IOSequences| objects.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">subseqs</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_yield_iosubsequences</span><span class="p">():</span>
            <span class="n">subseqs</span><span class="o">.</span><span class="n">open_files</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span></div>

<div class="viewcode-block" id="Sequences.close_files"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.Sequences.close_files">[docs]</a>    <span class="k">def</span> <span class="nf">close_files</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Call method |IOSequences.close_files| of all handled</span>
<span class="sd">        |IOSequences| objects.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">subseqs</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_yield_iosubsequences</span><span class="p">():</span>
            <span class="n">subseqs</span><span class="o">.</span><span class="n">close_files</span><span class="p">()</span></div>

<div class="viewcode-block" id="Sequences.load_data"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.Sequences.load_data">[docs]</a>    <span class="k">def</span> <span class="nf">load_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Call method |InputSequences.load_data| of all handled</span>
<span class="sd">        |InputSequences| objects.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">subseqs</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">subseqs</span><span class="p">,</span> <span class="n">abctools</span><span class="o">.</span><span class="n">InputSequencesABC</span><span class="p">):</span>
                <span class="n">subseqs</span><span class="o">.</span><span class="n">load_data</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span></div>

<div class="viewcode-block" id="Sequences.save_data"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.Sequences.save_data">[docs]</a>    <span class="k">def</span> <span class="nf">save_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Call method `save_data|` of all handled |IOSequences|</span>
<span class="sd">        objects registered under |OutputSequencesABC|.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">subseqs</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">subseqs</span><span class="p">,</span> <span class="n">abctools</span><span class="o">.</span><span class="n">OutputSequencesABC</span><span class="p">):</span>
                <span class="n">subseqs</span><span class="o">.</span><span class="n">save_data</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span></div>

<div class="viewcode-block" id="Sequences.reset"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.Sequences.reset">[docs]</a>    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Call method |ConditionSequence.reset| of all handled</span>
<span class="sd">        |ConditionSequence| objects.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">subseqs</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">subseqs</span><span class="p">,</span> <span class="n">abctools</span><span class="o">.</span><span class="n">ConditionSequenceABC</span><span class="p">):</span>
                <span class="n">subseqs</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_names_subseqs</span><span class="p">:</span>
            <span class="n">subseqs</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">subseqs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">subseqs</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">conditions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generator object yielding all conditions (|StateSequence| and</span>
<span class="sd">        |LogSequence| objects).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">subseqs</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;states&#39;</span><span class="p">,</span> <span class="s1">&#39;logs&#39;</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">tuple_</span> <span class="ow">in</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subseqs</span><span class="p">,</span> <span class="p">()):</span>
                <span class="k">yield</span> <span class="n">tuple_</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">hasconditions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;True or False, whether the |Sequences| object &quot;handles conditions&quot;</span>
<span class="sd">        or not (at least one |StateSequence| or |LogSequence| object).&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">dummy</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">conditions</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_conditiondefaultfilename</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">devicename</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">filename</span> <span class="o">==</span> <span class="s1">&#39;?&#39;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="s1">&#39;To load or save the conditions of a model from or to a file, &#39;</span>
                <span class="s1">&#39;its filename must be known.  This can be done, by passing &#39;</span>
                <span class="s1">&#39;filename to method `load_conditions` or `save_conditions` &#39;</span>
                <span class="s1">&#39;directly.  But in complete HydPy applications, it is usally &#39;</span>
                <span class="s1">&#39;assumed to be consistent with the name of the element &#39;</span>
                <span class="s1">&#39;handling the model.  Actually, neither a filename is given &#39;</span>
                <span class="s1">&#39;nor does the model know its master element.&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39;.py&#39;</span>

<div class="viewcode-block" id="Sequences.load_conditions"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.Sequences.load_conditions">[docs]</a>    <span class="k">def</span> <span class="nf">load_conditions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Read the initial conditions from a file and assign them to the</span>
<span class="sd">        respective |StateSequence| and/or |LogSequence| objects handled by</span>
<span class="sd">        the actual |Sequences| object.</span>

<span class="sd">        If no filename or dirname is passed, the ones defined by the</span>
<span class="sd">        |ConditionManager| stored in module |pub| are used.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hasconditions</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">filename</span><span class="p">:</span>
                <span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_conditiondefaultfilename</span>
            <span class="n">namespace</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">seq</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">conditions</span><span class="p">:</span>
                <span class="n">namespace</span><span class="p">[</span><span class="n">seq</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">seq</span>
            <span class="n">namespace</span><span class="p">[</span><span class="s1">&#39;model&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span>
            <span class="n">code</span> <span class="o">=</span> <span class="n">pub</span><span class="o">.</span><span class="n">conditionmanager</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">exec</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">BaseException</span><span class="p">:</span>
                <span class="n">objecttools</span><span class="o">.</span><span class="n">augment_excmessage</span><span class="p">(</span>
                    <span class="s1">&#39;While trying to gather initial conditions of element </span><span class="si">%s</span><span class="s1">&#39;</span>
                    <span class="o">%</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">devicename</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span></div>

<div class="viewcode-block" id="Sequences.save_conditions"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.Sequences.save_conditions">[docs]</a>    <span class="k">def</span> <span class="nf">save_conditions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Query the actual conditions of the |StateSequence| and/or</span>
<span class="sd">        |LogSequence| objects handled by the actual |Sequences| object and</span>
<span class="sd">        write them into a initial condition file.</span>

<span class="sd">        If no filename or dirname is passed, the ones defined by the</span>
<span class="sd">        |ConditionManager| stored in module |pub| are used.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hasconditions</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">filename</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_conditiondefaultfilename</span>
            <span class="n">con</span> <span class="o">=</span> <span class="n">pub</span><span class="o">.</span><span class="n">controlmanager</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;# -*- coding: utf-8 -*-</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;from hydpy.models.</span><span class="si">%s</span><span class="s1"> import *</span><span class="se">\n\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">,</span>
                     <span class="s1">&#39;controlcheck(projectdir=&quot;</span><span class="si">%s</span><span class="s1">&quot;, controldir=&quot;</span><span class="si">%s</span><span class="s1">&quot;)</span><span class="se">\n\n</span><span class="s1">&#39;</span>
                     <span class="o">%</span> <span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">projectdir</span><span class="p">,</span> <span class="n">con</span><span class="o">.</span><span class="n">currentdir</span><span class="p">)]</span>
            <span class="k">for</span> <span class="n">seq</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">conditions</span><span class="p">:</span>
                <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">pub</span><span class="o">.</span><span class="n">conditionmanager</span><span class="o">.</span><span class="n">save_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">))</span></div>

<div class="viewcode-block" id="Sequences.trim_conditions"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.Sequences.trim_conditions">[docs]</a>    <span class="k">def</span> <span class="nf">trim_conditions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Call method |trim| of each handled |ConditionSequence|.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">seq</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">conditions</span><span class="p">:</span>
            <span class="n">seq</span><span class="o">.</span><span class="n">trim</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span></div>


<span class="k">class</span> <span class="nc">_MetaSubSequencesType</span><span class="p">(</span><span class="nb">type</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__new__</span><span class="p">(</span><span class="n">mcs</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">parents</span><span class="p">,</span> <span class="n">dict_</span><span class="p">):</span>
        <span class="n">seqclasses</span> <span class="o">=</span> <span class="n">dict_</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;_SEQCLASSES&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">seqclasses</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
                <span class="s1">&#39;For class `</span><span class="si">%s</span><span class="s1">`, the required tuple `_SEQCLASSES` is not &#39;</span>
                <span class="s1">&#39;defined.  Please see the documentation of class &#39;</span>
                <span class="s1">&#39;`SubSequences` of module `sequencetools` for further &#39;</span>
                <span class="s1">&#39;information.&#39;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">seqclasses</span><span class="p">:</span>
            <span class="n">lst</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="se">\n\n\n</span><span class="s1">    The following sequence classes are selected:&#39;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">seqclass</span> <span class="ow">in</span> <span class="n">seqclasses</span><span class="p">:</span>
                <span class="n">lst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;      * :class:`~</span><span class="si">%s</span><span class="s1">` </span><span class="si">%s</span><span class="s1">&#39;</span>
                           <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="n">seqclass</span><span class="o">.</span><span class="vm">__module__</span><span class="p">,</span>
                                        <span class="n">seqclass</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)),</span>
                              <span class="n">autodoctools</span><span class="o">.</span><span class="n">description</span><span class="p">(</span><span class="n">seqclass</span><span class="p">)))</span>
            <span class="n">doc</span> <span class="o">=</span> <span class="n">dict_</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;__doc__&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">doc</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">doc</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="n">dict_</span><span class="p">[</span><span class="s1">&#39;__doc__&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">doc</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">l</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lst</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">type</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">mcs</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">parents</span><span class="p">,</span> <span class="n">dict_</span><span class="p">)</span>


<span class="n">_MetaSubSequencesClass</span> <span class="o">=</span> <span class="n">_MetaSubSequencesType</span><span class="p">(</span><span class="s1">&#39;_MetaSubSequencesClass&#39;</span><span class="p">,</span>
                                               <span class="p">(),</span> <span class="p">{</span><span class="s1">&#39;_SEQCLASSES&#39;</span><span class="p">:</span> <span class="p">()})</span>


<div class="viewcode-block" id="SubSequences"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.SubSequences">[docs]</a><span class="k">class</span> <span class="nc">SubSequences</span><span class="p">(</span><span class="n">_MetaSubSequencesClass</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base class for handling subgroups of sequences.</span>

<span class="sd">    Attributes:</span>
<span class="sd">      * seqs: The parent |Sequences| object.</span>
<span class="sd">      * fastaccess: The  |sequencetools.FastAccess| object allowing fast</span>
<span class="sd">        access to the sequence values. In `Cython` mode, model specific</span>
<span class="sd">        cdef classes are applied.</span>

<span class="sd">    Additional attributes are the actual |Sequence| instances, representing</span>
<span class="sd">    the individual time series.  These need to be defined in</span>
<span class="sd">    |SubSequences| subclasses.  Therefore, one needs to collect the</span>
<span class="sd">    appropriate |Sequence| subclasses in the (hidden) class attribute</span>
<span class="sd">    `_SEQCLASSES`, as shown in the following example:</span>

<span class="sd">    &gt;&gt;&gt; from hydpy.core.sequencetools import *</span>
<span class="sd">    &gt;&gt;&gt; class Temperature(Sequence):</span>
<span class="sd">    ...    NDIM, NUMERIC = 0, False</span>
<span class="sd">    &gt;&gt;&gt; class Precipitation(Sequence):</span>
<span class="sd">    ...    NDIM, NUMERIC = 0, True</span>
<span class="sd">    &gt;&gt;&gt; class InputSequences(SubSequences):</span>
<span class="sd">    ...     _SEQCLASSES = (Temperature, Precipitation)</span>
<span class="sd">    &gt;&gt;&gt; inputs = InputSequences(None) # Assign `None` for brevity.</span>
<span class="sd">    &gt;&gt;&gt; inputs</span>
<span class="sd">    temperature(nan)</span>
<span class="sd">    precipitation(nan)</span>

<span class="sd">    The order within the tuple determines the order of iteration, hence:</span>

<span class="sd">    &gt;&gt;&gt; for sequence in inputs:</span>
<span class="sd">    ...     print(sequence)</span>
<span class="sd">    temperature(nan)</span>
<span class="sd">    precipitation(nan)</span>

<span class="sd">    If one forgets to define a `_SEQCLASSES` tuple so (and maybe tries to</span>
<span class="sd">    add the sequences in the constructor of the subclass of |SubSequences|,</span>
<span class="sd">    the following error is raised:</span>

<span class="sd">    &gt;&gt;&gt; class InputSequences(SubSequences):</span>
<span class="sd">    ...     pass</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">    ...</span>
<span class="sd">    NotImplementedError: For class `InputSequences`, the required tuple \</span>
<span class="sd">`_SEQCLASSES` is not defined.  Please see the documentation of class \</span>
<span class="sd">`SubSequences` of module `sequencetools` for further information.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_SEQCLASSES</span> <span class="o">=</span> <span class="p">()</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seqs</span><span class="p">,</span> <span class="n">cls_fastaccess</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cymodel</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seqs</span> <span class="o">=</span> <span class="n">seqs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_initfastaccess</span><span class="p">(</span><span class="n">cls_fastaccess</span><span class="p">,</span> <span class="n">cymodel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_initsequences</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_initfastaccess</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cls_fastaccess</span><span class="p">,</span> <span class="n">cymodel</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">cls_fastaccess</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span> <span class="o">=</span> <span class="n">FastAccess</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span> <span class="o">=</span> <span class="n">cls_fastaccess</span><span class="p">()</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">cymodel</span><span class="o">.</span><span class="n">sequences</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_initsequences</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">cls_seq</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_SEQCLASSES</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">instancename</span><span class="p">(</span><span class="n">cls_seq</span><span class="p">),</span> <span class="n">cls_seq</span><span class="p">())</span>

<div class="viewcode-block" id="SubSequences.getname"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.SubSequences.getname">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">getname</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">instancename</span><span class="p">(</span><span class="bp">cls</span><span class="p">)[:</span><span class="o">-</span><span class="mi">8</span><span class="p">]</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getname</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Attributes and methods should usually not be replaced.  Existing</span>
<span class="sd">        |Sequence| attributes are protected in a way, that only their</span>
<span class="sd">        values are changed through assignements.  For new |Sequence|</span>
<span class="sd">        attributes, additional `fastaccess` references are defined.  If you</span>
<span class="sd">        actually want to replace a sequence, you have to delete it first.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">attr</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">):</span>
                <span class="n">value</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">attr</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="n">value</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                    <span class="s1">&#39;`</span><span class="si">%s</span><span class="s1">` instances do not allow the direct replacement of &#39;</span>
                    <span class="s1">&#39;their members.  After initialization you should usually &#39;</span>
                    <span class="s1">&#39;only change parameter values through assignements.  &#39;</span>
                    <span class="s1">&#39;If you really need to replace a object member, delete &#39;</span>
                    <span class="s1">&#39;it beforehand.&#39;</span>
                    <span class="o">%</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">classname</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">seqclass</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_SEQCLASSES</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">instancename</span><span class="p">(</span><span class="n">seqclass</span><span class="p">)</span>
            <span class="k">yield</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">pub</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">reprcomments</span><span class="p">:</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;#</span><span class="si">%s</span><span class="s1"> object defined in module </span><span class="si">%s</span><span class="s1">.&#39;</span>
                         <span class="o">%</span> <span class="p">(</span><span class="n">objecttools</span><span class="o">.</span><span class="n">classname</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span>
                            <span class="n">objecttools</span><span class="o">.</span><span class="n">modulename</span><span class="p">(</span><span class="bp">self</span><span class="p">)))</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;#The implemented sequences with their actual &#39;</span>
                         <span class="s1">&#39;values are:&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">sequence</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">repr</span><span class="p">(</span><span class="n">sequence</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">BaseException</span><span class="p">:</span>
                <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">(?)&#39;</span> <span class="o">%</span> <span class="n">sequence</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__dir__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">dir_</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>


<div class="viewcode-block" id="IOSequences"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.IOSequences">[docs]</a><span class="k">class</span> <span class="nc">IOSequences</span><span class="p">(</span><span class="n">SubSequences</span><span class="p">):</span>
    <span class="n">_SEQCLASSES</span> <span class="o">=</span> <span class="p">()</span>

<div class="viewcode-block" id="IOSequences.open_files"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.IOSequences.open_files">[docs]</a>    <span class="k">def</span> <span class="nf">open_files</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="o">.</span><span class="n">open_files</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span></div>

<div class="viewcode-block" id="IOSequences.close_files"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.IOSequences.close_files">[docs]</a>    <span class="k">def</span> <span class="nf">close_files</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="o">.</span><span class="n">close_files</span><span class="p">()</span></div>

<div class="viewcode-block" id="IOSequences.activate_ram"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.IOSequences.activate_ram">[docs]</a>    <span class="k">def</span> <span class="nf">activate_ram</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">seq</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">seq</span><span class="o">.</span><span class="n">activate_ram</span><span class="p">()</span></div>

<div class="viewcode-block" id="IOSequences.deactivate_ram"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.IOSequences.deactivate_ram">[docs]</a>    <span class="k">def</span> <span class="nf">deactivate_ram</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">seq</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">seq</span><span class="o">.</span><span class="n">deactivate_ram</span><span class="p">()</span></div>

<div class="viewcode-block" id="IOSequences.activate_disk"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.IOSequences.activate_disk">[docs]</a>    <span class="k">def</span> <span class="nf">activate_disk</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">seq</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">seq</span><span class="o">.</span><span class="n">activate_disk</span><span class="p">()</span></div>

<div class="viewcode-block" id="IOSequences.deactivate_disk"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.IOSequences.deactivate_disk">[docs]</a>    <span class="k">def</span> <span class="nf">deactivate_disk</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">seq</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">seq</span><span class="o">.</span><span class="n">deactivate_disk</span><span class="p">()</span></div>

<div class="viewcode-block" id="IOSequences.ram2disk"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.IOSequences.ram2disk">[docs]</a>    <span class="k">def</span> <span class="nf">ram2disk</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">seq</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">seq</span><span class="o">.</span><span class="n">ram2disk</span><span class="p">()</span></div>

<div class="viewcode-block" id="IOSequences.disk2ram"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.IOSequences.disk2ram">[docs]</a>    <span class="k">def</span> <span class="nf">disk2ram</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">seq</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">seq</span><span class="o">.</span><span class="n">disk2ram</span><span class="p">()</span></div></div>


<span class="n">abctools</span><span class="o">.</span><span class="n">IOSequencesABC</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">IOSequences</span><span class="p">)</span>


<div class="viewcode-block" id="InputSequences"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.InputSequences">[docs]</a><span class="k">class</span> <span class="nc">InputSequences</span><span class="p">(</span><span class="n">IOSequences</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base class for handling input sequences.&quot;&quot;&quot;</span>
    <span class="n">_SEQCLASSES</span> <span class="o">=</span> <span class="p">()</span>

<div class="viewcode-block" id="InputSequences.load_data"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.InputSequences.load_data">[docs]</a>    <span class="k">def</span> <span class="nf">load_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="o">.</span><span class="n">load_data</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span></div></div>


<span class="n">abctools</span><span class="o">.</span><span class="n">InputSequencesABC</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">InputSequences</span><span class="p">)</span>


<div class="viewcode-block" id="FluxSequences"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.FluxSequences">[docs]</a><span class="k">class</span> <span class="nc">FluxSequences</span><span class="p">(</span><span class="n">IOSequences</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base class for handling flux sequences.&quot;&quot;&quot;</span>
    <span class="n">_SEQCLASSES</span> <span class="o">=</span> <span class="p">()</span>

<div class="viewcode-block" id="FluxSequences.getname"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.FluxSequences.getname">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">getname</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;fluxes&#39;</span></div>

<div class="viewcode-block" id="FluxSequences.save_data"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.FluxSequences.save_data">[docs]</a>    <span class="k">def</span> <span class="nf">save_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="o">.</span><span class="n">save_data</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">numerics</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Iterator for `numerical` flux sequences.</span>

<span class="sd">        `numerical` means that the `NUMERIC` class attribute of the</span>
<span class="sd">        respective sequence is `True`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">flux</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">flux</span><span class="o">.</span><span class="n">NUMERIC</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">flux</span></div>


<span class="n">abctools</span><span class="o">.</span><span class="n">OutputSequencesABC</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">FluxSequences</span><span class="p">)</span>


<div class="viewcode-block" id="StateSequences"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.StateSequences">[docs]</a><span class="k">class</span> <span class="nc">StateSequences</span><span class="p">(</span><span class="n">IOSequences</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base class for handling state sequences.&quot;&quot;&quot;</span>
    <span class="n">_SEQCLASSES</span> <span class="o">=</span> <span class="p">()</span>

    <span class="k">def</span> <span class="nf">_initfastaccess</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cls_fastaccess</span><span class="p">,</span> <span class="n">cymodel</span><span class="p">):</span>
        <span class="n">IOSequences</span><span class="o">.</span><span class="n">_initfastaccess</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cls_fastaccess</span><span class="p">,</span> <span class="n">cymodel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fastaccess_new</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">if</span> <span class="n">cls_fastaccess</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fastaccess_old</span> <span class="o">=</span> <span class="n">FastAccess</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">cymodel</span><span class="o">.</span><span class="n">sequences</span><span class="p">,</span> <span class="s1">&#39;new_states&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fastaccess_old</span> <span class="o">=</span> <span class="n">cls_fastaccess</span><span class="p">()</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">cymodel</span><span class="o">.</span><span class="n">sequences</span><span class="p">,</span> <span class="s1">&#39;old_states&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fastaccess_old</span><span class="p">)</span>

<div class="viewcode-block" id="StateSequences.new2old"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.StateSequences.new2old">[docs]</a>    <span class="k">def</span> <span class="nf">new2old</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Assign the new/final state values of the actual time step to the</span>
<span class="sd">        new/initial state values of the next time step.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">seq</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">seq</span><span class="o">.</span><span class="n">new2old</span><span class="p">()</span></div>

<div class="viewcode-block" id="StateSequences.save_data"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.StateSequences.save_data">[docs]</a>    <span class="k">def</span> <span class="nf">save_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="o">.</span><span class="n">save_data</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span></div>

<div class="viewcode-block" id="StateSequences.reset"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.StateSequences.reset">[docs]</a>    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">seq</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">seq</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span></div></div>


<span class="n">abctools</span><span class="o">.</span><span class="n">OutputSequencesABC</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">StateSequences</span><span class="p">)</span>


<div class="viewcode-block" id="LogSequences"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.LogSequences">[docs]</a><span class="k">class</span> <span class="nc">LogSequences</span><span class="p">(</span><span class="n">SubSequences</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base class for handling log sequences.&quot;&quot;&quot;</span>
    <span class="n">_SEQCLASSES</span> <span class="o">=</span> <span class="p">()</span>

<div class="viewcode-block" id="LogSequences.reset"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.LogSequences.reset">[docs]</a>    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">seq</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">seq</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="AideSequences"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.AideSequences">[docs]</a><span class="k">class</span> <span class="nc">AideSequences</span><span class="p">(</span><span class="n">SubSequences</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base class for handling aide sequences.&quot;&quot;&quot;</span>
    <span class="n">_SEQCLASSES</span> <span class="o">=</span> <span class="p">()</span></div>


<div class="viewcode-block" id="LinkSequences"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.LinkSequences">[docs]</a><span class="k">class</span> <span class="nc">LinkSequences</span><span class="p">(</span><span class="n">SubSequences</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base class for handling link sequences.&quot;&quot;&quot;</span>
    <span class="n">_SEQCLASSES</span> <span class="o">=</span> <span class="p">()</span></div>


<div class="viewcode-block" id="Sequence"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.Sequence">[docs]</a><span class="k">class</span> <span class="nc">Sequence</span><span class="p">(</span><span class="n">variabletools</span><span class="o">.</span><span class="n">Variable</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base class for defining different kinds of sequences.&quot;&quot;&quot;</span>

    <span class="n">NDIM</span><span class="p">,</span> <span class="n">NUMERIC</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">False</span>

    <span class="n">NOT_DEEPCOPYABLE_MEMBERS</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;subseqs&#39;</span><span class="p">,</span> <span class="s1">&#39;fastaccess&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subseqs</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span> <span class="o">=</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">FastAccess</span><span class="p">()</span>

<div class="viewcode-block" id="Sequence.connect"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.Sequence.connect">[docs]</a>    <span class="k">def</span> <span class="nf">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subseqs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subseqs</span> <span class="o">=</span> <span class="n">subseqs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span> <span class="o">=</span> <span class="n">subseqs</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_connect_subattr</span><span class="p">(</span><span class="s1">&#39;ndim&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">NDIM</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_connect_subattr</span><span class="p">(</span><span class="s1">&#39;length&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NDIM</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_connect_subattr</span><span class="p">(</span><span class="s1">&#39;length_</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">idx</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">diskflag</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ramflag</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_connect_subattr</span><span class="p">(</span><span class="s1">&#39;file&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_initvalues</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="nf">_connect_subattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">suffix</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">suffix</span><span class="p">),</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The prefered way to pass values to |Sequence| instances</span>
<span class="sd">        within initial condition files.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="n">args</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">initvalue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">pub</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">usedefaultvalues</span><span class="p">:</span>
            <span class="n">initvalue</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;INIT&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">initvalue</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">initvalue</span> <span class="o">=</span> <span class="mf">0.</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">initvalue</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">return</span> <span class="n">initvalue</span>

    <span class="k">def</span> <span class="nf">_initvalues</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">NDIM</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">initvalue</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_getvalue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The actual time series value(s) handled by the respective</span>
<span class="sd">        |Sequence| instance.  For consistency, `value` and `values`</span>
<span class="sd">        can always be used interchangeably.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="s1">&#39;No value/values of sequence </span><span class="si">%s</span><span class="s1"> of element &#39;</span>
                <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> has/have been defined so far.&#39;</span>
                <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">devicename</span><span class="p">(</span><span class="bp">self</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">NDIM</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">_setvalue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">NDIM</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">temp</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="s1">&#39;</span><span class="si">%d</span><span class="s1"> values are assigned to the scalar sequence </span><span class="si">%s</span><span class="s1"> &#39;</span>
                        <span class="s1">&#39;of element </span><span class="si">%s</span><span class="s1">, which is ambiguous.&#39;</span>
                        <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">),</span>
                           <span class="n">objecttools</span><span class="o">.</span><span class="n">devicename</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span>
                           <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">temp</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">IndexError</span><span class="p">):</span>
                <span class="k">pass</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="s1">&#39;When trying to set the value of sequence </span><span class="si">%s</span><span class="s1"> of element &#39;</span>
                    <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">, it was not possible to convert value `</span><span class="si">%s</span><span class="s1">` to float.&#39;</span>
                    <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">devicename</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="n">value</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">value</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;For sequence </span><span class="si">%s</span><span class="s1"> of element </span><span class="si">%s</span><span class="s1"> setting new values failed. &#39;</span>
                    <span class="s1">&#39; The values `</span><span class="si">%s</span><span class="s1">` cannot be converted to a numpy ndarray &#39;</span>
                    <span class="s1">&#39;with shape </span><span class="si">%s</span><span class="s1"> containing entries of type float.&#39;</span>
                    <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">devicename</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span>
                       <span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="n">value</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getvalue</span><span class="p">,</span> <span class="n">_setvalue</span><span class="p">)</span>
    <span class="n">values</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getvalue</span><span class="p">,</span> <span class="n">_setvalue</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_getshape</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;A tuple containing the lengths in all dimensions of the sequence</span>
<span class="sd">        values at a specific time point.  Note that setting a new shape</span>
<span class="sd">        results in a loss of the actual values of the respective sequence.</span>
<span class="sd">        For 0-dimensional sequences an empty tuple is returned.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">NDIM</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">shape</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">shape</span>
                <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">shape</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                    <span class="s1">&#39;Shape information for sequence </span><span class="si">%s</span><span class="s1"> of element </span><span class="si">%s</span><span class="s1"> can &#39;</span>
                    <span class="s1">&#39;only be retrieved after it has been defined.&#39;</span>
                    <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">devicename</span><span class="p">(</span><span class="bp">self</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">()</span>

    <span class="k">def</span> <span class="nf">_setshape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shape</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">NDIM</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">array</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">initvalue</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">BaseException</span><span class="p">:</span>
                <span class="n">prefix</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;While trying create a new numpy ndarray` for &#39;</span>
                          <span class="s1">&#39;sequence </span><span class="si">%s</span><span class="s1"> of element </span><span class="si">%s</span><span class="s1">&#39;</span>
                          <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">devicename</span><span class="p">(</span><span class="bp">self</span><span class="p">)))</span>
                <span class="n">objecttools</span><span class="o">.</span><span class="n">augment_excmessage</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">array</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">NDIM</span><span class="p">:</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">array</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;Sequence </span><span class="si">%s</span><span class="s1"> of element </span><span class="si">%s</span><span class="s1"> is </span><span class="si">%d</span><span class="s1">-dimensional &#39;</span>
                    <span class="s1">&#39;but the given shape indicates </span><span class="si">%d</span><span class="s1"> dimensions.&#39;</span>
                    <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">devicename</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span>
                       <span class="bp">self</span><span class="o">.</span><span class="n">NDIM</span><span class="p">,</span> <span class="n">array</span><span class="o">.</span><span class="n">ndim</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">shape</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;The shape information of 0-dimensional sequences as </span><span class="si">%s</span><span class="s1"> &#39;</span>
                    <span class="s1">&#39;of element </span><span class="si">%s</span><span class="s1"> can only be `()`, but `</span><span class="si">%s</span><span class="s1">` is given.&#39;</span>
                    <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">devicename</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="n">shape</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mf">0.</span>

    <span class="n">shape</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getshape</span><span class="p">,</span> <span class="n">_setshape</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">BaseException</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_raiseitemexception</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">values</span>
        <span class="k">except</span> <span class="ne">BaseException</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_raiseitemexception</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_raiseitemexception</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="s1">&#39;Sequence `</span><span class="si">%s</span><span class="s1">` has no values so far.&#39;</span>
                <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">objecttools</span><span class="o">.</span><span class="n">augment_excmessage</span><span class="p">(</span>
                <span class="s1">&#39;While trying to item access the values of sequence `</span><span class="si">%s</span><span class="s1">`&#39;</span>
                <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">islong</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">&gt;</span> <span class="mi">255</span>
        <span class="k">return</span> <span class="n">variabletools</span><span class="o">.</span><span class="n">Variable</span><span class="o">.</span><span class="n">repr_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">islong</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__dir__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">dir_</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>


<span class="n">abctools</span><span class="o">.</span><span class="n">SequenceABC</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">Sequence</span><span class="p">)</span>


<div class="viewcode-block" id="IOSequence"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.IOSequence">[docs]</a><span class="k">class</span> <span class="nc">IOSequence</span><span class="p">(</span><span class="n">Sequence</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base class for sequences with input/output functionalities.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Sequence</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rawfilename</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_filetype_ext</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_filename_ext</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dirpath_ext</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dirpath_int</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_filepath_ext</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_filepath_int</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">_getfiletype_ext</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Ending of the external data file.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filetype_ext</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filetype_ext</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">abctools</span><span class="o">.</span><span class="n">InputSequenceABC</span><span class="p">):</span>
                    <span class="k">return</span> <span class="n">pub</span><span class="o">.</span><span class="n">sequencemanager</span><span class="o">.</span><span class="n">inputfiletype</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">abctools</span><span class="o">.</span><span class="n">NodeSequenceABC</span><span class="p">):</span>
                    <span class="k">return</span> <span class="n">pub</span><span class="o">.</span><span class="n">sequencemanager</span><span class="o">.</span><span class="n">nodefiletype</span>
                <span class="k">return</span> <span class="n">pub</span><span class="o">.</span><span class="n">sequencemanager</span><span class="o">.</span><span class="n">outputfiletype</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                    <span class="s1">&#39;For sequence </span><span class="si">%s</span><span class="s1"> of element </span><span class="si">%s</span><span class="s1"> the type of the &#39;</span>
                    <span class="s1">&#39;external data file cannot be determined.  &#39;</span>
                    <span class="s1">&#39;Either set it manually or embed the sequence &#39;</span>
                    <span class="s1">&#39;object into the HydPy framework in the common&#39;</span>
                    <span class="s1">&#39;manner to allow for an automatic determination.&#39;</span>
                    <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">devicename</span><span class="p">(</span><span class="bp">self</span><span class="p">)))</span>

    <span class="k">def</span> <span class="nf">_setfiletype_ext</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_filetype_ext</span> <span class="o">=</span> <span class="n">name</span>

    <span class="k">def</span> <span class="nf">_delfiletype_ext</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_filetype_ext</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">filetype_ext</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span>
        <span class="n">_getfiletype_ext</span><span class="p">,</span> <span class="n">_setfiletype_ext</span><span class="p">,</span> <span class="n">_delfiletype_ext</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_getfilename_ext</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Complete filename of the external data file.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filename_ext</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filename_ext</span>
        <span class="k">return</span> <span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">rawfilename</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">filetype_ext</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_setfilename_ext</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_filename_ext</span> <span class="o">=</span> <span class="n">name</span>

    <span class="k">def</span> <span class="nf">_delfilename_ext</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_filename_ext</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">filename_ext</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span>
        <span class="n">_getfilename_ext</span><span class="p">,</span> <span class="n">_setfilename_ext</span><span class="p">,</span> <span class="n">_delfilename_ext</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_getfilename_int</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Complete filename of the internal data file.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rawfilename</span> <span class="o">+</span> <span class="s1">&#39;.bin&#39;</span>

    <span class="n">filename_int</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getfilename_int</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_getdirpath_ext</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Absolute path of the directory of the external data file.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dirpath_ext</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dirpath_ext</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">InputSequence</span><span class="p">):</span>
                    <span class="k">return</span> <span class="n">pub</span><span class="o">.</span><span class="n">sequencemanager</span><span class="o">.</span><span class="n">inputpath</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">NodeSequence</span><span class="p">):</span>
                    <span class="k">return</span> <span class="n">pub</span><span class="o">.</span><span class="n">sequencemanager</span><span class="o">.</span><span class="n">nodepath</span>
                <span class="k">return</span> <span class="n">pub</span><span class="o">.</span><span class="n">sequencemanager</span><span class="o">.</span><span class="n">outputpath</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                    <span class="s1">&#39;For sequence `</span><span class="si">%s</span><span class="s1">` the directory of the external &#39;</span>
                    <span class="s1">&#39;data file cannot be determined.  Either set it &#39;</span>
                    <span class="s1">&#39;manually or embed the sequence object into the &#39;</span>
                    <span class="s1">&#39;HydPy framework in the common manner to allow &#39;</span>
                    <span class="s1">&#39;for an automatic determination.&#39;</span>
                    <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setdirpath_ext</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dirpath_ext</span> <span class="o">=</span> <span class="n">name</span>

    <span class="k">def</span> <span class="nf">_deldirpath_ext</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dirpath_ext</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">dirpath_ext</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span>
        <span class="n">_getdirpath_ext</span><span class="p">,</span> <span class="n">_setdirpath_ext</span><span class="p">,</span> <span class="n">_deldirpath_ext</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_getdirpath_int</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Absolute path of the directory of the internal data file.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dirpath_int</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dirpath_int</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">pub</span><span class="o">.</span><span class="n">sequencemanager</span><span class="o">.</span><span class="n">temppath</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                    <span class="s1">&#39;For sequence `</span><span class="si">%s</span><span class="s1">` the directory of the internal &#39;</span>
                    <span class="s1">&#39;data file cannot be determined.  Either set it &#39;</span>
                    <span class="s1">&#39;manually or embed the sequence object into the &#39;</span>
                    <span class="s1">&#39;HydPy framework in the common manner to allow &#39;</span>
                    <span class="s1">&#39;for an automatic determination.&#39;</span>
                    <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setdirpath_int</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dirpath_int</span> <span class="o">=</span> <span class="n">name</span>

    <span class="k">def</span> <span class="nf">_deldirpath_int</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dirpath_int</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">dirpath_int</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span>
        <span class="n">_getdirpath_int</span><span class="p">,</span> <span class="n">_setdirpath_int</span><span class="p">,</span> <span class="n">_deldirpath_int</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_getfilepath_ext</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Absolute path to the external data file.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filepath_ext</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filepath_ext</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dirpath_ext</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename_ext</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setfilepath_ext</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_filepath_ext</span> <span class="o">=</span> <span class="n">name</span>

    <span class="k">def</span> <span class="nf">_delfilepath_ext</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_filepath_ext</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">filepath_ext</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span>
        <span class="n">_getfilepath_ext</span><span class="p">,</span> <span class="n">_setfilepath_ext</span><span class="p">,</span> <span class="n">_delfilepath_ext</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_getfilepath_int</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Absolute path to the internal data file.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filepath_int</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filepath_int</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dirpath_int</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename_int</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setfilepath_int</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_filepath_int</span> <span class="o">=</span> <span class="n">name</span>

    <span class="k">def</span> <span class="nf">_delfilepath_int</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_filepath_int</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">filepath_int</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span>
        <span class="n">_getfilepath_int</span><span class="p">,</span> <span class="n">_setfilepath_int</span><span class="p">,</span> <span class="n">_delfilepath_int</span><span class="p">)</span>

<div class="viewcode-block" id="IOSequence.update_fastaccess"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.IOSequence.update_fastaccess">[docs]</a>    <span class="k">def</span> <span class="nf">update_fastaccess</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">diskflag</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filepath_int</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_path&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
        <span class="n">length</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NDIM</span><span class="p">):</span>
            <span class="n">length</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_length_</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">idx</span><span class="p">),</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_length&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_getdiskflag</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">diskflag</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_diskflag&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">diskflag</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">diskflag</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="s1">&#39;The `diskflag` of sequence `</span><span class="si">%s</span><span class="s1">` has not been set yet.&#39;</span>
                <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setdiskflag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_diskflag&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="nb">bool</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>

    <span class="n">diskflag</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getdiskflag</span><span class="p">,</span> <span class="n">_setdiskflag</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_getramflag</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ramflag</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_ramflag&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ramflag</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ramflag</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="s1">&#39;The `ramflag` of sequence `</span><span class="si">%s</span><span class="s1">` has not been set yet.&#39;</span>
                <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setramflag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_ramflag&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="nb">bool</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>

    <span class="n">ramflag</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getramflag</span><span class="p">,</span> <span class="n">_setramflag</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_getmemoryflag</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ramflag</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">diskflag</span>

    <span class="n">memoryflag</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getmemoryflag</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_getarray</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">array</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_array&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">array</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="s1">&#39;The `ram array` of sequence `</span><span class="si">%s</span><span class="s1">` has not been set yet.&#39;</span>
                <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setarray</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_array&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">seriesshape</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Shape of the whole time series (time being the first dimension).&quot;&quot;&quot;</span>
        <span class="n">seriesshape</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">pub</span><span class="o">.</span><span class="n">timegrids</span><span class="o">.</span><span class="n">init</span><span class="p">)]</span>
        <span class="n">seriesshape</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">seriesshape</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">numericshape</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Shape of the array of temporary values required for the numerical</span>
<span class="sd">        solver actually being selected.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">numericshape</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">subseqs</span><span class="o">.</span><span class="n">seqs</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">numconsts</span><span class="o">.</span><span class="n">nmb_stages</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="n">objecttools</span><span class="o">.</span><span class="n">augment_excmessage</span><span class="p">(</span>
                <span class="s1">&#39;The `numericshape` of a sequence like `</span><span class="si">%s</span><span class="s1">` depends on the &#39;</span>
                <span class="s1">&#39;configuration of the actual integration algorithm.  &#39;</span>
                <span class="s1">&#39;While trying to query the required configuration data &#39;</span>
                <span class="s1">&#39;`nmb_stages` of the model associated with element `</span><span class="si">%s</span><span class="s1">`&#39;</span>
                <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">devicename</span><span class="p">(</span><span class="bp">self</span><span class="p">)))</span>
        <span class="n">numericshape</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">numericshape</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_getseries</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">diskflag</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_int</span><span class="p">()</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">ramflag</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getarray</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="s1">&#39;Sequence `</span><span class="si">%s</span><span class="s1">` of device `</span><span class="si">%s</span><span class="s1">`is not requested &#39;</span>
                <span class="s1">&#39;to make any internal data available to the user.&#39;</span>
                <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">devicename</span><span class="p">(</span><span class="bp">self</span><span class="p">)))</span>

    <span class="k">def</span> <span class="nf">_setseries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
        <span class="n">series</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">series</span>
        <span class="n">series</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">values</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">diskflag</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_save_int</span><span class="p">(</span><span class="n">series</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">ramflag</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_setarray</span><span class="p">(</span><span class="n">series</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Sequence `</span><span class="si">%s</span><span class="s1">` is not requested to make any &#39;</span>
                               <span class="s1">&#39;internal data available to the user.&#39;</span>
                               <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_delseries</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">diskflag</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filepath_int</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">ramflag</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_array&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="n">series</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getseries</span><span class="p">,</span> <span class="n">_setseries</span><span class="p">,</span> <span class="n">_delseries</span><span class="p">)</span>

<div class="viewcode-block" id="IOSequence.load_ext"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.IOSequence.load_ext">[docs]</a>    <span class="k">def</span> <span class="nf">load_ext</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Load the external data series in accordance with</span>
<span class="sd">        `pub.timegrids.init` and store it as internal data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">filetype_ext</span> <span class="o">==</span> <span class="s1">&#39;npy&#39;</span><span class="p">:</span>
            <span class="n">timegrid_data</span><span class="p">,</span> <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_npy</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">timegrid_data</span><span class="p">,</span> <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_asc</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="s1">&#39;The shape of sequence `</span><span class="si">%s</span><span class="s1">` of element `</span><span class="si">%s</span><span class="s1">` is `</span><span class="si">%s</span><span class="s1">`, but &#39;</span>
                <span class="s1">&#39;according to the external data file `</span><span class="si">%s</span><span class="s1">` it should be `</span><span class="si">%s</span><span class="s1">`.&#39;</span>
                <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">devicename</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
                   <span class="bp">self</span><span class="o">.</span><span class="n">filepath_ext</span><span class="p">,</span> <span class="n">values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:]))</span>
        <span class="k">if</span> <span class="n">pub</span><span class="o">.</span><span class="n">timegrids</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">stepsize</span> <span class="o">!=</span> <span class="n">timegrid_data</span><span class="o">.</span><span class="n">stepsize</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="s1">&#39;According to external data file `</span><span class="si">%s</span><span class="s1">`, the date time step &#39;</span>
                <span class="s1">&#39;of sequence `</span><span class="si">%s</span><span class="s1">` of element `</span><span class="si">%s</span><span class="s1">` is `</span><span class="si">%s</span><span class="s1">`, but the actual &#39;</span>
                <span class="s1">&#39;simulation time step is `</span><span class="si">%s</span><span class="s1">`.&#39;</span>
                <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filepath_ext</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">devicename</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span>
                   <span class="n">timegrid_data</span><span class="o">.</span><span class="n">stepsize</span><span class="p">,</span> <span class="n">pub</span><span class="o">.</span><span class="n">timegrids</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">stepsize</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">pub</span><span class="o">.</span><span class="n">timegrids</span><span class="o">.</span><span class="n">init</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">timegrid_data</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">pub</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">checkseries</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                    <span class="s1">&#39;For sequence `</span><span class="si">%s</span><span class="s1">` of element `</span><span class="si">%s</span><span class="s1">` the initialization &#39;</span>
                    <span class="s1">&#39;time grid (</span><span class="si">%s</span><span class="s1">) does not define a subset of the time &#39;</span>
                    <span class="s1">&#39;grid of the external data file </span><span class="si">%s</span><span class="s1"> (</span><span class="si">%s</span><span class="s1">).&#39;</span>
                    <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">devicename</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span>
                       <span class="n">pub</span><span class="o">.</span><span class="n">timegrids</span><span class="o">.</span><span class="n">init</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">filepath_ext</span><span class="p">,</span> <span class="n">timegrid_data</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">adjust_short_series</span><span class="p">(</span><span class="n">timegrid_data</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">idx1</span> <span class="o">=</span> <span class="n">timegrid_data</span><span class="p">[</span><span class="n">pub</span><span class="o">.</span><span class="n">timegrids</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">firstdate</span><span class="p">]</span>
            <span class="n">idx2</span> <span class="o">=</span> <span class="n">timegrid_data</span><span class="p">[</span><span class="n">pub</span><span class="o">.</span><span class="n">timegrids</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">lastdate</span><span class="p">]</span>
            <span class="n">values</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="n">idx1</span><span class="p">:</span><span class="n">idx2</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">diskflag</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_save_int</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">ramflag</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_setarray</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="s1">&#39;Sequence `</span><span class="si">%s</span><span class="s1">` of element `</span><span class="si">%s</span><span class="s1">`is not requested to make &#39;</span>
                <span class="s1">&#39;any internal data available the the user.&#39;</span>
                <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">devicename</span><span class="p">(</span><span class="bp">self</span><span class="p">)))</span></div>

<div class="viewcode-block" id="IOSequence.adjust_short_series"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.IOSequence.adjust_short_series">[docs]</a>    <span class="k">def</span> <span class="nf">adjust_short_series</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timegrid</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adjust a short time series to a longer timegrid.</span>

<span class="sd">        Normally, time series data to be read from a external data files</span>
<span class="sd">        should span (at least) the whole initialization time period of a</span>
<span class="sd">        HydPy project.  However, for some variables which are only used</span>
<span class="sd">        for comparison (e.g. observed runoff used for calibration),</span>
<span class="sd">        incomplete time series might also be helpful.  This method it</span>
<span class="sd">        thought for adjusting such incomplete series to the public</span>
<span class="sd">        initialization time grid stored in module |pub|.  It is</span>
<span class="sd">        automatically called in method |IOSequence.load_ext| if necessary</span>
<span class="sd">        provided that the option |Options.checkseries| is disabled.</span>

<span class="sd">        Assume the initialization time period of a HydPy project spans</span>
<span class="sd">        five day:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import pub, Timegrids, Timegrid</span>
<span class="sd">        &gt;&gt;&gt; pub.timegrids = Timegrids(Timegrid(&#39;2000.01.10&#39;,</span>
<span class="sd">        ...                                    &#39;2000.01.15&#39;,</span>
<span class="sd">        ...                                    &#39;1d&#39;))</span>

<span class="sd">        Prepare a node series object for observational data:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.core.sequencetools import Obs</span>
<span class="sd">        &gt;&gt;&gt; obs = Obs()</span>

<span class="sd">        Prepare a test function that expects the timegrid of the</span>
<span class="sd">        data and the data itself, which returns the ajdusted array by</span>
<span class="sd">        means of calling method |IOSequence.adjust_short_series|:</span>

<span class="sd">        &gt;&gt;&gt; import numpy</span>
<span class="sd">        &gt;&gt;&gt; def test(timegrid):</span>
<span class="sd">        ...     values = numpy.ones(len(timegrid))</span>
<span class="sd">        ...     return obs.adjust_short_series(timegrid, values)</span>

<span class="sd">        The following calls to the test function shows the arrays</span>
<span class="sd">        returned for different kinds misalignments:</span>

<span class="sd">        &gt;&gt;&gt; test(Timegrid(&#39;2000.01.05&#39;, &#39;2000.01.20&#39;, &#39;1d&#39;))</span>
<span class="sd">        array([ 1.,  1.,  1.,  1.,  1.])</span>
<span class="sd">        &gt;&gt;&gt; test(Timegrid(&#39;2000.01.12&#39;, &#39;2000.01.15&#39;, &#39;1d&#39;))</span>
<span class="sd">        array([ nan,  nan,   1.,   1.,   1.])</span>
<span class="sd">        &gt;&gt;&gt; test(Timegrid(&#39;2000.01.12&#39;, &#39;2000.01.17&#39;, &#39;1d&#39;))</span>
<span class="sd">        array([ nan,  nan,   1.,   1.,   1.])</span>
<span class="sd">        &gt;&gt;&gt; test(Timegrid(&#39;2000.01.10&#39;, &#39;2000.01.13&#39;, &#39;1d&#39;))</span>
<span class="sd">        array([  1.,   1.,   1.,  nan,  nan])</span>
<span class="sd">        &gt;&gt;&gt; test(Timegrid(&#39;2000.01.08&#39;, &#39;2000.01.13&#39;, &#39;1d&#39;))</span>
<span class="sd">        array([  1.,   1.,   1.,  nan,  nan])</span>
<span class="sd">        &gt;&gt;&gt; test(Timegrid(&#39;2000.01.12&#39;, &#39;2000.01.13&#39;, &#39;1d&#39;))</span>
<span class="sd">        array([ nan,  nan,   1.,  nan,  nan])</span>
<span class="sd">        &gt;&gt;&gt; test(Timegrid(&#39;2000.01.05&#39;, &#39;2000.01.10&#39;, &#39;1d&#39;))</span>
<span class="sd">        array([ nan,  nan,  nan,  nan,  nan])</span>
<span class="sd">        &gt;&gt;&gt; test(Timegrid(&#39;2000.01.05&#39;, &#39;2000.01.08&#39;, &#39;1d&#39;))</span>
<span class="sd">        array([ nan,  nan,  nan,  nan,  nan])</span>
<span class="sd">        &gt;&gt;&gt; test(Timegrid(&#39;2000.01.15&#39;, &#39;2000.01.18&#39;, &#39;1d&#39;))</span>
<span class="sd">        array([ nan,  nan,  nan,  nan,  nan])</span>
<span class="sd">        &gt;&gt;&gt; test(Timegrid(&#39;2000.01.16&#39;, &#39;2000.01.18&#39;, &#39;1d&#39;))</span>
<span class="sd">        array([ nan,  nan,  nan,  nan,  nan])</span>

<span class="sd">        Through enabling option |Options.usedefaultvalues| the missing</span>
<span class="sd">        values are initialized with zero instead of nan:</span>

<span class="sd">        &gt;&gt;&gt; pub.options.usedefaultvalues = True</span>

<span class="sd">        &gt;&gt;&gt; test(Timegrid(&#39;2000.01.12&#39;, &#39;2000.01.17&#39;, &#39;1d&#39;))</span>
<span class="sd">        array([ 0.,  0.,  1.,  1.,  1.])</span>

<span class="sd">        &gt;&gt;&gt; pub.options.usedefaultvalues = False</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">idxs</span> <span class="o">=</span> <span class="p">[</span><span class="n">timegrid</span><span class="p">[</span><span class="n">pub</span><span class="o">.</span><span class="n">timegrids</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">firstdate</span><span class="p">],</span>
                <span class="n">timegrid</span><span class="p">[</span><span class="n">pub</span><span class="o">.</span><span class="n">timegrids</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">lastdate</span><span class="p">]]</span>
        <span class="n">valcopy</span> <span class="o">=</span> <span class="n">values</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seriesshape</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">initvalue</span><span class="p">)</span>
        <span class="n">len_</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">valcopy</span><span class="p">)</span>
        <span class="n">jdxs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">idxs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">idx</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">jdxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">idx</span> <span class="o">&lt;=</span> <span class="n">len_</span><span class="p">:</span>
                <span class="n">jdxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">jdxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">len_</span><span class="p">)</span>
        <span class="n">valcopy</span> <span class="o">=</span> <span class="n">valcopy</span><span class="p">[</span><span class="n">jdxs</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">jdxs</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
        <span class="n">zdx1</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="o">-</span><span class="n">idxs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">zdx2</span> <span class="o">=</span> <span class="n">zdx1</span><span class="o">+</span><span class="n">jdxs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">jdxs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">values</span><span class="p">[</span><span class="n">zdx1</span><span class="p">:</span><span class="n">zdx2</span><span class="p">]</span> <span class="o">=</span> <span class="n">valcopy</span>
        <span class="k">return</span> <span class="n">values</span></div>

<div class="viewcode-block" id="IOSequence.save_ext"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.IOSequence.save_ext">[docs]</a>    <span class="k">def</span> <span class="nf">save_ext</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Write the internal data into an external data file.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">filetype_ext</span> <span class="o">==</span> <span class="s1">&#39;npy&#39;</span><span class="p">:</span>
            <span class="n">series</span> <span class="o">=</span> <span class="n">pub</span><span class="o">.</span><span class="n">timegrids</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">array2series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">series</span><span class="p">)</span>
            <span class="n">numpy</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filepath_ext</span><span class="p">,</span> <span class="n">series</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filepath_ext</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file_</span><span class="p">:</span>
                <span class="n">file_</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">pub</span><span class="o">.</span><span class="n">timegrids</span><span class="o">.</span><span class="n">init</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filepath_ext</span><span class="p">,</span> <span class="s1">&#39;ab&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file_</span><span class="p">:</span>
                <span class="n">numpy</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="n">file_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">series</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_load_npy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the data timegrid and the complete external data from a</span>
<span class="sd">        binary numpy file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filepath_ext</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">BaseException</span><span class="p">:</span>
            <span class="n">prefix</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;While trying to load the external data of sequence &#39;</span>
                      <span class="s1">&#39;`</span><span class="si">%s</span><span class="s1">` from file `</span><span class="si">%s</span><span class="s1">`&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">filepath_ext</span><span class="p">))</span>
            <span class="n">objecttools</span><span class="o">.</span><span class="n">augment_excmessage</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">timegrid_data</span> <span class="o">=</span> <span class="n">timetools</span><span class="o">.</span><span class="n">Timegrid</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">BaseException</span><span class="p">:</span>
            <span class="n">prefix</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;While trying to retrieve the data timegrid of the &#39;</span>
                      <span class="s1">&#39;external data file `</span><span class="si">%s</span><span class="s1">` of sequence `</span><span class="si">%s</span><span class="s1">`&#39;</span>
                      <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filepath_ext</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
            <span class="n">objecttools</span><span class="o">.</span><span class="n">augment_excmessage</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">timegrid_data</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">13</span><span class="p">:]</span>

    <span class="k">def</span> <span class="nf">_load_asc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filepath_ext</span><span class="p">)</span> <span class="k">as</span> <span class="n">file_</span><span class="p">:</span>
            <span class="n">header</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">file_</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)])</span>
        <span class="n">timegrid_data</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">header</span><span class="p">,</span> <span class="p">{},</span> <span class="p">{</span><span class="s1">&#39;Timegrid&#39;</span><span class="p">:</span> <span class="n">timetools</span><span class="o">.</span><span class="n">Timegrid</span><span class="p">})</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filepath_ext</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                               <span class="n">ndmin</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">NDIM</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">timegrid_data</span><span class="p">,</span> <span class="n">values</span>

    <span class="k">def</span> <span class="nf">_load_int</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Load internal data from file and return it.&quot;&quot;&quot;</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filepath_int</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">NDIM</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">values</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seriesshape</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">values</span>

<div class="viewcode-block" id="IOSequence.zero_int"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.IOSequence.zero_int">[docs]</a>    <span class="k">def</span> <span class="nf">zero_int</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize the internal data series with zero values.&quot;&quot;&quot;</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seriesshape</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">diskflag</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_save_int</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">ramflag</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_setarray</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="s1">&#39;Sequence `</span><span class="si">%s</span><span class="s1">` is not requested to make any &#39;</span>
                <span class="s1">&#39;internal data available to the user.&#39;</span>
                <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_save_int</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
        <span class="n">values</span><span class="o">.</span><span class="n">tofile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filepath_int</span><span class="p">)</span>

<div class="viewcode-block" id="IOSequence.activate_disk"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.IOSequence.activate_disk">[docs]</a>    <span class="k">def</span> <span class="nf">activate_disk</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Demand reading/writing internal data from/to hard disk.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deactivate_ram</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">diskflag</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">InputSequence</span><span class="p">)</span> <span class="ow">or</span>
                <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">NodeSequence</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_ext</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">load_ext</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">zero_int</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_fastaccess</span><span class="p">()</span></div>

<div class="viewcode-block" id="IOSequence.deactivate_disk"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.IOSequence.deactivate_disk">[docs]</a>    <span class="k">def</span> <span class="nf">deactivate_disk</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Prevent from reading/writing internal data from/to hard disk.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">diskflag</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">series</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">diskflag</span> <span class="o">=</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="IOSequence.activate_ram"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.IOSequence.activate_ram">[docs]</a>    <span class="k">def</span> <span class="nf">activate_ram</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Demand reading/writing internal data from/to hard disk.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deactivate_disk</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ramflag</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">InputSequence</span><span class="p">)</span> <span class="ow">or</span>
                <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">NodeSequence</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_ext</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">load_ext</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">zero_int</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_fastaccess</span><span class="p">()</span></div>

<div class="viewcode-block" id="IOSequence.deactivate_ram"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.IOSequence.deactivate_ram">[docs]</a>    <span class="k">def</span> <span class="nf">deactivate_ram</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Prevent from reading/writing internal data from/to hard disk.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ramflag</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">series</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ramflag</span> <span class="o">=</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="IOSequence.disk2ram"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.IOSequence.disk2ram">[docs]</a>    <span class="k">def</span> <span class="nf">disk2ram</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Move internal data from disk to RAM.&quot;&quot;&quot;</span>
        <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">series</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deactivate_disk</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ramflag</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setarray</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_fastaccess</span><span class="p">()</span></div>

<div class="viewcode-block" id="IOSequence.ram2disk"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.IOSequence.ram2disk">[docs]</a>    <span class="k">def</span> <span class="nf">ram2disk</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Move internal data from RAM to disk.&quot;&quot;&quot;</span>
        <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">series</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deactivate_ram</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">diskflag</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_save_int</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_fastaccess</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="nf">_setshape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shape</span><span class="p">):</span>
        <span class="n">Sequence</span><span class="o">.</span><span class="n">_setshape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shape</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_fastaccess</span><span class="p">()</span>

    <span class="n">shape</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">Sequence</span><span class="o">.</span><span class="n">_getshape</span><span class="p">,</span> <span class="n">_setshape</span><span class="p">)</span></div>


<div class="viewcode-block" id="ModelIOSequence"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.ModelIOSequence">[docs]</a><span class="k">class</span> <span class="nc">ModelIOSequence</span><span class="p">(</span><span class="n">IOSequence</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base class for sequences to be handled by |Model| objects.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_getrawfilename</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Filename without ending for external and internal date files.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rawfilename</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rawfilename</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">_</span><span class="si">%s</span><span class="s1">_</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">subseqs</span><span class="o">.</span><span class="n">seqs</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                    <span class="n">objecttools</span><span class="o">.</span><span class="n">classname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">subseqs</span><span class="p">)[:</span><span class="o">-</span><span class="mi">9</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                    <span class="s1">&#39;For sequence `</span><span class="si">%s</span><span class="s1">` the raw filename cannot determined.  &#39;</span>
                    <span class="s1">&#39;Either set it manually or embed the sequence object &#39;</span>
                    <span class="s1">&#39;into the HydPy framework in the common manner to allow &#39;</span>
                    <span class="s1">&#39;for an automatic determination.&#39;</span>
                    <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setrawfilename</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rawfilename</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_delrawfilename</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rawfilename</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">rawfilename</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getrawfilename</span><span class="p">,</span> <span class="n">_setrawfilename</span><span class="p">,</span> <span class="n">_delrawfilename</span><span class="p">)</span></div>


<div class="viewcode-block" id="InputSequence"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.InputSequence">[docs]</a><span class="k">class</span> <span class="nc">InputSequence</span><span class="p">(</span><span class="n">ModelIOSequence</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base class for input sequences of |Model| objects.&quot;&quot;&quot;</span></div>


<span class="n">abctools</span><span class="o">.</span><span class="n">InputSequenceABC</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">InputSequence</span><span class="p">)</span>


<div class="viewcode-block" id="FluxSequence"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.FluxSequence">[docs]</a><span class="k">class</span> <span class="nc">FluxSequence</span><span class="p">(</span><span class="n">ModelIOSequence</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base class for flux sequences of |Model| objects.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_initvalues</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ModelIOSequence</span><span class="o">.</span><span class="n">_initvalues</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">NUMERIC</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">NDIM</span> <span class="k">else</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">numericshape</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_connect_subattr</span><span class="p">(</span><span class="s1">&#39;points&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_connect_subattr</span><span class="p">(</span><span class="s1">&#39;integrals&#39;</span><span class="p">,</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_connect_subattr</span><span class="p">(</span><span class="s1">&#39;results&#39;</span><span class="p">,</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
            <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">NDIM</span> <span class="k">else</span> <span class="mf">0.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_connect_subattr</span><span class="p">(</span><span class="s1">&#39;sum&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setshape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shape</span><span class="p">):</span>
        <span class="n">ModelIOSequence</span><span class="o">.</span><span class="n">_setshape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shape</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">NDIM</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">NUMERIC</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_connect_subattr</span><span class="p">(</span><span class="s1">&#39;points&#39;</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">numericshape</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_connect_subattr</span><span class="p">(</span><span class="s1">&#39;integrals&#39;</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">numericshape</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_connect_subattr</span><span class="p">(</span><span class="s1">&#39;results&#39;</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">numericshape</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_connect_subattr</span><span class="p">(</span><span class="s1">&#39;sum&#39;</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>

    <span class="n">shape</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">ModelIOSequence</span><span class="o">.</span><span class="n">_getshape</span><span class="p">,</span> <span class="n">_setshape</span><span class="p">)</span></div>


<span class="n">abctools</span><span class="o">.</span><span class="n">FluxSequenceABC</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">FluxSequence</span><span class="p">)</span>


<div class="viewcode-block" id="LeftRightSequence"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.LeftRightSequence">[docs]</a><span class="k">class</span> <span class="nc">LeftRightSequence</span><span class="p">(</span><span class="n">ModelIOSequence</span><span class="p">):</span>
    <span class="n">NDIM</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">_initvalues</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="n">numpy</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">initvalue</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_getleft</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The &quot;left&quot; value of the actual parameter.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_setleft</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

    <span class="n">left</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getleft</span><span class="p">,</span> <span class="n">_setleft</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_getright</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The &quot;right&quot; value of the actual parameter.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_setright</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

    <span class="n">right</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getright</span><span class="p">,</span> <span class="n">_setright</span><span class="p">)</span></div>


<div class="viewcode-block" id="ConditionSequence"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.ConditionSequence">[docs]</a><span class="k">class</span> <span class="nc">ConditionSequence</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="n">args</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trim</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_oldargs</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>

<div class="viewcode-block" id="ConditionSequence.trim"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.ConditionSequence.trim">[docs]</a>    <span class="k">def</span> <span class="nf">trim</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply |trim| of module |variabletools|.&quot;&quot;&quot;</span>
        <span class="n">variabletools</span><span class="o">.</span><span class="n">trim</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">)</span></div>

<div class="viewcode-block" id="ConditionSequence.warn_trim"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.ConditionSequence.warn_trim">[docs]</a>    <span class="k">def</span> <span class="nf">warn_trim</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s1">&#39;For sequence </span><span class="si">%s</span><span class="s1"> of element </span><span class="si">%s</span><span class="s1"> at least one value &#39;</span>
            <span class="s1">&#39;needed to be trimmed.  One possible reason could be &#39;</span>
            <span class="s1">&#39;that the related control parameter and initial &#39;</span>
            <span class="s1">&#39;condition files are inconsistent.&#39;</span>
            <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">devicename</span><span class="p">(</span><span class="bp">self</span><span class="p">)))</span></div>

<div class="viewcode-block" id="ConditionSequence.reset"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.ConditionSequence.reset">[docs]</a>    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_oldargs</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_oldargs</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="StateSequence"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.StateSequence">[docs]</a><span class="k">class</span> <span class="nc">StateSequence</span><span class="p">(</span><span class="n">ModelIOSequence</span><span class="p">,</span> <span class="n">ConditionSequence</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base class for state sequences of |Model| objects.&quot;&quot;&quot;</span>

    <span class="n">NOT_DEEPCOPYABLE_MEMBERS</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;subseqs&#39;</span><span class="p">,</span> <span class="s1">&#39;fastaccess_old&#39;</span><span class="p">,</span> <span class="s1">&#39;fastaccess_new&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ModelIOSequence</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fastaccess_old</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fastaccess_new</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_oldargs</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The prefered way to pass values to |Sequence| instances within</span>
<span class="sd">        initial condition files.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ConditionSequence</span><span class="o">.</span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">new2old</span><span class="p">()</span>

<div class="viewcode-block" id="StateSequence.connect"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.StateSequence.connect">[docs]</a>    <span class="k">def</span> <span class="nf">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subseqs</span><span class="p">):</span>
        <span class="n">ModelIOSequence</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subseqs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fastaccess_old</span> <span class="o">=</span> <span class="n">subseqs</span><span class="o">.</span><span class="n">fastaccess_old</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fastaccess_new</span> <span class="o">=</span> <span class="n">subseqs</span><span class="o">.</span><span class="n">fastaccess_new</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">NDIM</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess_old</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess_old</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_initvalues</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ModelIOSequence</span><span class="o">.</span><span class="n">_initvalues</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">NUMERIC</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">NDIM</span> <span class="k">else</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">numericshape</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_connect_subattr</span><span class="p">(</span><span class="s1">&#39;points&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_connect_subattr</span><span class="p">(</span><span class="s1">&#39;results&#39;</span><span class="p">,</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_setshape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shape</span><span class="p">):</span>
        <span class="n">ModelIOSequence</span><span class="o">.</span><span class="n">_setshape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shape</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">NDIM</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess_old</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">new</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">NUMERIC</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_connect_subattr</span><span class="p">(</span><span class="s1">&#39;points&#39;</span><span class="p">,</span>
                                      <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">numericshape</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_connect_subattr</span><span class="p">(</span><span class="s1">&#39;results&#39;</span><span class="p">,</span>
                                      <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">numericshape</span><span class="p">))</span>

    <span class="n">shape</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">ModelIOSequence</span><span class="o">.</span><span class="n">_getshape</span><span class="p">,</span> <span class="n">_setshape</span><span class="p">)</span>

    <span class="n">new</span> <span class="o">=</span> <span class="n">Sequence</span><span class="o">.</span><span class="n">values</span>
    <span class="sd">&quot;&quot;&quot;Complete access to the state value(s), which will be used in the</span>
<span class="sd">    next calculation steps.  Note that |StateSequence.new| is a synonym</span>
<span class="sd">    of |Sequence.values|.  Use this property to modify the initial</span>
<span class="sd">    condition(s) of a single |StateSequence| object.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_getold</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Assess to the state value(s) at beginning of the time step, which</span>
<span class="sd">        has been processed most recently.  When using :ref:`HydPy` in the</span>
<span class="sd">        normal manner.  But it can be helpful for demonstration and debugging</span>
<span class="sd">        purposes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess_old</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;No value/values of sequence `</span><span class="si">%s</span><span class="s1">` has/have &#39;</span>
                               <span class="s1">&#39;not been defined so far.&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">NDIM</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">_setold</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">NDIM</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">temp</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="s1">&#39;</span><span class="si">%d</span><span class="s1"> values are assigned to the scalar &#39;</span>
                        <span class="s1">&#39;sequence `</span><span class="si">%s</span><span class="s1">`, which is ambiguous.&#39;</span>
                        <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)),</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">temp</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">IndexError</span><span class="p">):</span>
                <span class="k">pass</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="s1">&#39;When trying to set the value of sequence `</span><span class="si">%s</span><span class="s1">`, &#39;</span>
                    <span class="s1">&#39;it was not possible to convert `</span><span class="si">%s</span><span class="s1">` to float.&#39;</span>
                    <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">value</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;The values `</span><span class="si">%s</span><span class="s1">` cannot be converted to a numpy &#39;</span>
                    <span class="s1">&#39;ndarray with shape </span><span class="si">%s</span><span class="s1"> containing entries of type float.&#39;</span>
                    <span class="o">%</span> <span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess_old</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="n">old</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getold</span><span class="p">,</span> <span class="n">_setold</span><span class="p">)</span>

<div class="viewcode-block" id="StateSequence.new2old"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.StateSequence.new2old">[docs]</a>    <span class="k">def</span> <span class="nf">new2old</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">NDIM</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">old</span><span class="p">[:]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">new</span><span class="p">[:]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">old</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">new</span></div></div>


<span class="n">abctools</span><span class="o">.</span><span class="n">StateSequenceABC</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">StateSequence</span><span class="p">)</span>


<div class="viewcode-block" id="LogSequence"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.LogSequence">[docs]</a><span class="k">class</span> <span class="nc">LogSequence</span><span class="p">(</span><span class="n">Sequence</span><span class="p">,</span> <span class="n">ConditionSequence</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base class for logging sequences of |Model| objects.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Sequence</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_oldargs</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="n">args</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trim</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_oldargs</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">args</span><span class="p">)</span></div>


<span class="n">abctools</span><span class="o">.</span><span class="n">LogSequenceABC</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">LogSequence</span><span class="p">)</span>


<div class="viewcode-block" id="AideSequence"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.AideSequence">[docs]</a><span class="k">class</span> <span class="nc">AideSequence</span><span class="p">(</span><span class="n">Sequence</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base class for aide sequences of |Model| objects.&quot;&quot;&quot;</span>
    <span class="k">pass</span></div>


<span class="n">abctools</span><span class="o">.</span><span class="n">AideSequenceABC</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">AideSequence</span><span class="p">)</span>


<div class="viewcode-block" id="LinkSequence"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.LinkSequence">[docs]</a><span class="k">class</span> <span class="nc">LinkSequence</span><span class="p">(</span><span class="n">Sequence</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base class for link sequences of |Model| objects.&quot;&quot;&quot;</span>

<div class="viewcode-block" id="LinkSequence.set_pointer"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.LinkSequence.set_pointer">[docs]</a>    <span class="k">def</span> <span class="nf">set_pointer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double</span><span class="p">,</span> <span class="n">idx</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="n">pdouble</span> <span class="o">=</span> <span class="n">pointerutils</span><span class="o">.</span><span class="n">PDouble</span><span class="p">(</span><span class="n">double</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">NDIM</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="o">.</span><span class="n">set_pointer0d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">pdouble</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">pdouble</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">NDIM</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="o">.</span><span class="n">set_pointer1d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">pdouble</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="n">ppdouble</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                <span class="n">ppdouble</span><span class="o">.</span><span class="n">set_pointer</span><span class="p">(</span><span class="n">double</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_initvalues</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">pointerutils</span><span class="o">.</span><span class="n">PPDouble</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">NDIM</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">_getvalue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;ToDo&quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
            <span class="s1">&#39;To retrieve a pointer is very likely to result in bugs &#39;</span>
            <span class="s1">&#39;and is thus not supported at the moment.&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setvalue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Could be implemented, but is not important at the moment...&quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
            <span class="s1">&#39;To change a pointer is very likely to result in bugs &#39;</span>
            <span class="s1">&#39;and is thus not supported at the moment.&#39;</span><span class="p">)</span>

    <span class="n">value</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getvalue</span><span class="p">,</span> <span class="n">_setvalue</span><span class="p">)</span>
    <span class="n">values</span> <span class="o">=</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">_getshape</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">NDIM</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">()</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">NDIM</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_length_0&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">),)</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="s1">&#39;Getting the shape of a </span><span class="si">%d</span><span class="s1"> dimensional link sequence &#39;</span>
            <span class="s1">&#39;is not supported so far.&#39;</span>
            <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">NDIM</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setshape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shape</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">NDIM</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="n">shape</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="o">.</span><span class="n">dealloc</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="o">.</span><span class="n">alloc</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">shape</span><span class="p">)</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="p">,</span> <span class="s1">&#39;len_&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">NDIM</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
                <span class="s1">&#39;Setting the shape of a </span><span class="si">%d</span><span class="s1"> dimensional link sequence &#39;</span>
                <span class="s1">&#39;is not supported so far.&#39;</span>
                <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">NDIM</span><span class="p">)</span>

    <span class="n">shape</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getshape</span><span class="p">,</span> <span class="n">_setshape</span><span class="p">)</span></div>


<span class="n">abctools</span><span class="o">.</span><span class="n">LinkSequenceABC</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">LinkSequence</span><span class="p">)</span>


<div class="viewcode-block" id="NodeSequence"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.NodeSequence">[docs]</a><span class="k">class</span> <span class="nc">NodeSequence</span><span class="p">(</span><span class="n">IOSequence</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base class for all sequences to be handled by |Node| objects.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_getrawfilename</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Filename without ending for external and internal date files.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rawfilename</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rawfilename</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">_</span><span class="si">%s</span><span class="s1">_</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">subseqs</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">subseqs</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">variable</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                    <span class="s1">&#39;For sequence `</span><span class="si">%s</span><span class="s1">` the raw filename cannot determined.  &#39;</span>
                    <span class="s1">&#39;Either set it manually or embed the sequence object &#39;</span>
                    <span class="s1">&#39;into the HydPy framework in the common manner to allow &#39;</span>
                    <span class="s1">&#39;for an automatic determination.&#39;</span>
                    <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setrawfilename</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rawfilename</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_delrawfilename</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rawfilename</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">rawfilename</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getrawfilename</span><span class="p">,</span> <span class="n">_setrawfilename</span><span class="p">,</span> <span class="n">_delrawfilename</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_initvalues</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">pointerutils</span><span class="o">.</span><span class="n">Double</span><span class="p">(</span><span class="mf">0.</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_getvalues</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Actual value(s) handled by the sequence.  For consistency,</span>
<span class="sd">        `value` and `values` can always be used interchangeably.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">NDIM</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="o">.</span><span class="n">getpointer0d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">NDIM</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="o">.</span><span class="n">getpointer1d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setvalues</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
        <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">values</span>

    <span class="n">values</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getvalues</span><span class="p">,</span> <span class="n">_setvalues</span><span class="p">)</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">values</span></div>


<span class="n">abctools</span><span class="o">.</span><span class="n">NodeSequenceABC</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">NodeSequence</span><span class="p">)</span>


<div class="viewcode-block" id="Sim"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.Sim">[docs]</a><span class="k">class</span> <span class="nc">Sim</span><span class="p">(</span><span class="n">NodeSequence</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base class for simulation sequences of |Node| objects.&quot;&quot;&quot;</span>
    <span class="n">NDIM</span><span class="p">,</span> <span class="n">NUMERIC</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">NodeSequence</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_ext</span> <span class="o">=</span> <span class="kc">False</span>

<div class="viewcode-block" id="Sim.activate_disk"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.Sim.activate_disk">[docs]</a>    <span class="k">def</span> <span class="nf">activate_disk</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">NodeSequence</span><span class="o">.</span><span class="n">activate_disk</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">diskflag</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="n">pub</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">warnmissingsimfile</span><span class="p">:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                    <span class="s1">&#39;The option `diskflag` of the simulation &#39;</span>
                    <span class="s1">&#39;sequence `</span><span class="si">%s</span><span class="s1">` had to be set to `False` due &#39;</span>
                    <span class="s1">&#39;to the following problem: </span><span class="si">%s</span><span class="s1">.&#39;</span>
                    <span class="o">%</span> <span class="p">(</span><span class="n">objecttools</span><span class="o">.</span><span class="n">devicename</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="n">message</span><span class="p">))</span></div>

<div class="viewcode-block" id="Sim.activate_ram"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.Sim.activate_ram">[docs]</a>    <span class="k">def</span> <span class="nf">activate_ram</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">NodeSequence</span><span class="o">.</span><span class="n">activate_ram</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ramflag</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="n">pub</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">warnmissingsimfile</span><span class="p">:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                    <span class="s1">&#39;The option `ramflag` of the simulation &#39;</span>
                    <span class="s1">&#39;sequence `</span><span class="si">%s</span><span class="s1">` had to be set to `False` due &#39;</span>
                    <span class="s1">&#39;to the following problem: </span><span class="si">%s</span><span class="s1">.&#39;</span>
                    <span class="o">%</span> <span class="p">(</span><span class="n">objecttools</span><span class="o">.</span><span class="n">devicename</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="n">message</span><span class="p">))</span></div></div>


<div class="viewcode-block" id="Obs"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.Obs">[docs]</a><span class="k">class</span> <span class="nc">Obs</span><span class="p">(</span><span class="n">NodeSequence</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base class for observation sequences of |Node| objects.&quot;&quot;&quot;</span>
    <span class="n">NDIM</span><span class="p">,</span> <span class="n">NUMERIC</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">NodeSequence</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_ext</span> <span class="o">=</span> <span class="kc">True</span>

<div class="viewcode-block" id="Obs.activate_disk"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.Obs.activate_disk">[docs]</a>    <span class="k">def</span> <span class="nf">activate_disk</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">NodeSequence</span><span class="o">.</span><span class="n">activate_disk</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">diskflag</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="n">pub</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">warnmissingobsfile</span><span class="p">:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                    <span class="s1">&#39;The option `diskflag` of the observation &#39;</span>
                    <span class="s1">&#39;sequence `</span><span class="si">%s</span><span class="s1">` had to be set to `False` due &#39;</span>
                    <span class="s1">&#39;to the following problem: </span><span class="si">%s</span><span class="s1">.&#39;</span>
                    <span class="o">%</span> <span class="p">(</span><span class="n">objecttools</span><span class="o">.</span><span class="n">devicename</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="n">message</span><span class="p">))</span></div>

<div class="viewcode-block" id="Obs.activate_ram"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.Obs.activate_ram">[docs]</a>    <span class="k">def</span> <span class="nf">activate_ram</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">NodeSequence</span><span class="o">.</span><span class="n">activate_ram</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ramflag</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="n">pub</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">warnmissingobsfile</span><span class="p">:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                    <span class="s1">&#39;The option `ramflag` of the observation &#39;</span>
                    <span class="s1">&#39;sequence `</span><span class="si">%s</span><span class="s1">` had to be set to `False` due &#39;</span>
                    <span class="s1">&#39;to the following problem: </span><span class="si">%s</span><span class="s1">.&#39;</span>
                    <span class="o">%</span> <span class="p">(</span><span class="n">objecttools</span><span class="o">.</span><span class="n">devicename</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="n">message</span><span class="p">))</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">series_complete</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">memoryflag</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">numpy</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">series</span><span class="p">))</span></div>


<div class="viewcode-block" id="NodeSequences"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.NodeSequences">[docs]</a><span class="k">class</span> <span class="nc">NodeSequences</span><span class="p">(</span><span class="n">IOSequences</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base class for handling node sequences.&quot;&quot;&quot;</span>
    <span class="n">_SEQCLASSES</span> <span class="o">=</span> <span class="p">(</span><span class="n">Sim</span><span class="p">,</span> <span class="n">Obs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seqs</span><span class="p">,</span> <span class="n">cls_fastaccess</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">IOSequences</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seqs</span><span class="p">,</span> <span class="n">cls_fastaccess</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">node</span> <span class="o">=</span> <span class="n">seqs</span>

<div class="viewcode-block" id="NodeSequences.load_data"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.NodeSequences.load_data">[docs]</a>    <span class="k">def</span> <span class="nf">load_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="o">.</span><span class="n">load_data</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span></div>

<div class="viewcode-block" id="NodeSequences.save_data"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.NodeSequences.save_data">[docs]</a>    <span class="k">def</span> <span class="nf">save_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="o">.</span><span class="n">save_data</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="FastAccess"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.FastAccess">[docs]</a><span class="k">class</span> <span class="nc">FastAccess</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Provides fast access to the values of the sequences of a sequence</span>
<span class="sd">    subgroup and supports the handling of internal data series during</span>
<span class="sd">    simulations.</span>

<span class="sd">    The following details are of relevance for :ref:`HydPy` developers only.</span>

<span class="sd">    |sequencetools.FastAccess| is applied in Python mode only.  In Cython</span>
<span class="sd">    mode, specialized and more efficient cdef classes replace it.  For</span>
<span class="sd">    compatibility with these cdef classes, |sequencetools.FastAccess|</span>
<span class="sd">    objects work with dynamically set instance members.  Suppose there</span>
<span class="sd">    is a sequence named `seq1` which is 2-dimensional, then its associated</span>
<span class="sd">    attributes are:</span>

<span class="sd">      * seq1 (|numpy.ndarray|): The actual sequence values.</span>
<span class="sd">      * _seq1_ndim (|int|): Number of dimensions.</span>
<span class="sd">      * _seq1_length_0 (|int|): Length in the first dimension.</span>
<span class="sd">      * _seq1_length_1 (|int|): Length in the second dimension.</span>
<span class="sd">      * _seq1_ramflag (|bool|): Handle internal data in RAM?</span>
<span class="sd">      * _seq1_diskflag (|bool|): Handle internal data on disk?</span>
<span class="sd">      * _seq1_path (|str|): Path of the internal data file.</span>
<span class="sd">      * _seq1_file (|io.open|): Object handling the internal data file.</span>

<span class="sd">    Note that all these dynamical attributes and the following methods are</span>
<span class="sd">    initialised, changed or applied by the respective |SubSequences| and</span>
<span class="sd">    |Sequence| objects.  Handling them directly is error prone and thus</span>
<span class="sd">    not recommended.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="FastAccess.open_files"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.FastAccess.open_files">[docs]</a>    <span class="k">def</span> <span class="nf">open_files</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Open all files with an activated disk flag.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_diskflag&#39;</span> <span class="o">%</span> <span class="n">name</span><span class="p">):</span>
                <span class="n">path</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_path&#39;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
                <span class="n">file_</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;rb+&#39;</span><span class="p">)</span>
                <span class="n">ndim</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_ndim&#39;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
                <span class="n">position</span> <span class="o">=</span> <span class="mi">8</span><span class="o">*</span><span class="n">idx</span>
                <span class="k">for</span> <span class="n">idim</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ndim</span><span class="p">):</span>
                    <span class="n">length</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_length_</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">idim</span><span class="p">))</span>
                    <span class="n">position</span> <span class="o">*=</span> <span class="n">length</span>
                <span class="n">file_</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_file&#39;</span> <span class="o">%</span> <span class="n">name</span><span class="p">,</span> <span class="n">file_</span><span class="p">)</span></div>

<div class="viewcode-block" id="FastAccess.close_files"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.FastAccess.close_files">[docs]</a>    <span class="k">def</span> <span class="nf">close_files</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Close all files with an activated disk flag.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_diskflag&#39;</span> <span class="o">%</span> <span class="n">name</span><span class="p">):</span>
                <span class="n">file_</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_file&#39;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
                <span class="n">file_</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="FastAccess.load_data"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.FastAccess.load_data">[docs]</a>    <span class="k">def</span> <span class="nf">load_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Load the internal data of all sequences.  Load from file if the</span>
<span class="sd">        corresponding disk flag is activated, otherwise load from RAM.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">ndim</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_ndim&#39;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
            <span class="n">diskflag</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_diskflag&#39;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
            <span class="n">ramflag</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_ramflag&#39;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">diskflag</span><span class="p">:</span>
                <span class="n">file_</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_file&#39;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
                <span class="n">length_tot</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">shape</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">jdx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ndim</span><span class="p">):</span>
                    <span class="n">length</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_length_</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">jdx</span><span class="p">))</span>
                    <span class="n">length_tot</span> <span class="o">*=</span> <span class="n">length</span>
                    <span class="n">shape</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>
                <span class="n">raw</span> <span class="o">=</span> <span class="n">file_</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">length_tot</span><span class="o">*</span><span class="mi">8</span><span class="p">)</span>
                <span class="n">values</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">length_tot</span><span class="o">*</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">raw</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ndim</span><span class="p">:</span>
                    <span class="n">values</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">values</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">values</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">ramflag</span><span class="p">:</span>
                <span class="n">array</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_array&#39;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
                <span class="n">values</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">diskflag</span> <span class="ow">or</span> <span class="n">ramflag</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)[:]</span> <span class="o">=</span> <span class="n">values</span></div>

<div class="viewcode-block" id="FastAccess.save_data"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.FastAccess.save_data">[docs]</a>    <span class="k">def</span> <span class="nf">save_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Save the internal data of all sequences with an activated flag.</span>
<span class="sd">        Write to file if the corresponding disk flag is activated; store</span>
<span class="sd">        in working memory if the corresponding ram flag is activated.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">actual</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
            <span class="n">diskflag</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_diskflag&#39;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
            <span class="n">ramflag</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_ramflag&#39;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">diskflag</span><span class="p">:</span>
                <span class="n">file_</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_file&#39;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
                <span class="n">ndim</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_ndim&#39;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
                <span class="n">length_tot</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="k">for</span> <span class="n">jdx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ndim</span><span class="p">):</span>
                    <span class="n">length</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_length_</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">jdx</span><span class="p">))</span>
                    <span class="n">length_tot</span> <span class="o">*=</span> <span class="n">length</span>
                <span class="k">if</span> <span class="n">ndim</span><span class="p">:</span>
                    <span class="n">raw</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">length_tot</span><span class="o">*</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="o">*</span><span class="n">actual</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">raw</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">actual</span><span class="p">)</span>
                <span class="n">file_</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">ramflag</span><span class="p">:</span>
                <span class="n">array</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_array&#39;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
                <span class="n">array</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">actual</span></div>

    <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Iterate over all sequence names.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">):</span>
                <span class="k">yield</span> <span class="n">key</span></div>


<span class="n">autodoctools</span><span class="o">.</span><span class="n">autodoc_module</span><span class="p">()</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../../index.html">Table Of Contents</a></h3>
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../framework.html">Framework Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../modelcollection.html">Model Collection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../development.html">Development</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">HydPy 2.1-dev documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Christoph Tyralla.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.5.
    </div>
  </body>
</html>