
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>statstools &#8212; HydPy 2.1-dev documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="validtools" href="validtools.html" />
    <link rel="prev" title="smoothtools" href="smoothtools.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="validtools.html" title="validtools"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="smoothtools.html" title="smoothtools"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">HydPy 2.1-dev documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="framework.html" >Framework Tools</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="auxiliaries.html" accesskey="U">Auxiliary Modules</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="statstools">
<span id="id1"></span><h1>statstools<a class="headerlink" href="#statstools" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-hydpy.auxs.statstools"></span><p>This module implements statistical functionalities frequently used in
hydrological modelling.</p>
<p>Module <a class="reference internal" href="#module-hydpy.auxs.statstools" title="hydpy.auxs.statstools"><code class="xref py py-mod docutils literal notranslate"><span class="pre">statstools</span></code></a> implements the following members:</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference internal" href="#hydpy.auxs.statstools.prepare_arrays" title="hydpy.auxs.statstools.prepare_arrays"><code class="xref py py-func docutils literal notranslate"><span class="pre">prepare_arrays()</span></code></a> Prepare and return two <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/index.html#module-numpy" title="(in NumPy v1.14)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">numpy</span></code></a> arrays based on the given arguments.</li>
<li><a class="reference internal" href="#hydpy.auxs.statstools.nse" title="hydpy.auxs.statstools.nse"><code class="xref py py-func docutils literal notranslate"><span class="pre">nse()</span></code></a> Calculate the efficiency criteria after Nash &amp; Sutcliffe.</li>
<li><a class="reference internal" href="#hydpy.auxs.statstools.bias_abs" title="hydpy.auxs.statstools.bias_abs"><code class="xref py py-func docutils literal notranslate"><span class="pre">bias_abs()</span></code></a> Calculate the absolute difference between the means of the simulated and the observed values.</li>
<li><a class="reference internal" href="#hydpy.auxs.statstools.bias_rel" title="hydpy.auxs.statstools.bias_rel"><code class="xref py py-func docutils literal notranslate"><span class="pre">bias_rel()</span></code></a> Calculate the relative difference between the means of the simulated and the observed values.</li>
<li><a class="reference internal" href="#hydpy.auxs.statstools.std_ratio" title="hydpy.auxs.statstools.std_ratio"><code class="xref py py-func docutils literal notranslate"><span class="pre">std_ratio()</span></code></a> Calculate the ratio between the standard deviation of the simulated and the observed values.</li>
<li><a class="reference internal" href="#hydpy.auxs.statstools.corr" title="hydpy.auxs.statstools.corr"><code class="xref py py-func docutils literal notranslate"><span class="pre">corr()</span></code></a> Calculate the product-moment correlation coefficient after Pearson.</li>
<li><a class="reference internal" href="#hydpy.auxs.statstools.hsepd_pdf" title="hydpy.auxs.statstools.hsepd_pdf"><code class="xref py py-func docutils literal notranslate"><span class="pre">hsepd_pdf()</span></code></a> Calculate the probability densities based on the heteroskedastic skewed exponential power distribution.</li>
<li><a class="reference internal" href="#hydpy.auxs.statstools.hsepd_manual" title="hydpy.auxs.statstools.hsepd_manual"><code class="xref py py-func docutils literal notranslate"><span class="pre">hsepd_manual()</span></code></a> Calculate the mean of the logarithmised probability densities of the ‘heteroskedastic skewed exponential power distribution.</li>
<li><a class="reference internal" href="#hydpy.auxs.statstools.hsepd" title="hydpy.auxs.statstools.hsepd"><code class="xref py py-func docutils literal notranslate"><span class="pre">hsepd()</span></code></a> Calculate the mean of the logarithmised probability densities of the ‘heteroskedastic skewed exponential power distribution.</li>
<li><a class="reference internal" href="#hydpy.auxs.statstools.calc_mean_time" title="hydpy.auxs.statstools.calc_mean_time"><code class="xref py py-func docutils literal notranslate"><span class="pre">calc_mean_time()</span></code></a> Return the weighted mean of the given timepoints.</li>
<li><a class="reference internal" href="#hydpy.auxs.statstools.calc_mean_time_deviation" title="hydpy.auxs.statstools.calc_mean_time_deviation"><code class="xref py py-func docutils literal notranslate"><span class="pre">calc_mean_time_deviation()</span></code></a> Return the weighted deviation of the given timepoints from their mean time.</li>
<li><a class="reference internal" href="#hydpy.auxs.statstools.evaluationtable" title="hydpy.auxs.statstools.evaluationtable"><code class="xref py py-func docutils literal notranslate"><span class="pre">evaluationtable()</span></code></a> Return a table containing the results of the given evaluation criteria for the given <a class="reference internal" href="devicetools.html#hydpy.core.devicetools.Node" title="hydpy.core.devicetools.Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">Node</span></code></a> objects.</li>
</ul>
</div></blockquote>
<hr class="docutils" />
<dl class="function">
<dt id="hydpy.auxs.statstools.prepare_arrays">
<code class="descclassname">hydpy.auxs.statstools.</code><code class="descname">prepare_arrays</code><span class="sig-paren">(</span><em>sim=None</em>, <em>obs=None</em>, <em>node=None</em>, <em>skip_nan=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydpy/auxs/statstools.html#prepare_arrays"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hydpy.auxs.statstools.prepare_arrays" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepare and return two <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/index.html#module-numpy" title="(in NumPy v1.14)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">numpy</span></code></a> arrays based on the given arguments.</p>
<p>Note that many functions provided by module <a class="reference internal" href="#module-hydpy.auxs.statstools" title="hydpy.auxs.statstools"><code class="xref py py-mod docutils literal notranslate"><span class="pre">statstools</span></code></a> apply function
<a class="reference internal" href="#hydpy.auxs.statstools.prepare_arrays" title="hydpy.auxs.statstools.prepare_arrays"><code class="xref py py-func docutils literal notranslate"><span class="pre">prepare_arrays()</span></code></a> internally (e.g. <a class="reference internal" href="#hydpy.auxs.statstools.nse" title="hydpy.auxs.statstools.nse"><code class="xref py py-func docutils literal notranslate"><span class="pre">nse()</span></code></a>).  But you can also apply it
manually, as shown in the following examples.</p>
<p>Function <a class="reference internal" href="#hydpy.auxs.statstools.prepare_arrays" title="hydpy.auxs.statstools.prepare_arrays"><code class="xref py py-func docutils literal notranslate"><span class="pre">prepare_arrays()</span></code></a> can extract time series data from <a class="reference internal" href="devicetools.html#hydpy.core.devicetools.Node" title="hydpy.core.devicetools.Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">Node</span></code></a>
objects.  To set up an example for this, we define a initialization
time period and prepare a <a class="reference internal" href="devicetools.html#hydpy.core.devicetools.Node" title="hydpy.core.devicetools.Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">Node</span></code></a> object:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="k">import</span> <span class="n">pub</span><span class="p">,</span> <span class="n">Timegrid</span><span class="p">,</span> <span class="n">Timegrids</span><span class="p">,</span> <span class="n">Node</span><span class="p">,</span> <span class="n">round_</span><span class="p">,</span> <span class="n">nan</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pub</span><span class="o">.</span><span class="n">timegrids</span> <span class="o">=</span> <span class="n">Timegrids</span><span class="p">(</span><span class="n">Timegrid</span><span class="p">(</span><span class="s1">&#39;01.01.2000&#39;</span><span class="p">,</span>
<span class="gp">... </span>                                   <span class="s1">&#39;07.01.2000&#39;</span><span class="p">,</span>
<span class="gp">... </span>                                   <span class="s1">&#39;1d&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">node</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Next, we assign values the <cite>simulation</cite> and the <cite>observation</cite> sequences
(to do so for the <cite>observation</cite> sequence requires a little trick, as
its values are normally supposed to be read from a file):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">node</span><span class="o">.</span><span class="n">prepare_simseries</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">node</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">series</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">node</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">obs</span><span class="o">.</span><span class="n">ramflag</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">node</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">obs</span><span class="o">.</span><span class="n">_setarray</span><span class="p">([</span><span class="mf">4.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">])</span>
</pre></div>
</div>
<p>Now we can pass the node object to function <a class="reference internal" href="#hydpy.auxs.statstools.prepare_arrays" title="hydpy.auxs.statstools.prepare_arrays"><code class="xref py py-func docutils literal notranslate"><span class="pre">prepare_arrays()</span></code></a> and
get the (unmodified) time series data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="k">import</span> <span class="n">prepare_arrays</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arrays</span> <span class="o">=</span> <span class="n">prepare_arrays</span><span class="p">(</span><span class="n">node</span><span class="o">=</span><span class="n">node</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">arrays</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">1.0, nan, nan, nan, 2.0, 3.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">arrays</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="go">4.0, 5.0, nan, nan, nan, 6.0</span>
</pre></div>
</div>
<p>Alternatively, we can pass directly any iterables (e.g. <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> and
<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a> objects) containing the <cite>simulated</cite> and <cite>observed</cite> data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">arrays</span> <span class="o">=</span> <span class="n">prepare_arrays</span><span class="p">(</span><span class="n">sim</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">series</span><span class="p">),</span>
<span class="gp">... </span>                        <span class="n">obs</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">obs</span><span class="o">.</span><span class="n">series</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">arrays</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">1.0, nan, nan, nan, 2.0, 3.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">arrays</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="go">4.0, 5.0, nan, nan, nan, 6.0</span>
</pre></div>
</div>
<p>The optional <cite>skip_nan</cite> flag allows to skip all values, which are
no numbers.  Note that only those pairs of <cite>simulated</cite> and <cite>observed</cite>
values are returned which do not contain any <cite>nan</cite>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">arrays</span> <span class="o">=</span> <span class="n">prepare_arrays</span><span class="p">(</span><span class="n">node</span><span class="o">=</span><span class="n">node</span><span class="p">,</span> <span class="n">skip_nan</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">arrays</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">1.0, 3.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">arrays</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="go">4.0, 6.0</span>
</pre></div>
</div>
<p>The final examples show the error messages returned in case of
invalid combinations of input arguments:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">prepare_arrays</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Neither a `Node` object is passed to argument `node` nor are arrays passed to arguments `sim` and `obs`.</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">prepare_arrays</span><span class="p">(</span><span class="n">sim</span><span class="o">=</span><span class="n">node</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">series</span><span class="p">,</span> <span class="n">node</span><span class="o">=</span><span class="n">node</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Values are passed to both arguments `sim` and `node`, which is not allowed.</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">prepare_arrays</span><span class="p">(</span><span class="n">obs</span><span class="o">=</span><span class="n">node</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">obs</span><span class="o">.</span><span class="n">series</span><span class="p">,</span> <span class="n">node</span><span class="o">=</span><span class="n">node</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Values are passed to both arguments `obs` and `node`, which is not allowed.</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">prepare_arrays</span><span class="p">(</span><span class="n">sim</span><span class="o">=</span><span class="n">node</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">series</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">A value is passed to argument `sim` but no value is passed to argument `obs`.</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">prepare_arrays</span><span class="p">(</span><span class="n">obs</span><span class="o">=</span><span class="n">node</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">obs</span><span class="o">.</span><span class="n">series</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">A value is passed to argument `obs` but no value is passed to argument `sim`.</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="hydpy.auxs.statstools.nse">
<code class="descclassname">hydpy.auxs.statstools.</code><code class="descname">nse</code><span class="sig-paren">(</span><em>sim=None</em>, <em>obs=None</em>, <em>node=None</em>, <em>skip_nan=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydpy/auxs/statstools.html#nse"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hydpy.auxs.statstools.nse" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the efficiency criteria after Nash &amp; Sutcliffe.</p>
<p>If the simulated values predict the observed values as well
as the average observed value (regarding the the mean square
error), the NSE value is zero:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="k">import</span> <span class="n">round_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="k">import</span> <span class="n">nse</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nse</span><span class="p">(</span><span class="n">sim</span><span class="o">=</span><span class="p">[</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">],</span> <span class="n">obs</span><span class="o">=</span><span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">])</span>
<span class="go">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nse</span><span class="p">(</span><span class="n">sim</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">],</span> <span class="n">obs</span><span class="o">=</span><span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">])</span>
<span class="go">0.0</span>
</pre></div>
</div>
<p>For worse and better simulated values the NSE is negative
or positive, respectively:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nse</span><span class="p">(</span><span class="n">sim</span><span class="o">=</span><span class="p">[</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="n">obs</span><span class="o">=</span><span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">])</span>
<span class="go">-3.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nse</span><span class="p">(</span><span class="n">sim</span><span class="o">=</span><span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">],</span> <span class="n">obs</span><span class="o">=</span><span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">])</span>
<span class="go">0.5</span>
</pre></div>
</div>
<p>The highest possible value is one:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nse</span><span class="p">(</span><span class="n">sim</span><span class="o">=</span><span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">],</span> <span class="n">obs</span><span class="o">=</span><span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">])</span>
<span class="go">1.0</span>
</pre></div>
</div>
<p>See the documentation on function <a class="reference internal" href="#hydpy.auxs.statstools.prepare_arrays" title="hydpy.auxs.statstools.prepare_arrays"><code class="xref py py-func docutils literal notranslate"><span class="pre">prepare_arrays()</span></code></a> for some
additional instructions for use of function <a class="reference internal" href="#hydpy.auxs.statstools.nse" title="hydpy.auxs.statstools.nse"><code class="xref py py-func docutils literal notranslate"><span class="pre">nse()</span></code></a>.</p>
</dd></dl>

<dl class="function">
<dt id="hydpy.auxs.statstools.bias_abs">
<code class="descclassname">hydpy.auxs.statstools.</code><code class="descname">bias_abs</code><span class="sig-paren">(</span><em>sim=None</em>, <em>obs=None</em>, <em>node=None</em>, <em>skip_nan=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydpy/auxs/statstools.html#bias_abs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hydpy.auxs.statstools.bias_abs" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the absolute difference between the means of the simulated
and the observed values.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="k">import</span> <span class="n">round_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="k">import</span> <span class="n">bias_abs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">bias_abs</span><span class="p">(</span><span class="n">sim</span><span class="o">=</span><span class="p">[</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">],</span> <span class="n">obs</span><span class="o">=</span><span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">]))</span>
<span class="go">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">bias_abs</span><span class="p">(</span><span class="n">sim</span><span class="o">=</span><span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">],</span> <span class="n">obs</span><span class="o">=</span><span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">]))</span>
<span class="go">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">bias_abs</span><span class="p">(</span><span class="n">sim</span><span class="o">=</span><span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="n">obs</span><span class="o">=</span><span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">]))</span>
<span class="go">-1.0</span>
</pre></div>
</div>
<p>See the documentation on function <a class="reference internal" href="#hydpy.auxs.statstools.prepare_arrays" title="hydpy.auxs.statstools.prepare_arrays"><code class="xref py py-func docutils literal notranslate"><span class="pre">prepare_arrays()</span></code></a> for some
additional instructions for use of function <a class="reference internal" href="#hydpy.auxs.statstools.bias_abs" title="hydpy.auxs.statstools.bias_abs"><code class="xref py py-func docutils literal notranslate"><span class="pre">bias_abs()</span></code></a>.</p>
</dd></dl>

<dl class="function">
<dt id="hydpy.auxs.statstools.bias_rel">
<code class="descclassname">hydpy.auxs.statstools.</code><code class="descname">bias_rel</code><span class="sig-paren">(</span><em>sim=None</em>, <em>obs=None</em>, <em>node=None</em>, <em>skip_nan=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydpy/auxs/statstools.html#bias_rel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hydpy.auxs.statstools.bias_rel" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the relative difference between the means of the simulated
and the observed values.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="k">import</span> <span class="n">round_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="k">import</span> <span class="n">bias_rel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">bias_rel</span><span class="p">(</span><span class="n">sim</span><span class="o">=</span><span class="p">[</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">],</span> <span class="n">obs</span><span class="o">=</span><span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">]))</span>
<span class="go">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">bias_rel</span><span class="p">(</span><span class="n">sim</span><span class="o">=</span><span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">],</span> <span class="n">obs</span><span class="o">=</span><span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">]))</span>
<span class="go">0.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">bias_rel</span><span class="p">(</span><span class="n">sim</span><span class="o">=</span><span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="n">obs</span><span class="o">=</span><span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">]))</span>
<span class="go">-0.5</span>
</pre></div>
</div>
<p>See the documentation on function <a class="reference internal" href="#hydpy.auxs.statstools.prepare_arrays" title="hydpy.auxs.statstools.prepare_arrays"><code class="xref py py-func docutils literal notranslate"><span class="pre">prepare_arrays()</span></code></a> for some
additional instructions for use of function <a class="reference internal" href="#hydpy.auxs.statstools.bias_rel" title="hydpy.auxs.statstools.bias_rel"><code class="xref py py-func docutils literal notranslate"><span class="pre">bias_rel()</span></code></a>.</p>
</dd></dl>

<dl class="function">
<dt id="hydpy.auxs.statstools.std_ratio">
<code class="descclassname">hydpy.auxs.statstools.</code><code class="descname">std_ratio</code><span class="sig-paren">(</span><em>sim=None</em>, <em>obs=None</em>, <em>node=None</em>, <em>skip_nan=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydpy/auxs/statstools.html#std_ratio"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hydpy.auxs.statstools.std_ratio" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the ratio between the standard deviation of the simulated
and the observed values.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="k">import</span> <span class="n">round_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="k">import</span> <span class="n">std_ratio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">std_ratio</span><span class="p">(</span><span class="n">sim</span><span class="o">=</span><span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">],</span> <span class="n">obs</span><span class="o">=</span><span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">]))</span>
<span class="go">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">std_ratio</span><span class="p">(</span><span class="n">sim</span><span class="o">=</span><span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="n">obs</span><span class="o">=</span><span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">]))</span>
<span class="go">-1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">std_ratio</span><span class="p">(</span><span class="n">sim</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">],</span> <span class="n">obs</span><span class="o">=</span><span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">]))</span>
<span class="go">2.0</span>
</pre></div>
</div>
<p>See the documentation on function <a class="reference internal" href="#hydpy.auxs.statstools.prepare_arrays" title="hydpy.auxs.statstools.prepare_arrays"><code class="xref py py-func docutils literal notranslate"><span class="pre">prepare_arrays()</span></code></a> for some
additional instructions for use of function <a class="reference internal" href="#hydpy.auxs.statstools.std_ratio" title="hydpy.auxs.statstools.std_ratio"><code class="xref py py-func docutils literal notranslate"><span class="pre">std_ratio()</span></code></a>.</p>
</dd></dl>

<dl class="function">
<dt id="hydpy.auxs.statstools.corr">
<code class="descclassname">hydpy.auxs.statstools.</code><code class="descname">corr</code><span class="sig-paren">(</span><em>sim=None</em>, <em>obs=None</em>, <em>node=None</em>, <em>skip_nan=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydpy/auxs/statstools.html#corr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hydpy.auxs.statstools.corr" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the product-moment correlation coefficient after Pearson.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="k">import</span> <span class="n">round_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="k">import</span> <span class="n">corr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">corr</span><span class="p">(</span><span class="n">sim</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span> <span class="n">obs</span><span class="o">=</span><span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">]))</span>
<span class="go">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">corr</span><span class="p">(</span><span class="n">sim</span><span class="o">=</span><span class="p">[</span><span class="mf">4.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="n">obs</span><span class="o">=</span><span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">]))</span>
<span class="go">-1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">corr</span><span class="p">(</span><span class="n">sim</span><span class="o">=</span><span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="n">obs</span><span class="o">=</span><span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">]))</span>
<span class="go">0.0</span>
</pre></div>
</div>
<p>See the documentation on function <a class="reference internal" href="#hydpy.auxs.statstools.prepare_arrays" title="hydpy.auxs.statstools.prepare_arrays"><code class="xref py py-func docutils literal notranslate"><span class="pre">prepare_arrays()</span></code></a> for some
additional instructions for use of function <a class="reference internal" href="#hydpy.auxs.statstools.corr" title="hydpy.auxs.statstools.corr"><code class="xref py py-func docutils literal notranslate"><span class="pre">corr()</span></code></a>.</p>
</dd></dl>

<dl class="function">
<dt id="hydpy.auxs.statstools.hsepd_pdf">
<code class="descclassname">hydpy.auxs.statstools.</code><code class="descname">hsepd_pdf</code><span class="sig-paren">(</span><em>sigma1</em>, <em>sigma2</em>, <em>xi</em>, <em>beta</em>, <em>sim=None</em>, <em>obs=None</em>, <em>node=None</em>, <em>skip_nan=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydpy/auxs/statstools.html#hsepd_pdf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hydpy.auxs.statstools.hsepd_pdf" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the probability densities based on the
heteroskedastic skewed exponential power distribution.</p>
<p>For convenience, the required parameters of the probability density
function as well as the simulated and observed values are stored
in a dictonary:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="k">import</span> <span class="n">round_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="k">import</span> <span class="n">hsepd_pdf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">general</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;sigma1&#39;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span>
<span class="gp">... </span>           <span class="s1">&#39;sigma2&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
<span class="gp">... </span>           <span class="s1">&#39;xi&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
<span class="gp">... </span>           <span class="s1">&#39;beta&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
<span class="gp">... </span>           <span class="s1">&#39;sim&#39;</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">41.0</span><span class="p">),</span>
<span class="gp">... </span>           <span class="s1">&#39;obs&#39;</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="mi">31</span><span class="p">,</span> <span class="mf">25.0</span><span class="p">)}</span>
</pre></div>
</div>
<p>The following test function allows the variation of one parameter
and prints some and plots all of probability density values
corresponding to different simulated values:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">test</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="gp">... </span>    <span class="kn">from</span> <span class="nn">matplotlib</span> <span class="k">import</span> <span class="n">pyplot</span>
<span class="gp">... </span>    <span class="n">special</span> <span class="o">=</span> <span class="n">general</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">name</span><span class="p">,</span> <span class="n">values</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">... </span>    <span class="n">results</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">general</span><span class="p">[</span><span class="s1">&#39;sim&#39;</span><span class="p">]),</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">... </span>    <span class="n">results</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">general</span><span class="p">[</span><span class="s1">&#39;sim&#39;</span><span class="p">]</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">jdx</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">special</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
<span class="gp">... </span>        <span class="n">results</span><span class="p">[:,</span> <span class="n">jdx</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">hsepd_pdf</span><span class="p">(</span><span class="o">**</span><span class="n">special</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">pyplot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">results</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">results</span><span class="p">[:,</span> <span class="n">jdx</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>                    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">=</span><span class="si">%.1f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
<span class="gp">... </span>    <span class="n">pyplot</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">result</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">results</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">idx</span> <span class="o">%</span> <span class="mi">5</span><span class="p">):</span>
<span class="gp">... </span>            <span class="n">round_</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<p>When varying parameter <cite>beta</cite>, the resulting probabilities correspond
to the Laplace distribution (1.0), normal distribution (0.0), and the
uniform distribution (-1.0), respectively.  Note that we use -0.99
instead of -1.0 for approximating the uniform distribution to prevent
from running into numerical problems, which are not solved yet:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">test</span><span class="p">(</span><span class="n">beta</span><span class="o">=</span><span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.99</span><span class="p">])</span>
<span class="go">10.0, 0.002032, 0.000886, 0.0</span>
<span class="go">15.0, 0.008359, 0.010798, 0.0</span>
<span class="go">20.0, 0.034382, 0.048394, 0.057739</span>
<span class="go">25.0, 0.141421, 0.079788, 0.057739</span>
<span class="go">30.0, 0.034382, 0.048394, 0.057739</span>
<span class="go">35.0, 0.008359, 0.010798, 0.0</span>
<span class="go">40.0, 0.002032, 0.000886, 0.0</span>
</pre></div>
</div>
<p>When varying parameter <cite>xi</cite>, the resulting density is negatively
skewed (0.2), symmetric (1.0), and positively skewed (5.0),
respectively:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">test</span><span class="p">(</span><span class="n">xi</span><span class="o">=</span><span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">])</span>
<span class="go">10.0, 0.0, 0.000886, 0.003175</span>
<span class="go">15.0, 0.0, 0.010798, 0.012957</span>
<span class="go">20.0, 0.092845, 0.048394, 0.036341</span>
<span class="go">25.0, 0.070063, 0.079788, 0.070063</span>
<span class="go">30.0, 0.036341, 0.048394, 0.092845</span>
<span class="go">35.0, 0.012957, 0.010798, 0.0</span>
<span class="go">40.0, 0.003175, 0.000886, 0.0</span>
</pre></div>
</div>
<p>In the above examples, the actual <cite>sigma</cite> (5.0) is calculated by
multiplying <cite>sigma1</cite> (0.2) with the mean simulated value (25.0),
internally.  This can be done for modelling homoscedastic errors.
Instead, <cite>sigma2</cite> is multiplied with the individual simulated values
to account for heteroscedastic errors.  With increasing values of
<cite>sigma2</cite>, the resulting densities are modified as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">test</span><span class="p">(</span><span class="n">sigma2</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">])</span>
<span class="go">10.0, 0.000886, 0.002921, 0.005737</span>
<span class="go">15.0, 0.010798, 0.018795, 0.022831</span>
<span class="go">20.0, 0.048394, 0.044159, 0.037988</span>
<span class="go">25.0, 0.079788, 0.053192, 0.039894</span>
<span class="go">30.0, 0.048394, 0.04102, 0.032708</span>
<span class="go">35.0, 0.010798, 0.023493, 0.023493</span>
<span class="go">40.0, 0.000886, 0.011053, 0.015771</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="hydpy.auxs.statstools.hsepd_manual">
<code class="descclassname">hydpy.auxs.statstools.</code><code class="descname">hsepd_manual</code><span class="sig-paren">(</span><em>sigma1</em>, <em>sigma2</em>, <em>xi</em>, <em>beta</em>, <em>sim=None</em>, <em>obs=None</em>, <em>node=None</em>, <em>skip_nan=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydpy/auxs/statstools.html#hsepd_manual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hydpy.auxs.statstools.hsepd_manual" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the mean of the logarithmised probability densities of the
‘heteroskedastic skewed exponential power distribution.</p>
<p>The following examples are taken from the documentation of function
<a class="reference internal" href="#hydpy.auxs.statstools.hsepd_pdf" title="hydpy.auxs.statstools.hsepd_pdf"><code class="xref py py-func docutils literal notranslate"><span class="pre">hsepd_pdf()</span></code></a>, which is used by function <a class="reference internal" href="#hydpy.auxs.statstools.hsepd_manual" title="hydpy.auxs.statstools.hsepd_manual"><code class="xref py py-func docutils literal notranslate"><span class="pre">hsepd_manual()</span></code></a>.  The first
one deals with a heteroscedastic normal distribution:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="k">import</span> <span class="n">round_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="k">import</span> <span class="n">hsepd_manual</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">hsepd_manual</span><span class="p">(</span><span class="n">sigma1</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">sigma2</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">xi</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">sim</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">41.0</span><span class="p">),</span>
<span class="gp">... </span>                    <span class="n">obs</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="mi">31</span><span class="p">,</span> <span class="mf">25.0</span><span class="p">)))</span>
<span class="go">-3.682842</span>
</pre></div>
</div>
<p>The second one is supposed to show to small zero probability density
values are set to 1e-200 before calculating their logarithm (which
means that the lowest possible value returned by function
<a class="reference internal" href="#hydpy.auxs.statstools.hsepd_manual" title="hydpy.auxs.statstools.hsepd_manual"><code class="xref py py-func docutils literal notranslate"><span class="pre">hsepd_manual()</span></code></a> is approximately -460):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">hsepd_manual</span><span class="p">(</span><span class="n">sigma1</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">sigma2</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">xi</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">beta</span><span class="o">=-</span><span class="mf">0.99</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">sim</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">41.0</span><span class="p">),</span>
<span class="gp">... </span>                    <span class="n">obs</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="mi">31</span><span class="p">,</span> <span class="mf">25.0</span><span class="p">)))</span>
<span class="go">-209.539335</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="hydpy.auxs.statstools.hsepd">
<code class="descclassname">hydpy.auxs.statstools.</code><code class="descname">hsepd</code><span class="sig-paren">(</span><em>sim=None</em>, <em>obs=None</em>, <em>node=None</em>, <em>skip_nan=False</em>, <em>inits=None</em>, <em>return_pars=False</em>, <em>silent=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydpy/auxs/statstools.html#hsepd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hydpy.auxs.statstools.hsepd" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the mean of the logarithmised probability densities of the
‘heteroskedastic skewed exponential power distribution.</p>
<p>Function <a class="reference internal" href="#hydpy.auxs.statstools.hsepd" title="hydpy.auxs.statstools.hsepd"><code class="xref py py-func docutils literal notranslate"><span class="pre">hsepd()</span></code></a> serves the same purpose as function <a class="reference internal" href="#hydpy.auxs.statstools.hsepd_manual" title="hydpy.auxs.statstools.hsepd_manual"><code class="xref py py-func docutils literal notranslate"><span class="pre">hsepd_manual()</span></code></a>,
but tries to estimate the parameters of the heteroscedastic skewed
exponential distribution via an optimization algorithm.  This
is shown by generating a random sample.  1000 simulated values
are scattered around the observed (true) value of 10.0 with a
standard deviation of 2.0:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obs</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">)</span>
</pre></div>
</div>
<p>First, as a reference, we calculate the “true” value based on
function <a class="reference internal" href="#hydpy.auxs.statstools.hsepd_manual" title="hydpy.auxs.statstools.hsepd_manual"><code class="xref py py-func docutils literal notranslate"><span class="pre">hsepd_manual()</span></code></a> and the correct distribution parameters:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="k">import</span> <span class="n">round_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="k">import</span> <span class="n">hsepd</span><span class="p">,</span> <span class="n">hsepd_manual</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">hsepd_manual</span><span class="p">(</span><span class="n">sigma1</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">sigma2</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">xi</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">sim</span><span class="o">=</span><span class="n">sim</span><span class="p">,</span> <span class="n">obs</span><span class="o">=</span><span class="n">obs</span><span class="p">))</span>
<span class="go">-2.100093</span>
</pre></div>
</div>
<p>When using function <a class="reference internal" href="#hydpy.auxs.statstools.hsepd" title="hydpy.auxs.statstools.hsepd"><code class="xref py py-func docutils literal notranslate"><span class="pre">hsepd()</span></code></a>, the returned value is even a little
“better”:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">hsepd</span><span class="p">(</span><span class="n">sim</span><span class="o">=</span><span class="n">sim</span><span class="p">,</span> <span class="n">obs</span><span class="o">=</span><span class="n">obs</span><span class="p">))</span>
<span class="go">-2.09983</span>
</pre></div>
</div>
<p>This is due to the deviation from the random sample to its
theoretical distribution.  This is reflected by small differences
between the estimated values and the theoretical values of
<cite>sigma1</cite> (0.2), , <cite>sigma2</cite> (0.0), <cite>xi</cite> (1.0), and <cite>beta</cite> (0.0).
The estimated values are returned in the mentioned order through
enabling the <cite>return_pars</cite> option:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">value</span><span class="p">,</span> <span class="n">pars</span> <span class="o">=</span> <span class="n">hsepd</span><span class="p">(</span><span class="n">sim</span><span class="o">=</span><span class="n">sim</span><span class="p">,</span> <span class="n">obs</span><span class="o">=</span><span class="n">obs</span><span class="p">,</span> <span class="n">return_pars</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="go">0.19966, 0.0, 0.96836, 0.0188</span>
</pre></div>
</div>
<p>There is no guarantee that the optimization numerical optimization
algorithm underlying function <a class="reference internal" href="#hydpy.auxs.statstools.hsepd" title="hydpy.auxs.statstools.hsepd"><code class="xref py py-func docutils literal notranslate"><span class="pre">hsepd()</span></code></a> will always find the parameters
resulting in the largest value returned by function <a class="reference internal" href="#hydpy.auxs.statstools.hsepd_manual" title="hydpy.auxs.statstools.hsepd_manual"><code class="xref py py-func docutils literal notranslate"><span class="pre">hsepd_manual()</span></code></a>.
You can increase its robustness (and decrease computation time) by
supplying good initial parameter values:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">value</span><span class="p">,</span> <span class="n">pars</span> <span class="o">=</span> <span class="n">hsepd</span><span class="p">(</span><span class="n">sim</span><span class="o">=</span><span class="n">sim</span><span class="p">,</span> <span class="n">obs</span><span class="o">=</span><span class="n">obs</span><span class="p">,</span> <span class="n">return_pars</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">inits</span><span class="o">=</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="go">0.19966, 0.0, 0.96836, 0.0188</span>
</pre></div>
</div>
<p>However, the following example shows a case when this strategie
results in worse results:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">value</span><span class="p">,</span> <span class="n">pars</span> <span class="o">=</span> <span class="n">hsepd</span><span class="p">(</span><span class="n">sim</span><span class="o">=</span><span class="n">sim</span><span class="p">,</span> <span class="n">obs</span><span class="o">=</span><span class="n">obs</span><span class="p">,</span> <span class="n">return_pars</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">inits</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<span class="go">-2.174492</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">pars</span><span class="p">)</span>
<span class="go">0.0, 0.213179, 1.705485, 0.505112</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="hydpy.auxs.statstools.calc_mean_time">
<code class="descclassname">hydpy.auxs.statstools.</code><code class="descname">calc_mean_time</code><span class="sig-paren">(</span><em>timepoints</em>, <em>weights</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydpy/auxs/statstools.html#calc_mean_time"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hydpy.auxs.statstools.calc_mean_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the weighted mean of the given timepoints.</p>
<p>With equal given weights, the result is simply the mean of the given
time points:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="k">import</span> <span class="n">calc_mean_time</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">calc_mean_time</span><span class="p">(</span><span class="n">timepoints</span><span class="o">=</span><span class="p">[</span><span class="mf">3.</span><span class="p">,</span> <span class="mf">7.</span><span class="p">],</span>
<span class="gp">... </span>               <span class="n">weights</span><span class="o">=</span><span class="p">[</span><span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">])</span>
<span class="go">5.0</span>
</pre></div>
</div>
<p>With different weights, the resulting mean time is shifted to the larger
ones:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">calc_mean_time</span><span class="p">(</span><span class="n">timepoints</span><span class="o">=</span><span class="p">[</span><span class="mf">3.</span><span class="p">,</span> <span class="mf">7.</span><span class="p">],</span>
<span class="gp">... </span>               <span class="n">weights</span><span class="o">=</span><span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">])</span>
<span class="go">6.0</span>
</pre></div>
</div>
<p>Or, in the most extreme case:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">calc_mean_time</span><span class="p">(</span><span class="n">timepoints</span><span class="o">=</span><span class="p">[</span><span class="mf">3.</span><span class="p">,</span> <span class="mf">7.</span><span class="p">],</span>
<span class="gp">... </span>               <span class="n">weights</span><span class="o">=</span><span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">])</span>
<span class="go">7.0</span>
</pre></div>
</div>
<p>There will be some checks for input plausibility perfomed, e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">calc_mean_time</span><span class="p">(</span><span class="n">timepoints</span><span class="o">=</span><span class="p">[</span><span class="mf">3.</span><span class="p">,</span> <span class="mf">7.</span><span class="p">],</span>
<span class="gp">... </span>               <span class="n">weights</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">])</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">While trying to calculate the weighted mean time, the following error occured: For the following objects, at least one value is negative: weights.</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="hydpy.auxs.statstools.calc_mean_time_deviation">
<code class="descclassname">hydpy.auxs.statstools.</code><code class="descname">calc_mean_time_deviation</code><span class="sig-paren">(</span><em>timepoints</em>, <em>weights</em>, <em>mean_time=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydpy/auxs/statstools.html#calc_mean_time_deviation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hydpy.auxs.statstools.calc_mean_time_deviation" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the weighted deviation of the given timepoints from their mean
time.</p>
<p>With equal given weights, the is simply the standard deviation of the
given time points:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="k">import</span> <span class="n">calc_mean_time_deviation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">calc_mean_time_deviation</span><span class="p">(</span><span class="n">timepoints</span><span class="o">=</span><span class="p">[</span><span class="mf">3.</span><span class="p">,</span> <span class="mf">7.</span><span class="p">],</span>
<span class="gp">... </span>                         <span class="n">weights</span><span class="o">=</span><span class="p">[</span><span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">])</span>
<span class="go">2.0</span>
</pre></div>
</div>
<p>One can pass a precalculated or alternate mean time:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="k">import</span> <span class="n">round_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">calc_mean_time_deviation</span><span class="p">(</span><span class="n">timepoints</span><span class="o">=</span><span class="p">[</span><span class="mf">3.</span><span class="p">,</span> <span class="mf">7.</span><span class="p">],</span>
<span class="gp">... </span>                                <span class="n">weights</span><span class="o">=</span><span class="p">[</span><span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">],</span>
<span class="gp">... </span>                                <span class="n">mean_time</span><span class="o">=</span><span class="mf">4.</span><span class="p">))</span>
<span class="go">2.236068</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">calc_mean_time_deviation</span><span class="p">(</span><span class="n">timepoints</span><span class="o">=</span><span class="p">[</span><span class="mf">3.</span><span class="p">,</span> <span class="mf">7.</span><span class="p">],</span>
<span class="gp">... </span>                                <span class="n">weights</span><span class="o">=</span><span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">]))</span>
<span class="go">1.732051</span>
</pre></div>
</div>
<p>Or, in the most extreme case:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">calc_mean_time_deviation</span><span class="p">(</span><span class="n">timepoints</span><span class="o">=</span><span class="p">[</span><span class="mf">3.</span><span class="p">,</span> <span class="mf">7.</span><span class="p">],</span>
<span class="gp">... </span>                         <span class="n">weights</span><span class="o">=</span><span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">])</span>
<span class="go">0.0</span>
</pre></div>
</div>
<p>There will be some checks for input plausibility perfomed, e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">calc_mean_time_deviation</span><span class="p">(</span><span class="n">timepoints</span><span class="o">=</span><span class="p">[</span><span class="mf">3.</span><span class="p">,</span> <span class="mf">7.</span><span class="p">],</span>
<span class="gp">... </span>                         <span class="n">weights</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">])</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">While trying to calculate the weighted time deviation from mean time, the following error occured: For the following objects, at least one value is negative: weights.</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="hydpy.auxs.statstools.evaluationtable">
<code class="descclassname">hydpy.auxs.statstools.</code><code class="descname">evaluationtable</code><span class="sig-paren">(</span><em>nodes</em>, <em>criteria</em>, <em>nodenames=None</em>, <em>critnames=None</em>, <em>skip_nan=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydpy/auxs/statstools.html#evaluationtable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hydpy.auxs.statstools.evaluationtable" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a table containing the results of the given evaluation
criteria for the given <a class="reference internal" href="devicetools.html#hydpy.core.devicetools.Node" title="hydpy.core.devicetools.Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">Node</span></code></a> objects.</p>
<p>First, we define two nodes with different simulation and observation
data (see function <a class="reference internal" href="#hydpy.auxs.statstools.prepare_arrays" title="hydpy.auxs.statstools.prepare_arrays"><code class="xref py py-func docutils literal notranslate"><span class="pre">prepare_arrays()</span></code></a> for some explanations):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="k">import</span> <span class="n">pub</span><span class="p">,</span> <span class="n">Timegrid</span><span class="p">,</span> <span class="n">Timegrids</span><span class="p">,</span> <span class="n">Node</span><span class="p">,</span> <span class="n">round_</span><span class="p">,</span> <span class="n">nan</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pub</span><span class="o">.</span><span class="n">timegrids</span> <span class="o">=</span> <span class="n">Timegrids</span><span class="p">(</span><span class="n">Timegrid</span><span class="p">(</span><span class="s1">&#39;01.01.2000&#39;</span><span class="p">,</span>
<span class="gp">... </span>                                   <span class="s1">&#39;04.01.2000&#39;</span><span class="p">,</span>
<span class="gp">... </span>                                   <span class="s1">&#39;1d&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nodes</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="s1">&#39;test1&#39;</span><span class="p">),</span> <span class="n">Node</span><span class="p">(</span><span class="s1">&#39;test2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">node</span><span class="o">.</span><span class="n">prepare_simseries</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">node</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">series</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span>
<span class="gp">... </span>    <span class="n">node</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">obs</span><span class="o">.</span><span class="n">ramflag</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">... </span>    <span class="n">node</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">obs</span><span class="o">.</span><span class="n">_setarray</span><span class="p">([</span><span class="mf">4.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">series</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">obs</span><span class="o">.</span><span class="n">_setarray</span><span class="p">([</span><span class="mf">4.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">series</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">obs</span><span class="o">.</span><span class="n">_setarray</span><span class="p">([</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
</pre></div>
</div>
<p>Selecting functions <a class="reference internal" href="#hydpy.auxs.statstools.corr" title="hydpy.auxs.statstools.corr"><code class="xref py py-func docutils literal notranslate"><span class="pre">corr()</span></code></a> and <a class="reference internal" href="#hydpy.auxs.statstools.bias_abs" title="hydpy.auxs.statstools.bias_abs"><code class="xref py py-func docutils literal notranslate"><span class="pre">bias_abs()</span></code></a> as evaluation criteria,
function <a class="reference internal" href="#hydpy.auxs.statstools.evaluationtable" title="hydpy.auxs.statstools.evaluationtable"><code class="xref py py-func docutils literal notranslate"><span class="pre">evaluationtable()</span></code></a> returns the following table (which is
actually a pandas data frame):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="k">import</span> <span class="n">evaluationtable</span><span class="p">,</span> <span class="n">corr</span><span class="p">,</span> <span class="n">bias_abs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">evaluationtable</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span> <span class="p">(</span><span class="n">corr</span><span class="p">,</span> <span class="n">bias_abs</span><span class="p">))</span>
<span class="go">       corr  bias_abs</span>
<span class="go">test1   1.0      -3.0</span>
<span class="go">test2   NaN       NaN</span>
</pre></div>
</div>
<p>One can pass alternative names for both the node objects and the
criteria functions.  Also, <cite>nan</cite> values can be skipped:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">evaluationtable</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span> <span class="p">(</span><span class="n">corr</span><span class="p">,</span> <span class="n">bias_abs</span><span class="p">),</span>
<span class="gp">... </span>                <span class="n">nodenames</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;first node&#39;</span><span class="p">,</span> <span class="s1">&#39;second node&#39;</span><span class="p">),</span>
<span class="gp">... </span>                <span class="n">critnames</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;corrcoef&#39;</span><span class="p">,</span> <span class="s1">&#39;bias&#39;</span><span class="p">),</span>
<span class="gp">... </span>                <span class="n">skip_nan</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">             corrcoef  bias</span>
<span class="go">first node        1.0  -3.0</span>
<span class="go">second node      -1.0   0.0</span>
</pre></div>
</div>
<p>The number of assigned node objects and criteria functions must
match the number of givern alternative names:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">evaluationtable</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span> <span class="p">(</span><span class="n">corr</span><span class="p">,</span> <span class="n">bias_abs</span><span class="p">),</span>
<span class="gp">... </span>                <span class="n">nodenames</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;first node&#39;</span><span class="p">,))</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">While trying to evaluate the simulation results of some node objects, the following error occured: 2 node objects are given which does not match with number of given alternative names beeing 1.</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">evaluationtable</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span> <span class="p">(</span><span class="n">corr</span><span class="p">,</span> <span class="n">bias_abs</span><span class="p">),</span>
<span class="gp">... </span>                <span class="n">critnames</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;corrcoef&#39;</span><span class="p">,))</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">While trying to evaluate the simulation results of some node objects, the following error occured: 2 criteria functions are given which does not match with number of given alternative names beeing 1.</span>
</pre></div>
</div>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="framework.html">Framework Tools</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="core.html">Core Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="cythons.html">Cythons Modules</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="auxiliaries.html">Auxiliary Modules</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="anntools.html">anntools</a></li>
<li class="toctree-l3"><a class="reference internal" href="armatools.html">armatools</a></li>
<li class="toctree-l3"><a class="reference internal" href="iuhtools.html">iuhtools</a></li>
<li class="toctree-l3"><a class="reference internal" href="networktools.html">networktools</a></li>
<li class="toctree-l3"><a class="reference internal" href="smoothtools.html">smoothtools</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">statstools</a></li>
<li class="toctree-l3"><a class="reference internal" href="validtools.html">validtools</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="modelcollection.html">Model Collection</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="development.html">Development</a></li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="smoothtools.html"
                        title="previous chapter">smoothtools</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="validtools.html"
                        title="next chapter">validtools</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/statstools.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="validtools.html" title="validtools"
             >next</a> |</li>
        <li class="right" >
          <a href="smoothtools.html" title="smoothtools"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">HydPy 2.1-dev documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="framework.html" >Framework Tools</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="auxiliaries.html" >Auxiliary Modules</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Christoph Tyralla.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.5.
    </div>
  </body>
</html>